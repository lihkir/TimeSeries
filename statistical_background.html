
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1. Introducción a las Series de Tiempo &#8212; Análisis y Predicción de Series de Tiempo</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css?v=b4b7a797" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'statistical_background';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/custom.js?v=14184634"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2. Métodos de Suavización Exponencial" href="exponential_smoothing.html" />
    <link rel="prev" title="Profesor: Dr. Lihki Rubio" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/fotolihki.jpg" class="logo__image only-light" alt="Análisis y Predicción de Series de Tiempo - Home"/>
    <script>document.write(`<img src="_static/fotolihki.jpg" class="logo__image only-dark" alt="Análisis y Predicción de Series de Tiempo - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Profesor: Dr. Lihki Rubio
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">1. Introducción a las Series de Tiempo</a></li>
<li class="toctree-l1"><a class="reference internal" href="exponential_smoothing.html">2. Métodos de Suavización Exponencial</a></li>
<li class="toctree-l1"><a class="reference internal" href="arima_model.html">3. Modelos autorregresivos integrados de media móvil</a></li>
<li class="toctree-l1"><a class="reference internal" href="deep_learning.html">4. Deep Learning para la predicción de series temporales</a></li>
<li class="toctree-l1"><a class="reference internal" href="biblio.html">5. Bibliografía</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/statistical_background.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Introducción a las Series de Tiempo</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diferentes-tipos-de-datos">1.1. Diferentes tipos de datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos-transversales">1.2. Datos transversales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos-de-series-temporales">1.3. Datos de series temporales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos-de-panel">1.4. Datos de panel</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estructuras-internas-de-las-series-temporales">1.5. Estructuras internas de las series temporales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tendencia-general">1.6. Tendencia general</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estacionalidad">1.7. Estacionalidad</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grafico-de-secuencia-de-series">1.8. Gráfico de secuencia de series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grafico-de-subserie-estacional">1.9. Gráfico de subserie estacional</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graficos-de-cajas-multiples">1.10. Gráficos de cajas múltiples</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cambios-ciclicos">1.11. Cambios cíclicos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#componentes-irregulares">1.12. Componentes irregulares</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-analisis-de-series-temporales">1.13. Modelos de análisis de series temporales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-media-cero">1.14. Modelos de media cero</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#camino-aleatorio">1.15. Camino aleatorio</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-tendencia">1.16. Modelos de tendencia</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-estacionalidad">1.17. Modelos de estacionalidad</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#autocorrelacion-y-autocorrelacion-parcial">1.18. Autocorrelación y autocorrelación parcial</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#experimentos-numericos-acf">1.19. Experimentos numéricos ACF</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-datos-de-series-temporales">1.20. Análisis de datos de series temporales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#procesamiento-avanzado-y-visualizacion-de-datos-de-series-temporales">1.21. Procesamiento avanzado y visualización de datos de series temporales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#remuestreo-de-datos-de-series-temporales">1.22. Remuestreo de datos de series temporales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#agregacion-por-grupos">1.23. Agregación por grupos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estadisticos-moviles">1.24. Estadísticos móviles</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#procesos-estacionarios">1.25. Procesos estacionarios</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transformacion-de-datos-y-ajustes">1.26. Transformación de datos y ajustes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ajustes-estacionales-y-de-tendencia">1.27. Ajustes estacionales y de tendencia</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diferenciacion">1.28. Diferenciación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prueba-de-dickey-fuller">1.29. Prueba de Dickey-Fuller</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descomposicion-de-series-temporales">1.30. Descomposición de series temporales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#medias-moviles-y-efectos-de-suavizacion">1.31. Medias móviles y efectos de suavización</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ajuste-estacional-mediante-media-movil">1.32. Ajuste estacional mediante media móvil</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#media-movil-ponderada">1.33. Media móvil ponderada</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descomposicion-de-series-temporales-mediante-medias-moviles">1.34. Descomposición de series temporales mediante medias móviles</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descomposicion-de-series-temporales-mediante-statsmodels-tsa">1.35. Descomposición de series temporales mediante <code class="docutils literal notranslate"><span class="pre">statsmodels.tsa</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#residual-y-error-de-prediccion">1.36. Residual y error de predicción</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluando-y-monitoreando-el-desempeno-del-modelo-predictivo">1.37. Evaluando y monitoreando el desempeño del modelo predictivo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#elegir-entre-modelos-que-compiten">1.38. Elegir entre modelos que compiten</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="introduccion-a-las-series-de-tiempo">
<h1><span class="section-number">1. </span>Introducción a las Series de Tiempo<a class="headerlink" href="#introduccion-a-las-series-de-tiempo" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>En esta sección se presentan algunos métodos estadísticos básicos, los cuales son esenciales para <em><strong>modelar, analizar y predecir datos de series temporales</strong></em>. Se presentan gráficos y resúmenes numéricos de las propiedades de los datos de series temporales. También se analiza el uso de <em><strong>transformaciones y ajustes de datos en la predicción</strong></em> y algunos métodos ampliamente utilizados para caracterizar y controlar el rendimiento de un modelo predictivo.</p></li>
<li><p>Algunos aspectos de como las medidas de rendimiento pueden usarse para <em><strong>seleccionar entre técnicas de predicción</strong></em> son presentados. Las predicciones se basan en datos u observaciones sobre la variable de interés. Estos datos suelen adoptar la forma de una serie temporal.</p></li>
</ul>
<section id="diferentes-tipos-de-datos">
<h2><span class="section-number">1.1. </span>Diferentes tipos de datos<a class="headerlink" href="#diferentes-tipos-de-datos" title="Link to this heading">#</a></h2>
<p>Los analistas de negocio y científicos de datos se encuentran con <em><strong>diferentes tipos de datos en sus proyectos de análisis</strong></em>. La mayoría de los datos que se suelen encontrar en proyectos académicos e industriales se pueden clasificar a grandes rasgos en las siguientes categorías:</p>
<ul class="simple">
<li><p><em><strong><code class="docutils literal notranslate"><span class="pre">Datos</span> <span class="pre">transversales</span></code></strong></em></p></li>
<li><p><em><strong><code class="docutils literal notranslate"><span class="pre">Datos</span> <span class="pre">de</span> <span class="pre">series</span> <span class="pre">temporales</span></code></strong></em></p></li>
<li><p><em><strong><code class="docutils literal notranslate"><span class="pre">Datos</span> <span class="pre">de</span> <span class="pre">panel</span></code></strong></em></p></li>
</ul>
<p>Comprender qué tipo de datos se necesitan para resolver un problema y qué tipo de datos pueden obtenerse de las fuentes disponibles es importante para formular el problema y elegir el tipo de modelo más adecuado.</p>
</section>
<section id="datos-transversales">
<h2><span class="section-number">1.2. </span>Datos transversales<a class="headerlink" href="#datos-transversales" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Los datos transversales o de corte transversal de una población <em><strong>se obtienen tomando observaciones de múltiples individuos en el mismo momento</strong></em>. Los datos transversales <em>pueden incluir observaciones tomadas en distintos momentos, pero en estos casos el tiempo no desempeña ningún papel significativo en el análisis</em>. Los resultados de la selectividad de los estudiantes es un ejemplo de datos transversales. El <em><strong>producto interno bruto de los países y los datos para el análisis de pérdida de clientes</strong></em> es otro ejemplo de datos transversales.</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>En esencia, los datos transversales representan un <em><strong>instante o momento dado</strong></em>. Sin embargo, los datos de clientes para el <em><strong>análisis de rotación pueden obtenerse a lo largo de un periodo de tiempo</strong></em>, como años y meses. <em><strong>Pero, a efectos de análisis, el tiempo puede no desempeñar un papel importante</strong></em> y, por lo tanto, aunque los datos de rotación de clientes pueden obtenerse de múltiples puntos en el tiempo, <em><strong>pueden seguir considerándose como un conjunto de datos transversal</strong></em>.</p></li>
</ul>
</div>
<ul class="simple">
<li><p>A menudo, el análisis de datos transversales comienza con un gráfico de las variables, para visualizar sus propiedades estadísticas como la <em><strong>tendencia central, la dispersión, la asimetría y la curtosis</strong></em>. En el siguiente ejemplo univariado se muestra el <em><strong><code class="docutils literal notranslate"><span class="pre">Gasto</span> <span class="pre">militar</span> <span class="pre">como</span> <span class="pre">porcentaje</span> <span class="pre">del</span> <span class="pre">Producto</span> <span class="pre">Interno</span> <span class="pre">Bruto</span></code></strong></em> de 85 países en el año 2010. Los <em><strong>datos usados en el presente curso se encuentran en el repositorio</strong></em> <a class="reference external" href="https://github.com/lihkir/Data/blob/main/datasets.zip">Dataset for TSF</a>.</p></li>
<li><p><em><strong>Al tomar los datos de un solo año aseguramos su naturaleza transversal</strong></em>. La figura combina un <em><strong>histograma normalizado</strong></em> y un <em><strong>gráfico de densidad de kernel</strong></em> para resaltar las diferentes propiedades estadísticas de los datos de gasto militar. Utilizaremos <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> en este caso para realizar las visualizaciones. Para temas diferentes al seleccionado (ver <a class="reference external" href="https://www.python-graph-gallery.com/104-seaborn-themes">seaborn templates</a>). Para descargar todos los datos que serán utilizados en este curso (ver <a class="reference external" href="https://github.com/lihkir/Data/blob/main/datasets.zip">Dataset for TSF</a>)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;darkgrid&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/home/lihkir/Data/WDIData.csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Column names:&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column names: Index([&#39;Country Name&#39;, &#39;Country Code&#39;, &#39;Indicator Name&#39;, &#39;Indicator Code&#39;,
       &#39;1960&#39;, &#39;1961&#39;, &#39;1962&#39;, &#39;1963&#39;, &#39;1964&#39;, &#39;1965&#39;, &#39;1966&#39;, &#39;1967&#39;, &#39;1968&#39;,
       &#39;1969&#39;, &#39;1970&#39;, &#39;1971&#39;, &#39;1972&#39;, &#39;1973&#39;, &#39;1974&#39;, &#39;1975&#39;, &#39;1976&#39;, &#39;1977&#39;,
       &#39;1978&#39;, &#39;1979&#39;, &#39;1980&#39;, &#39;1981&#39;, &#39;1982&#39;, &#39;1983&#39;, &#39;1984&#39;, &#39;1985&#39;, &#39;1986&#39;,
       &#39;1987&#39;, &#39;1988&#39;, &#39;1989&#39;, &#39;1990&#39;, &#39;1991&#39;, &#39;1992&#39;, &#39;1993&#39;, &#39;1994&#39;, &#39;1995&#39;,
       &#39;1996&#39;, &#39;1997&#39;, &#39;1998&#39;, &#39;1999&#39;, &#39;2000&#39;, &#39;2001&#39;, &#39;2002&#39;, &#39;2003&#39;, &#39;2004&#39;,
       &#39;2005&#39;, &#39;2006&#39;, &#39;2007&#39;, &#39;2008&#39;, &#39;2009&#39;, &#39;2010&#39;, &#39;2011&#39;, &#39;2012&#39;, &#39;2013&#39;,
       &#39;2014&#39;, &#39;2015&#39;, &#39;2016&#39;, &#39;Unnamed: 61&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>También podemos hacernos una idea del tamaño de los datos en número de filas y columnas ejecutando la siguiente línea</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No. of rows, columns:&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No. of rows, columns: (401016, 62)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Este conjunto de datos tiene, 401016 filas porque recoge <em><strong>1504 indicadores de desarrollo mundial para 264 países diferentes</strong></em>. Esta información sobre el número único de indicadores y países puede obtenerse ejecutando las líneas siguientes</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nb_countries</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Country Code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Unique number of countries:&#39;</span><span class="p">,</span> <span class="n">nb_countries</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unique number of countries: 264
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Como se desprende de la estructura de los datos, <em><strong>cada fila ofrece las observaciones sobre un indicador</strong></em>, que se identifica mediante las columnas <code class="docutils literal notranslate"><span class="pre">Indicator</span> <span class="pre">Name</span></code> y <code class="docutils literal notranslate"><span class="pre">Indicator</span> <span class="pre">Code</span></code>, y sobre el país, que se indica mediante las columnas <code class="docutils literal notranslate"><span class="pre">Country</span> <span class="pre">Name</span></code> y <code class="docutils literal notranslate"><span class="pre">Country</span> <span class="pre">Code</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Country Name       object
Country Code       object
Indicator Name     object
Indicator Code     object
1960              float64
                   ...   
2013              float64
2014              float64
2015              float64
2016              float64
Unnamed: 61       float64
Length: 62, dtype: object
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Las columnas de 1960 a 2016 tienen los valores de un indicador durante el mismo periodo de tiempo. En esta comprensión de cómo se disponen los datos en el <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, ahora estamos preparados para <em><strong>extraer las filas y columnas que son relevantes para nuestra visualización</strong></em>.</p></li>
<li><p>Comencemos preparando otros dos <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> que obtengan las filas correspondientes a los indicadores <code class="docutils literal notranslate"><span class="pre">Total</span> <span class="pre">Central</span> <span class="pre">Government</span> <span class="pre">Debt</span> <span class="pre">(as</span> <span class="pre">%</span> <span class="pre">of</span> <span class="pre">GDP)</span></code> y <code class="docutils literal notranslate"><span class="pre">Military</span> <span class="pre">expenditure</span> <span class="pre">(%</span> <span class="pre">of</span> <span class="pre">GDP)</span></code> para todos los países. Esto se hace por medio del <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> original de la siguiente manera</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">central_govt_debt</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Indicator Name&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Central government debt, total (</span><span class="si">% o</span><span class="s1">f GDP)&#39;</span><span class="p">]</span>
<span class="n">military_exp</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Indicator Name&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Military expenditure (</span><span class="si">% o</span><span class="s1">f GDP)&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Las dos líneas anteriores crean dos nuevos <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, a saber, <code class="docutils literal notranslate"><span class="pre">central_govt_debt</span></code> y <code class="docutils literal notranslate"><span class="pre">militar_exp</span></code>. Una comprobación rápida de la forma de estos <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> puede hacerse ejecutando las dos líneas siguientes</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Shape of central_govt_debt:&#39;</span><span class="p">,</span> <span class="n">central_govt_debt</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Shape of military_exp:&#39;</span><span class="p">,</span> <span class="n">military_exp</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape of central_govt_debt: (264, 62)
Shape of military_exp: (264, 62)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Estos <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> contienen toda la información que necesitamos. Para <em><strong>trazar los datos univariantes y transversales necesitaremos la columna 2010</strong></em>. Antes de ejecutar el código para el trazado, comprobemos rápidamente si falta la columna 2010. Esto se hace mediante las dos líneas siguientes</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">central_govt_debt</span><span class="p">[</span><span class="s1">&#39;2010&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count     94.000000
mean      53.048479
std       29.790674
min        0.519665
25%       28.357797
50%       49.540245
75%       75.259012
max      161.596402
Name: 2010, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">military_exp</span><span class="p">[</span><span class="s1">&#39;2010&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    192.000000
mean       1.988556
std        1.354856
min        0.000000
25%        1.190287
50%        1.613407
75%        2.624711
max        8.565679
Name: 2010, dtype: float64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Además, queremos que la columna <code class="docutils literal notranslate"><span class="pre">Country</span> <span class="pre">Code</span></code> sea <em><strong>el índice de las filas</strong></em>. Así que se ejecuta el siguiente par de líneas</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">central_govt_debt</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">central_govt_debt</span><span class="p">[</span><span class="s1">&#39;Country Code&#39;</span><span class="p">]</span>
<span class="n">military_exp</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">military_exp</span><span class="p">[</span><span class="s1">&#39;Country Code&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>A continuación, creamos dos <code class="docutils literal notranslate"><span class="pre">pandas.Series</span></code> tomando columnas 2010 no vacías de <code class="docutils literal notranslate"><span class="pre">central_govt_debt</span></code> y <code class="docutils literal notranslate"><span class="pre">military_exp</span></code>. Los objetos <code class="docutils literal notranslate"><span class="pre">Series</span></code> recién creados se unifican para formar un único <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">central_govt_debt_2010</span> <span class="o">=</span> <span class="n">central_govt_debt</span><span class="p">[</span><span class="s1">&#39;2010&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">central_govt_debt</span><span class="p">[</span><span class="s1">&#39;2010&#39;</span><span class="p">])]</span>
<span class="n">military_exp_2010</span> <span class="o">=</span> <span class="n">military_exp</span><span class="p">[</span><span class="s1">&#39;2010&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">military_exp</span><span class="p">[</span><span class="s1">&#39;2010&#39;</span><span class="p">])]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">central_govt_debt_2010</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Country Code
CEB    47.446156
EMU    72.414709
ECS    63.137736
ECA    22.338687
TEC    27.287492
         ...    
UGA    27.552595
UKR    29.969556
GBR    83.406797
USA    85.601594
URY    44.222702
Name: 2010, Length: 94, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">military_exp_2010</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Country Code
ARB    5.117807
CEB    1.482543
EAR    2.335511
EAS    1.563325
EAP    1.724963
         ...   
VEN    0.853924
VNM    2.305049
YEM    4.685557
ZMB    1.382593
ZWE    0.977841
Name: 2010, Length: 192, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_to_plot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">central_govt_debt_2010</span><span class="p">,</span> <span class="n">military_exp_2010</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">data_to_plot</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;central_govt_debt&#39;</span><span class="p">,</span> <span class="s1">&#39;military_exp&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_to_plot</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>central_govt_debt</th>
      <th>military_exp</th>
    </tr>
    <tr>
      <th>Country Code</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>CEB</th>
      <td>47.446156</td>
      <td>1.482543</td>
    </tr>
    <tr>
      <th>EMU</th>
      <td>72.414709</td>
      <td>1.618759</td>
    </tr>
    <tr>
      <th>ECS</th>
      <td>63.137736</td>
      <td>1.860343</td>
    </tr>
    <tr>
      <th>ECA</th>
      <td>22.338687</td>
      <td>2.933044</td>
    </tr>
    <tr>
      <th>TEC</th>
      <td>27.287492</td>
      <td>2.785617</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_to_plot</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(202, 2)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Para graficar, tenemos que tomar solo aquellos <em><strong>países que tienen las columnas</strong></em> <code class="docutils literal notranslate"><span class="pre">central_govt_debt</span></code> <em><strong>y</strong></em> <code class="docutils literal notranslate"><span class="pre">military_exp</span></code> <em><strong>diferentes de cero</strong></em>. Ejecute la línea siguiente para filtrar las filas con valores omitidos</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_to_plot</span> <span class="o">=</span> <span class="n">data_to_plot</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="o">~</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">data_to_plot</span><span class="o">.</span><span class="n">central_govt_debt</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">data_to_plot</span><span class="o">.</span><span class="n">military_exp</span><span class="p">)),</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_to_plot</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>central_govt_debt</th>
      <th>military_exp</th>
    </tr>
    <tr>
      <th>Country Code</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>CEB</th>
      <td>47.446156</td>
      <td>1.482543</td>
    </tr>
    <tr>
      <th>EMU</th>
      <td>72.414709</td>
      <td>1.618759</td>
    </tr>
    <tr>
      <th>ECS</th>
      <td>63.137736</td>
      <td>1.860343</td>
    </tr>
    <tr>
      <th>ECA</th>
      <td>22.338687</td>
      <td>2.933044</td>
    </tr>
    <tr>
      <th>TEC</th>
      <td>27.287492</td>
      <td>2.785617</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_to_plot</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(84, 2)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>La tabla anterior solo tiene valores no vacíos y ya estamos listos para <em><strong>generar los gráficos para los datos transversales</strong></em>. Las siguientes líneas de código generan el gráfico de los datos univariantes transversales sobre el gasto militar</p></li>
<li><p>Procedemos a realizar algunos <code class="docutils literal notranslate"><span class="pre">tests</span> <span class="pre">de</span> <span class="pre">normalidad</span></code> por ejemplo para <code class="docutils literal notranslate"><span class="pre">military</span> <span class="pre">expenditure</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">military_exp_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_to_plot</span><span class="o">.</span><span class="n">military_exp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">military_exp_np</span><span class="p">,</span> <span class="n">norm_hist</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Military expenditure (</span><span class="si">% o</span><span class="s1">f GDP) of 85 countries in 2010&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Military expenditure (</span><span class="si">% o</span><span class="s2">f GDP)&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/25d963e322a9e3100a66f9264b244d5d0e7fc1330cb511e8b3cfbcefc8d25097.png" src="_images/25d963e322a9e3100a66f9264b244d5d0e7fc1330cb511e8b3cfbcefc8d25097.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.graphics.gofplots</span> <span class="kn">import</span> <span class="n">qqplot</span>
<span class="n">qqplot</span><span class="p">(</span><span class="n">military_exp_np</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/21dbe8a61612569d95137c819902d7b8d89c239658e1e79cebfd62c608359296.png" src="_images/21dbe8a61612569d95137c819902d7b8d89c239658e1e79cebfd62c608359296.png" />
</div>
</div>
<p><strong><code class="docutils literal notranslate"><span class="pre">Prueba</span> <span class="pre">de</span> <span class="pre">Shapiro-Wilk</span> <span class="pre">y</span> <span class="pre">Kolmogorov-Smirnov</span></code></strong></p>
<ul class="simple">
<li><p>La prueba de <code class="docutils literal notranslate"><span class="pre">Shapiro-Wilk</span></code> evalúa una muestra de datos y cuantifica la <em><strong>probabilidad de que los datos procedan de una distribución gaussiana</strong></em>, en honor a <code class="docutils literal notranslate"><span class="pre">Samuel</span> <span class="pre">Shapiro</span></code> y <code class="docutils literal notranslate"><span class="pre">Martin</span> <span class="pre">Wilk</span></code>. En la práctica, se cree que la prueba de <code class="docutils literal notranslate"><span class="pre">Shapiro-Wilk</span></code> es una prueba fiable de normalidad, aunque hay algunos indicios de que la prueba puede ser adecuada para muestras de datos más pequeñas (<span class="math notranslate nohighlight">\(n &lt; 30\)</span>), por ejemplo, miles de observaciones o menos.</p></li>
<li><p>El test de <code class="docutils literal notranslate"><span class="pre">Kolmogorov-Smirnov</span> <span class="pre">(KS)</span></code> es <em><strong>menos afectado por el tamaño muestral</strong></em> en comparación con el test de Shapiro-Wilk. Por lo tanto, puede ser <em><strong>más apropiado para muestras grandes</strong></em>, donde el test de Shapiro-Wilk tiende a volverse más conservador. El test de KS es más general y no se limita únicamente a la normalidad. Puede utilizarse para comparar cualquier distribución empírica con una distribución teórica.</p></li>
<li><p>La función <code class="docutils literal notranslate"><span class="pre">shapiro()</span> <span class="pre">SciPy</span></code> calcula la prueba de <code class="docutils literal notranslate"><span class="pre">Shapiro-Wilk</span></code> (ver <a class="reference external" href="https://es.wikipedia.org/wiki/Prueba_de_Shapiro%E2%80%93Wilk">Shapiro-Wilk test</a>) en un conjunto de datos determinado. La función devuelve tanto el estadístico <span class="math notranslate nohighlight">\(W\)</span> calculado por la prueba como el <span class="math notranslate nohighlight">\(p\)</span>-value. A continuación se muestra el ejemplo completo de realización de la prueba de <code class="docutils literal notranslate"><span class="pre">Shapiro-Wilk</span></code> en el conjunto de datos.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
H_{0}&amp;:\quad\textsf{La variable presenta una distribución normal}\\
H_{1}&amp;:\quad\textsf{La variable presenta una distribución no normal}
\end{align*}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">shapiro</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Shapiro-Wilk Test:&#39;</span><span class="p">)</span>
<span class="n">stat</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">shapiro</span><span class="p">(</span><span class="n">military_exp_np</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Statistics=</span><span class="si">%.6f</span><span class="s1">, p=</span><span class="si">%e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">stat</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="k">if</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="n">alpha</span><span class="p">:</span>
 <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sample looks Normal (fail to reject H0)&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
 <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sample does not look Normal (reject H0)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shapiro-Wilk Test:
Statistics=0.857023, p=1.646573e-07
Sample does not look Normal (reject H0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Kolmogorov-Smirnov:&#39;</span><span class="p">)</span>
<span class="n">stat</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">kstest</span><span class="p">(</span><span class="n">military_exp_np</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Statistics=</span><span class="si">%.6f</span><span class="s1">, p=</span><span class="si">%e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">stat</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="k">if</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="n">alpha</span><span class="p">:</span>
 <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sample looks Normal (fail to reject H0)&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
 <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sample does not look Normal (reject H0)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Kolmogorov-Smirnov:
Statistics=0.659326, p=2.320049e-36
Sample does not look Normal (reject H0)
</pre></div>
</div>
</div>
</div>
<p><strong><code class="docutils literal notranslate"><span class="pre">Prueba</span></code></strong> <span class="math notranslate nohighlight">\(K^2\)</span> <strong><code class="docutils literal notranslate"><span class="pre">de</span> <span class="pre">D'Agostino</span></code></strong></p>
<ul class="simple">
<li><p>La prueba <span class="math notranslate nohighlight">\(K^2\)</span> de D’Agostino calcula los estadísticos de resumen de los datos, es decir, <em><strong>la curtosis y la asimetría, para determinar si la distribución de los datos se aparta de la distribución normal</strong></em>, llamada así por <code class="docutils literal notranslate"><span class="pre">Ralph</span> <span class="pre">D'Agostino</span></code>. La asimetría (<code class="docutils literal notranslate"><span class="pre">skew</span></code>) es una cuantificación del grado en que una distribución se desplaza hacia la izquierda o hacia la derecha, es una <em><strong>medida de la asimetría de la distribución</strong></em>.</p></li>
<li><p>La curtosis (<code class="docutils literal notranslate"><span class="pre">kurtosis</span></code>) <em><strong>cuantifica la proporción de la distribución que se encuentra en cierta cola lateral</strong></em> (ver <a class="reference internal" href="#kurtosis-fig"><span class="std std-numref">Fig. 1.1</span></a>). Es una prueba estadística de normalidad sencilla y de uso común. La prueba <span class="math notranslate nohighlight">\(K^2\)</span> de D’Agostino está disponible a través de la función <code class="docutils literal notranslate"><span class="pre">SciPy</span> <span class="pre">normaltest()</span></code> y devuelve el estadístico de la prueba y el <span class="math notranslate nohighlight">\(p\)</span>-value</p></li>
</ul>
<figure class="align-center" id="kurtosis-fig">
<a class="reference internal image-reference" href="_images/kurtosis.png"><img alt="_images/kurtosis.png" src="_images/kurtosis.png" style="width: 512.0px; height: 384.0px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 1.1 </span><span class="caption-text">Diferentes distribuciones asociadas a multiples valores de <code class="docutils literal notranslate"><span class="pre">kurtosis</span></code>.</span><a class="headerlink" href="#kurtosis-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>D: <code class="docutils literal notranslate"><span class="pre">Distribución</span> <span class="pre">de</span> <span class="pre">Laplace</span></code> (kurtosis = 3);</p></li>
<li><p>S: <code class="docutils literal notranslate"><span class="pre">Distribución</span> <span class="pre">hiperbólica</span> <span class="pre">secante</span></code>, (kurtosis = 2);</p></li>
<li><p>L: <code class="docutils literal notranslate"><span class="pre">Distribución</span> <span class="pre">logística</span></code>, (kurtosis = 1.2);</p></li>
<li><p>N: <code class="docutils literal notranslate"><span class="pre">Distribución</span> <span class="pre">normal</span></code>, (kurtosis = 0);</p></li>
<li><p>C: <code class="docutils literal notranslate"><span class="pre">Distribución</span> <span class="pre">del</span> <span class="pre">coseno</span> <span class="pre">elevado</span></code>, (kurtosis = -0,593762);</p></li>
<li><p>W: <code class="docutils literal notranslate"><span class="pre">Distribución</span> <span class="pre">del</span> <span class="pre">semicírculo</span> <span class="pre">de</span> <span class="pre">Wigner</span></code>, (kurtosis = -1);</p></li>
<li><p>U: <code class="docutils literal notranslate"><span class="pre">Distribución</span> <span class="pre">uniforme</span></code>, (kurtosis = -1.2).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">normaltest</span><span class="p">,</span> <span class="n">kurtosis</span><span class="p">,</span> <span class="n">skew</span>

<span class="n">stat</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">normaltest</span><span class="p">(</span><span class="n">military_exp_np</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Statistics=</span><span class="si">%.3f</span><span class="s1">, p=</span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">stat</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="k">if</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="n">alpha</span><span class="p">:</span>
 <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sample looks Gaussian (fail to reject H0)&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
 <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sample does not look Gaussian (reject H0)&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Kurtosis=</span><span class="si">%.3f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">kurtosis</span>(military_exp_np))
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Skew=</span><span class="si">%.3f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">skew</span>(military_exp_np))
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Statistics=49.874, p=0.000
Sample does not look Gaussian (reject H0)
Kurtosis=6.122
Skew=1.916
</pre></div>
</div>
</div>
</div>
<div class="admonition-observacion admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Kurtosis</span> <span class="pre">mayor</span> <span class="pre">que</span> <span class="pre">0</span></code>: Indica una <em><strong>distribución <code class="docutils literal notranslate"><span class="pre">leptocúrtica</span></code></strong></em>, lo que significa que la distribución tiene <em><strong>colas más pesadas</strong></em> y es <em><strong>más puntiaguda en comparación con una distribución normal</strong></em>. Esto implica que hay una <em>mayor concentración de datos alrededor de la media, con valores extremos más frecuentes</em>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Kurtosis</span> <span class="pre">menor</span> <span class="pre">que</span> <span class="pre">0</span></code>: Indica una <em><strong>distribución <code class="docutils literal notranslate"><span class="pre">platicúrtica</span></code></strong></em>, lo que significa que la distribución es <em><strong>más aplanada</strong></em> y tiene <em><strong>colas más ligeras en comparación con una distribución normal</strong></em>. Esto implica que <em>los datos están más dispersos y hay menos valores en la región de la media, con valores extremos menos frecuentes</em>.</p></li>
</ul>
</div>
<ul class="simple">
<li><p>La figura anterior, también puede realizarse para múltiples variables, a fin de comprender su distribución conjunta. Ilustremos un <em><strong>análisis bivariante</strong></em> considerando la deuda total de los gobiernos centrales de los países junto con su gasto militar en 2010.</p></li>
<li><p>La siguiente figura muestra las distribuciones conjuntas de estas variables en forma de <em><strong>gráficos de densidad de kernel</strong></em>. La distribución conjunta bivariante <em><strong>no muestra una correlación clara entre</strong></em> <code class="docutils literal notranslate"><span class="pre">'Military</span> <span class="pre">expenditures</span> <span class="pre">&amp;</span> <span class="pre">Debt</span> <span class="pre">of</span> <span class="pre">central</span> <span class="pre">governments</span> <span class="pre">in</span> <span class="pre">2010'</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data_to_plot</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;military_exp&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;central_govt_debt&quot;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Military expenditures &amp; Debt of central governments in 2010&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Military expenditure&quot;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Debt of central governments&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/cb36540b717e989c9efb2e4edff53ebd482b41eeea4aef89e37e8c788c3fb1b9.png" src="_images/cb36540b717e989c9efb2e4edff53ebd482b41eeea4aef89e37e8c788c3fb1b9.png" />
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>El análisis de datos transversales no se limita al análisis exploratorio y visualización, sino que también <em><strong>incluye métodos avanzados como la regresión transversal</strong></em>, que ajusta modelos entre múltiples variables y una variable dependiente, como en el análisis de pérdida de clientes.</p></li>
<li><p>La <em><strong>regresión logística</strong></em>, un caso especial de <em><strong>modelo lineal generalizado</strong></em>, se utiliza para <em><strong>explicar y predecir la pérdida de clientes, sin depender del tiempo</strong></em>. En este curso, <em><strong>se tratan técnicas de modelado de datos de series temporales, donde el tiempo y la secuencialidad son fundamentales</strong></em>.</p></li>
</ul>
</div>
</section>
<section id="datos-de-series-temporales">
<h2><span class="section-number">1.3. </span>Datos de series temporales<a class="headerlink" href="#datos-de-series-temporales" title="Link to this heading">#</a></h2>
<div class="admonition-introduccion admonition">
<p class="admonition-title">Introducción</p>
<ul class="simple">
<li><p>El ejemplo de datos transversales comentado anteriormente <em><strong>corresponde únicamente al año 2010</strong></em>. Sin embargo, en cambio, si consideramos un solo país, por ejemplo Estados Unidos (<code class="docutils literal notranslate"><span class="pre">USA</span></code>), y echamos un vistazo a sus <code class="docutils literal notranslate"><span class="pre">Federal</span> <span class="pre">Military</span> <span class="pre">Expenditure</span></code>, <code class="docutils literal notranslate"><span class="pre">Debt</span> <span class="pre">of</span> <span class="pre">Federal</span> <span class="pre">Government</span></code>, durante un <em><strong>periodo de 10 años, de 2001 a 2010</strong></em>, obtendríamos dos series temporales:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Federal</span> <span class="pre">Military</span> <span class="pre">Expenditure</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Debt</span> <span class="pre">of</span> <span class="pre">Federal</span> <span class="pre">Government</span></code></p></li>
</ul>
</li>
<li><p>Por lo tanto, en esencia, <em><strong>una serie temporal se compone de observaciones cuantitativas sobre una o más características medibles de una entidad individual y tomadas en múltiples puntos en el tiempo</strong></em>. En este caso, los datos representan <code class="docutils literal notranslate"><span class="pre">Federal</span> <span class="pre">Military</span> <span class="pre">Expenditure</span></code>, <code class="docutils literal notranslate"><span class="pre">Debt</span> <span class="pre">of</span> <span class="pre">Federal</span> <span class="pre">Government</span></code>.</p></li>
</ul>
</div>
<ul class="simple">
<li><p>Los datos de series temporales suelen caracterizarse por varias estructuras internas interesantes, como la <em><strong>tendencia</strong></em>, la <em><strong>estacionalidad</strong></em>, <em><strong>estacionariedad</strong></em>, <em><strong>autocorrelación</strong></em>, etc. Las estructuras internas de los datos de series temporales requieren una formulación y técnicas especiales para su análisis. Estas técnicas se tratarán en los siguientes capítulos con estudios de casos e implementación de código de trabajo en <code class="docutils literal notranslate"><span class="pre">Python</span></code>.</p></li>
</ul>
<ul class="simple">
<li><p>Para generar los gráficos anteriores usaremos el código que se desarrolló para obtener los gráficos para los datos transversales. Comenzaremos creando <em><strong>dos nuevas series para representar las series temporales de</strong></em>  <code class="docutils literal notranslate"><span class="pre">Federal</span> <span class="pre">Military</span> <span class="pre">Expenditure</span></code> y <code class="docutils literal notranslate"><span class="pre">Debt</span> <span class="pre">of</span> <span class="pre">Federal</span> <span class="pre">Government</span></code>, desde 1960 hasta 2010</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">central_govt_debt_us</span> <span class="o">=</span> <span class="n">central_govt_debt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">central_govt_debt</span><span class="p">[</span><span class="s1">&#39;Country Code&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;USA&#39;</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">T</span>
<span class="n">military_exp_us</span> <span class="o">=</span> <span class="n">military_exp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">military_exp</span><span class="p">[</span><span class="s1">&#39;Country Code&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;USA&#39;</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Los dos objetos <code class="docutils literal notranslate"><span class="pre">Series</span></code> creados en el código anterior se fusionan para formar un único <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> y se cortan para contener los datos de los años 2001 a 2010:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_us</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">military_exp_us</span><span class="p">,</span> <span class="n">central_govt_debt_us</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">index0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data_us</span><span class="o">.</span><span class="n">index</span><span class="o">==</span><span class="s1">&#39;1960&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">index1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data_us</span><span class="o">.</span><span class="n">index</span><span class="o">==</span><span class="s1">&#39;2010&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data_us</span> <span class="o">=</span> <span class="n">data_us</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index0</span><span class="p">:</span><span class="n">index1</span><span class="o">+</span><span class="mi">1</span><span class="p">,:]</span>
<span class="n">data_us</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Federal Military Expenditure&#39;</span><span class="p">,</span> <span class="s1">&#39;Debt of Federal Government&#39;</span><span class="p">]</span>
<span class="n">data_us</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Federal Military Expenditure</th>
      <th>Debt of Federal Government</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1960</th>
      <td>8.35266</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1961</th>
      <td>8.487129</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1962</th>
      <td>8.656586</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1963</th>
      <td>8.189007</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1964</th>
      <td>7.467629</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Podemos utilizar los métodos <code class="docutils literal notranslate"><span class="pre">isna()</span></code> o <code class="docutils literal notranslate"><span class="pre">isnull()</span></code> para <em><strong>contabilizar datos faltantes en los datos</strong></em>. Podemos obtener el total de valores perdidos en cada columna con la función <code class="docutils literal notranslate"><span class="pre">sum()</span></code> o tomar la media con <code class="docutils literal notranslate"><span class="pre">mean()</span></code>. <em><strong>Técnicas de imputación de datos faltantes</strong></em> pueden ser utilizadas del módulo de <a class="reference external" href="https://lihkir.github.io/DataVizPythonRUninorte/common_errors.html#imputacion-multiple-iterativa">DataViz</a></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_us</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Federal Military Expenditure     0
Debt of Federal Government      29
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">data_us</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">data_us</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Federal Military Expenditure     0.000000
Debt of Federal Government      56.862745
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_us</span><span class="p">[</span><span class="s1">&#39;backward_fill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_us</span><span class="p">[</span><span class="s1">&#39;Debt of Federal Government&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">bfill</span><span class="p">()</span>
<span class="n">data_us</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Federal Military Expenditure</th>
      <th>Debt of Federal Government</th>
      <th>backward_fill</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1960</th>
      <td>8.35266</td>
      <td>NaN</td>
      <td>39.016963</td>
    </tr>
    <tr>
      <th>1961</th>
      <td>8.487129</td>
      <td>NaN</td>
      <td>39.016963</td>
    </tr>
    <tr>
      <th>1962</th>
      <td>8.656586</td>
      <td>NaN</td>
      <td>39.016963</td>
    </tr>
    <tr>
      <th>1963</th>
      <td>8.189007</td>
      <td>NaN</td>
      <td>39.016963</td>
    </tr>
    <tr>
      <th>1964</th>
      <td>7.467629</td>
      <td>NaN</td>
      <td>39.016963</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>El método <code class="docutils literal notranslate"><span class="pre">.bfill()</span></code> en <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> se utiliza para <em><strong>rellenar los valores faltantes</strong></em> (<code class="docutils literal notranslate"><span class="pre">NaN</span></code>) en una <code class="docutils literal notranslate"><span class="pre">Serie</span></code> o <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> <em><strong>hacia atrás</strong></em> (<code class="docutils literal notranslate"><span class="pre">backward</span> <span class="pre">fill</span></code>). Por ejemplo, si tiene una columna con valores <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">NaN,</span> <span class="pre">3,</span> <span class="pre">NaN,</span> <span class="pre">5]</span></code>, al aplicar <code class="docutils literal notranslate"><span class="pre">.bfill()</span></code>, los <em><strong>valores faltantes se llenarán con los valores siguientes más cercanos</strong></em>, dando como resultado <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">3,</span> <span class="pre">3,</span> <span class="pre">5,</span> <span class="pre">5]</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_us</span><span class="p">[</span><span class="s1">&#39;mean_fill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_us</span><span class="p">[</span><span class="s1">&#39;Debt of Federal Government&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">data_us</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Federal Military Expenditure</th>
      <th>Debt of Federal Government</th>
      <th>backward_fill</th>
      <th>mean_fill</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1960</th>
      <td>8.35266</td>
      <td>NaN</td>
      <td>39.016963</td>
      <td>51.155537</td>
    </tr>
    <tr>
      <th>1961</th>
      <td>8.487129</td>
      <td>NaN</td>
      <td>39.016963</td>
      <td>51.155537</td>
    </tr>
    <tr>
      <th>1962</th>
      <td>8.656586</td>
      <td>NaN</td>
      <td>39.016963</td>
      <td>51.155537</td>
    </tr>
    <tr>
      <th>1963</th>
      <td>8.189007</td>
      <td>NaN</td>
      <td>39.016963</td>
      <td>51.155537</td>
    </tr>
    <tr>
      <th>1964</th>
      <td>7.467629</td>
      <td>NaN</td>
      <td>39.016963</td>
      <td>51.155537</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_us</span><span class="p">[</span><span class="s1">&#39;median_fill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_us</span><span class="p">[</span><span class="s1">&#39;Debt of Federal Government&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="n">data_us</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Federal Military Expenditure</th>
      <th>Debt of Federal Government</th>
      <th>backward_fill</th>
      <th>mean_fill</th>
      <th>median_fill</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1960</th>
      <td>8.35266</td>
      <td>NaN</td>
      <td>39.016963</td>
      <td>51.155537</td>
      <td>47.659404</td>
    </tr>
    <tr>
      <th>1961</th>
      <td>8.487129</td>
      <td>NaN</td>
      <td>39.016963</td>
      <td>51.155537</td>
      <td>47.659404</td>
    </tr>
    <tr>
      <th>1962</th>
      <td>8.656586</td>
      <td>NaN</td>
      <td>39.016963</td>
      <td>51.155537</td>
      <td>47.659404</td>
    </tr>
    <tr>
      <th>1963</th>
      <td>8.189007</td>
      <td>NaN</td>
      <td>39.016963</td>
      <td>51.155537</td>
      <td>47.659404</td>
    </tr>
    <tr>
      <th>1964</th>
      <td>7.467629</td>
      <td>NaN</td>
      <td>39.016963</td>
      <td>51.155537</td>
      <td>47.659404</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_us</span><span class="p">[</span><span class="s1">&#39;quadratic_fill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_us</span><span class="p">[</span><span class="s1">&#39;Debt of Federal Government&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="s1">&#39;quadratic&#39;</span><span class="p">)</span>
<span class="n">data_us</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Federal Military Expenditure</th>
      <th>Debt of Federal Government</th>
      <th>backward_fill</th>
      <th>mean_fill</th>
      <th>median_fill</th>
      <th>quadratic_fill</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1960</th>
      <td>8.35266</td>
      <td>NaN</td>
      <td>39.016963</td>
      <td>51.155537</td>
      <td>47.659404</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1961</th>
      <td>8.487129</td>
      <td>NaN</td>
      <td>39.016963</td>
      <td>51.155537</td>
      <td>47.659404</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1962</th>
      <td>8.656586</td>
      <td>NaN</td>
      <td>39.016963</td>
      <td>51.155537</td>
      <td>47.659404</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1963</th>
      <td>8.189007</td>
      <td>NaN</td>
      <td>39.016963</td>
      <td>51.155537</td>
      <td>47.659404</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1964</th>
      <td>7.467629</td>
      <td>NaN</td>
      <td>39.016963</td>
      <td>51.155537</td>
      <td>47.659404</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>El método <code class="docutils literal notranslate"><span class="pre">interpolate()</span></code> en <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> se utiliza para <em><strong>interpolar los valores faltantes</strong></em> en una <code class="docutils literal notranslate"><span class="pre">Serie</span></code> o <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>. Al especificar <code class="docutils literal notranslate"><span class="pre">option='quadratic'</span></code>, está indicando que desea <em><strong>utilizar la interpolación cuadrática</strong></em> para llenar los valores faltantes.</p></li>
</ul>
<ul class="simple">
<li><p>Existen otras técnicas de imputación de datos, tales como por ejemplo: <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.KNNImputer.html">sklearn.impute.KNNImputer</a>, <a class="reference external" href="https://lihkir.github.io/DataVizPython/common_errors.html#imputacion-multiple-iterativa">IterativeImputer</a>, etc.,… Nótese que la columna <code class="docutils literal notranslate"><span class="pre">quadratic_fill</span></code> mantiene los valores <code class="docutils literal notranslate"><span class="pre">NaN</span></code>. Esta técnica ofrece las siguientes versiones de imputación: <code class="docutils literal notranslate"><span class="pre">'nearest',</span> <span class="pre">'zero',</span> <span class="pre">'slinear',</span> <span class="pre">'quadratic',</span> <span class="pre">'cubic',</span> <span class="pre">'spline',</span> <span class="pre">'barycentric',</span> <span class="pre">'polynomial'</span></code> las cuales se le invita a revisar en la documentación. Realice para cada imputación una representación de su nueva distribución e identifique si esta se vio realmente afectada.</p></li>
</ul>
<ul class="simple">
<li><p>Dado que el cuadro anterior muestra que no se dispone solamente de datos sobre <code class="docutils literal notranslate"><span class="pre">Debt</span> <span class="pre">of</span> <span class="pre">Federal</span> <span class="pre">Government</span></code> de varios años a partir de 1960, y se necesitan las dos dimensiones, <em><strong>otra opción es eliminar las filas con datos faltantes</strong></em> del <code class="docutils literal notranslate"><span class="pre">Dataframe</span></code>, <code class="docutils literal notranslate"><span class="pre">data_us</span></code> antes de trazar la serie temporal</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_us</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Shape of data_us:&#39;</span><span class="p">,</span> <span class="n">data_us</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape of data_us: (22, 6)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_us</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Federal Military Expenditure</th>
      <th>Debt of Federal Government</th>
      <th>backward_fill</th>
      <th>mean_fill</th>
      <th>median_fill</th>
      <th>quadratic_fill</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1989</th>
      <td>5.374717</td>
      <td>39.016963</td>
      <td>39.016963</td>
      <td>51.155537</td>
      <td>47.659404</td>
      <td>39.016963</td>
    </tr>
    <tr>
      <th>1990</th>
      <td>5.120252</td>
      <td>40.821367</td>
      <td>40.821367</td>
      <td>51.155537</td>
      <td>47.659404</td>
      <td>40.821367</td>
    </tr>
    <tr>
      <th>1991</th>
      <td>4.539845</td>
      <td>43.948026</td>
      <td>43.948026</td>
      <td>51.155537</td>
      <td>47.659404</td>
      <td>43.948026</td>
    </tr>
    <tr>
      <th>1992</th>
      <td>4.666265</td>
      <td>45.916542</td>
      <td>45.916542</td>
      <td>51.155537</td>
      <td>47.659404</td>
      <td>45.916542</td>
    </tr>
    <tr>
      <th>1993</th>
      <td>4.326925</td>
      <td>48.104749</td>
      <td>48.104749</td>
      <td>51.155537</td>
      <td>47.659404</td>
      <td>48.104749</td>
    </tr>
    <tr>
      <th>1994</th>
      <td>3.941287</td>
      <td>47.21406</td>
      <td>47.214060</td>
      <td>51.155537</td>
      <td>47.659404</td>
      <td>47.21406</td>
    </tr>
    <tr>
      <th>1995</th>
      <td>3.638489</td>
      <td>47.059783</td>
      <td>47.059783</td>
      <td>51.155537</td>
      <td>47.659404</td>
      <td>47.059783</td>
    </tr>
    <tr>
      <th>1996</th>
      <td>3.350744</td>
      <td>46.585511</td>
      <td>46.585511</td>
      <td>51.155537</td>
      <td>47.659404</td>
      <td>46.585511</td>
    </tr>
    <tr>
      <th>1997</th>
      <td>3.209903</td>
      <td>43.958801</td>
      <td>43.958801</td>
      <td>51.155537</td>
      <td>47.659404</td>
      <td>43.958801</td>
    </tr>
    <tr>
      <th>1998</th>
      <td>3.017636</td>
      <td>41.009914</td>
      <td>41.009914</td>
      <td>51.155537</td>
      <td>47.659404</td>
      <td>41.009914</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Por último, las <em><strong>series temporales</strong></em> se generan ejecutando el siguiente código</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Federal Military Expenditure during 1988-2010 (</span><span class="si">% o</span><span class="s1">f GDP)&#39;</span><span class="p">)</span>
<span class="n">data_us</span><span class="p">[</span><span class="s1">&#39;Federal Military Expenditure&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Debt of Federal Government during 1988-2010 (</span><span class="si">% o</span><span class="s1">f GDP)&#39;</span><span class="p">)</span>
<span class="n">data_us</span><span class="p">[</span><span class="s1">&#39;Debt of Federal Government&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4ca1a81738226fcf387ecf049ca3309dee7f99a878db67fb49cc5243d7fb8c5b.png" src="_images/4ca1a81738226fcf387ecf049ca3309dee7f99a878db67fb49cc5243d7fb8c5b.png" />
</div>
</div>
</section>
<section id="datos-de-panel">
<h2><span class="section-number">1.4. </span>Datos de panel<a class="headerlink" href="#datos-de-panel" title="Link to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title">Introducción</p>
<ul class="simple">
<li><p>Hemos visto <em><strong>datos transversales (de múltiples individuos en un solo punto en el tiempo)</strong></em> y <em><strong>series temporales (de una entidad a lo largo de múltiples puntos en el tiempo)</strong></em>. Si observamos <em><strong>múltiples entidades a lo largo de múltiples puntos en el tiempo</strong></em>, obtenemos un <em><strong>panel de datos o datos longitudinales</strong></em>.</p></li>
<li><p>Tomando como ejemplo para <em><strong>cuatro países</strong></em> <code class="docutils literal notranslate"><span class="pre">'Military</span> <span class="pre">expenditure</span> <span class="pre">(%</span> <span class="pre">of</span> <span class="pre">GDP)'</span></code> durante el periodo 1960-2010, creamos un <em><strong>conjunto de datos de panel</strong></em>. Ahora, prepararemos los datos para trazar la figura correspondiente, siguiendo un proceso similar al utilizado para los datos transversales y de series temporales en este capítulo.</p></li>
</ul>
</div>
<ul class="simple">
<li><p>Preparemos los datos necesarios para trazar la figura correspondiente. Seguiremos el código que hemos utilizado para los datos transversales y de series temporales en este capítulo. Empezaremos creando un <em><strong>DataFrame con los datos de las cuatro empresas mencionadas en el gráfico anterior</strong></em>. Esto se hace de la siguiente manera:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chn</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Indicator Name&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Military expenditure (</span><span class="si">% o</span><span class="s1">f GDP)&#39;</span><span class="p">)</span> <span class="o">&amp;</span> \
               <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Country Code&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;CHN&#39;</span><span class="p">),</span> <span class="p">:]</span> <span class="c1">#China</span>
<span class="n">chn</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country Name</th>
      <th>Country Code</th>
      <th>Indicator Name</th>
      <th>Indicator Code</th>
      <th>1960</th>
      <th>1961</th>
      <th>1962</th>
      <th>1963</th>
      <th>1964</th>
      <th>1965</th>
      <th>...</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>Unnamed: 61</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>134507</th>
      <td>China</td>
      <td>CHN</td>
      <td>Military expenditure (% of GDP)</td>
      <td>MS.MIL.XPND.GD.ZS</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.878156</td>
      <td>2.067426</td>
      <td>1.896713</td>
      <td>1.821927</td>
      <td>1.838564</td>
      <td>1.872334</td>
      <td>1.915341</td>
      <td>1.934922</td>
      <td>1.922962</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 62 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chn</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Indicator Name&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Military expenditure (</span><span class="si">% o</span><span class="s1">f GDP)&#39;</span><span class="p">)</span> <span class="o">&amp;</span> \
               <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Country Code&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;CHN&#39;</span><span class="p">),</span> <span class="p">:]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">chn</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Indicator Code</th>
      <th>1960</th>
      <th>1961</th>
      <th>1962</th>
      <th>1963</th>
      <th>1964</th>
      <th>1965</th>
      <th>1966</th>
      <th>1967</th>
      <th>1968</th>
      <th>...</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>Unnamed: 61</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>134507</th>
      <td>MS.MIL.XPND.GD.ZS</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.878156</td>
      <td>2.067426</td>
      <td>1.896713</td>
      <td>1.821927</td>
      <td>1.838564</td>
      <td>1.872334</td>
      <td>1.915341</td>
      <td>1.934922</td>
      <td>1.922962</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 59 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chn</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">chn</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">chn</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">chn</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">chn</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Indicator Code    MS.MIL.XPND.GD.ZS
1989                       2.499185
1990                       2.555996
1991                       2.407892
1992                       2.518629
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">usa</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Indicator Name&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Military expenditure (</span><span class="si">% o</span><span class="s1">f GDP)&#39;</span><span class="p">)</span> <span class="o">&amp;</span> \
               <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Country Code&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;USA&#39;</span><span class="p">),</span> <span class="p">:]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#USA</span>
<span class="n">usa</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">usa</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">usa</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">usa</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">usa</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Indicator Code    MS.MIL.XPND.GD.ZS
1960                        8.35266
1961                       8.487129
1962                       8.656586
1963                       8.189007
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ind</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Indicator Name&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Military expenditure (</span><span class="si">% o</span><span class="s1">f GDP)&#39;</span><span class="p">)</span> <span class="o">&amp;</span> \
               <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Country Code&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;IND&#39;</span><span class="p">),</span> <span class="p">:]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#India</span>
<span class="n">ind</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ind</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">ind</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">ind</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ind</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Indicator Code    MS.MIL.XPND.GD.ZS
1960                       1.866015
1961                       1.933365
1962                       2.561202
1963                       3.758057
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gbr</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Indicator Name&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Military expenditure (</span><span class="si">% o</span><span class="s1">f GDP)&#39;</span><span class="p">)</span> <span class="o">&amp;</span> \
               <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Country Code&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;GBR&#39;</span><span class="p">),</span> <span class="p">:]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#United Kingdom</span>
<span class="n">gbr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">gbr</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">gbr</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">gbr</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">gbr</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Indicator Code    MS.MIL.XPND.GD.ZS
1960                       6.343041
1961                       6.190022
1962                       6.210394
1963                       6.082126
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_years</span> <span class="o">=</span> <span class="n">chn</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;#Years: &quot;</span><span class="p">,</span> <span class="n">n_years</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>#Years:  30
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">usa</span><span class="p">[</span><span class="n">n_years</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">n_years</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">chn</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">n_years</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">gbr</span><span class="p">[</span><span class="n">n_years</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">n_years</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">ind</span><span class="p">[</span><span class="n">n_years</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">n_years</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;USA&#39;</span><span class="p">,</span><span class="s1">&#39;CHINA&#39;</span><span class="p">,</span><span class="s1">&#39;UK&#39;</span><span class="p">,</span><span class="s1">&#39;INDIA&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Miltitary expenditure of 4 countries over 30 years&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Military expenditure (</span><span class="si">% o</span><span class="s1">f GDP)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Years&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a8771cdfa94549e021abb95da9de3a161089af425cdf28d01ed32e016507d681.png" src="_images/a8771cdfa94549e021abb95da9de3a161089af425cdf28d01ed32e016507d681.png" />
</div>
</div>
</section>
<section id="estructuras-internas-de-las-series-temporales">
<h2><span class="section-number">1.5. </span>Estructuras internas de las series temporales<a class="headerlink" href="#estructuras-internas-de-las-series-temporales" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>En esta sección, explicaremos conceptualmente las siguientes <em><strong>características especiales de los datos de series temporales</strong></em> que requieren un tratamiento matemático especial</p>
<ul>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">Tendencia</span> <span class="pre">general</span></code></strong></p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">Estacionalidad</span></code></strong></p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">Movimientos</span> <span class="pre">cíclicos</span></code></strong></p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">Componentes</span> <span class="pre">irregulares</span></code></strong></p></li>
</ul>
</li>
</ul>
<ul>
<li><p>La mayoría de las series temporales <em><strong>presentan una o varias de las estructuras internas mencionadas</strong></em>. Basándose en esta noción, una <em><strong>serie temporal puede expresarse como</strong></em></p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \\[1mm]
    y_{t}=f_{t}+s_{t}+c_{t}+e_{t},
    \end{split}\]</div>
<p>que es una suma de los componentes de <em><strong>tendencia, componentes estacionales, cíclicas e irregulares</strong></em> en ese orden. Aquí, <span class="math notranslate nohighlight">\(t\)</span> es el <em><strong>índice temporal</strong></em> en el que observaciones sobre la serie se han tomado en <span class="math notranslate nohighlight">\(t = 1,2,3, \dots, T\)</span> <em><strong>puntos sucesivos e igualmente espaciados en el tiempo</strong></em>.</p>
</li>
<li><p>El objetivo del análisis de series temporales es <em><strong>descomponer una serie temporal en sus características constitutivas y desarrollar modelos matemáticos para ellas</strong></em>. Estos modelos se utilizan para comprender las causas del comportamiento observado de la serie temporal y <em><strong>predecirla para momentos futuros</strong></em>.</p></li>
</ul>
</section>
<section id="tendencia-general">
<h2><span class="section-number">1.6. </span>Tendencia general<a class="headerlink" href="#tendencia-general" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Cuando una serie temporal presenta un <em><strong>movimiento ascendente o descendente a largo plazo, se dice que tiene tendencia general</strong></em>. Una forma rápida de comprobar la presencia de una tendencia general es trazar la serie temporal como en la siguiente figura, que muestra las <em><strong>concentraciones de CO2 en el aire</strong></em> medidas durante 1974 hasta 1987</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;/home/lihkir/Data/Monthly_CO2_Concentrations.xlsx&#39;</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Year&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="s1">&#39;Month&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CO2</th>
      <th>Year</th>
      <th>Month</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>333.13</td>
      <td>1974</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>332.09</td>
      <td>1974</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>331.10</td>
      <td>1974</td>
      <td>7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>329.14</td>
      <td>1974</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>327.36</td>
      <td>1974</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Creamos índice de filas del <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> utilizando las columnas <code class="docutils literal notranslate"><span class="pre">Year</span></code> y <code class="docutils literal notranslate"><span class="pre">Month</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="o">+</span><span class="n">x</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CO2</th>
      <th>Year</th>
      <th>Month</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1974-05</th>
      <td>333.13</td>
      <td>1974</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1974-06</th>
      <td>332.09</td>
      <td>1974</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1974-07</th>
      <td>331.10</td>
      <td>1974</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1974-08</th>
      <td>329.14</td>
      <td>1974</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1974-09</th>
      <td>327.36</td>
      <td>1974</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="o">~</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">]))</span> <span class="o">&amp;</span> \
                <span class="p">(</span><span class="o">~</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]))</span><span class="o">&amp;</span> \
                <span class="p">(</span><span class="o">~</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]))]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Month&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Monthly CO2 concentrations&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;CO2 concentratition&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b8160ab99195cd49624a52a929b1459a97c38d4a620c2bd7932392ee28c29a5a.png" src="_images/b8160ab99195cd49624a52a929b1459a97c38d4a620c2bd7932392ee28c29a5a.png" />
</div>
</div>
<ul class="simple">
<li><p>Nótese que, <code class="docutils literal notranslate"><span class="pre">pd.infer_freq()</span></code> devuelve <code class="docutils literal notranslate"><span class="pre">&quot;MS&quot;</span></code>, lo cual significa que <em><strong>la serie de tiempo tiene una frecuencia mensual</strong></em> y que <em><strong>cada punto de datos representa el primer día de cada mes</strong></em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y-%m&#39;</span><span class="p">)</span>
<span class="n">frecuencia</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">infer_freq</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Frecuencia: &quot;</span><span class="p">,</span> <span class="n">frecuencia</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Frecuencia:  MS
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Sin embargo, <em><strong>la tendencia general puede no ser evidente a corto plazo</strong></em>. Los efectos a corto plazo como las <em><strong>fluctuaciones estacionales</strong></em> y las <em><strong>variaciones irregulares</strong></em> hacen que las series temporales vuelvan a registrar valores más bajos o más altos observados en el pasado, por lo que pueden <em><strong>ocultar temporalmente cualquier tendencia general</strong></em>.</p></li>
<li><p>Esto es evidente en la misma serie temporal de concentraciones de CO2 cuando se considera de 1979 a 1981, como se muestra en la siguiente figura. Por tanto, <em><strong>para revelar la tendencia general, necesitamos una serie temporal que se remonte sustancialmente al pasado</strong></em>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1980</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1981</span><span class="p">)]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Monthly CO2 concentrations&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;CO2 concentratition&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7c333c3f35b3ccae756c2924441db4ccbaaf804251ffe52914e8c4e6dd38c168.png" src="_images/7c333c3f35b3ccae756c2924441db4ccbaaf804251ffe52914e8c4e6dd38c168.png" />
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>La tendencia general de la serie temporal se debe a <em><strong>cambios fundamentales o sistémicos del proceso o sistema que representa</strong></em>. Por ejemplo, el movimiento ascendente de las concentraciones de CO2 entre 1974 y 1987 puede atribuirse al <em><strong>aumento gradual de los automóviles y la industrialización durante esos años</strong></em>.</p></li>
<li><p>La <em><strong>tendencia</strong></em> de una serie temporal <em><strong>se modela comúnmente mediante una regresión respecto al tiempo</strong></em> y otras variables conocidas como explicativas. Esta regresión se usa para <em><strong>predecir el movimiento a largo plazo de la serie</strong></em>. Los <em><strong>residuos</strong></em> de esta regresión <em><strong>revelan otras características como la estacionalidad, ciclos y variaciones irregulares</strong></em>.</p></li>
</ul>
</div>
<ul class="simple">
<li><p>A continuación, vamos a <em><strong>ajustar la línea de tendencia</strong></em>. Para ello importamos la clase <code class="docutils literal notranslate"><span class="pre">LinearRegression</span></code> de <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> y ajustamos un modelo lineal al índice temporal. Para instalar la librería, utilice la orden</p></li>
</ul>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>-U<span class="w"> </span>sklearn-learn
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trend_model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">trend_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LinearRegression()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;LinearRegression<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.linear_model.LinearRegression.html">?<span>Documentation for LinearRegression</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>LinearRegression()</pre></div> </div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Trend model coefficient=</span><span class="si">{}</span><span class="s1"> and intercept=</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">trend_model</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">trend_model</span><span class="o">.</span><span class="n">intercept_</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Trend model coefficient=0.1209930124223602 and intercept=329.45310559006214
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>El <em><strong>residual obtenido a partir del modelo de línea de tendencia</strong></em> se muestra en la siguiente figura, el cual <em><strong>presenta un comportamiento estacional</strong></em>, el cual se analizará en la siguiente sección. Los residuos se calculan y se representan mediante la siguiente línea de código</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">residuals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="n">trend_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">residuals</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Residuals of trend model for CO2 concentrations&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;CO2 concentratition&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/025142999636b291719f482bf58cc33ca4ba1437fd9d8b9033e68e58781d47e6.png" src="_images/025142999636b291719f482bf58cc33ca4ba1437fd9d8b9033e68e58781d47e6.png" />
</div>
</div>
</section>
<section id="estacionalidad">
<h2><span class="section-number">1.7. </span>Estacionalidad<a class="headerlink" href="#estacionalidad" title="Link to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title">Introducción</p>
<ul class="simple">
<li><p>La <em><strong>estacionalidad muestra variaciones repetitivas y periódicas en una serie temporal</strong></em>, comúnmente reveladas durante el <em>análisis exploratorio de datos</em>. Por ejemplo, las <em><strong>fluctuaciones mensuales en las emisiones de CO2</strong></em> o en las <em><strong>ventas de productos estacionales como los regalos navideños</strong></em> evidencian esta estacionalidad.</p></li>
<li><p>Una técnica práctica para <em><strong>determinar la estacionalidad</strong></em> es el análisis exploratorio de datos mediante los siguientes gráficos:</p>
<ul>
<li><p><em><strong>Gráfico de secuencia de series</strong></em></p></li>
<li><p><em><strong>Gráfico de subseries estacionales</strong></em></p></li>
<li><p><em><strong>Gráficos de cajas múltiples</strong></em></p></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="grafico-de-secuencia-de-series">
<h2><span class="section-number">1.8. </span>Gráfico de secuencia de series<a class="headerlink" href="#grafico-de-secuencia-de-series" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Un simple <em><strong>gráfico de secuencia de ejecución de la serie temporal original</strong></em> con el tiempo en el eje <span class="math notranslate nohighlight">\(x\)</span> y la variable en el eje <span class="math notranslate nohighlight">\(y\)</span> sirve para indicar las siguientes propiedades de la serie temporal:</p>
<ul>
<li><p><em><strong>Movimientos en la media de la serie</strong></em></p></li>
<li><p><em><strong>Cambios en la varianza</strong></em></p></li>
<li><p><em><strong>Presencia de valores atípicos</strong></em></p></li>
</ul>
</li>
</ul>
<ul>
<li><p>Por ejemplo, el gráfico de la <em><strong>secuencia de ejecución de una serie temporal</strong></em> hipotética que se obtiene a partir de la formulación matemática</p>
<div class="math notranslate nohighlight">
\[
    y_{t} = (At + B)\sin(t) + \varepsilon(t)
    \]</div>
<p>con una <em><strong>media dependiente del tiempo</strong></em> y <em><strong>error</strong></em> <span class="math notranslate nohighlight">\(\varepsilon(t)\)</span> <em><strong>que varía como una distribución normal</strong></em> <span class="math notranslate nohighlight">\(N(0, At + b)\)</span>.</p>
</li>
<li><p>En casos como este, un <em><strong>gráfico de secuencia de ejecución</strong></em> es una forma eficaz de <em><strong>identificar el desplazamiento de la media y la varianza de la serie, así como los valores atípicos</strong></em>. El <em><strong>gráfico de la serie temporal sin tendencia es un ejemplo de gráfico de secuencia</strong></em>.</p></li>
</ul>
</section>
<section id="grafico-de-subserie-estacional">
<h2><span class="section-number">1.9. </span>Gráfico de subserie estacional<a class="headerlink" href="#grafico-de-subserie-estacional" title="Link to this heading">#</a></h2>
<div class="admonition-subseries-estacionales admonition">
<p class="admonition-title">Subseries estacionales</p>
<ul class="simple">
<li><p>Para una <em><strong>periodicidad conocida de variaciones estacionales</strong></em>, las <em><strong>subseries estacionales vuelven a dibujar la serie original en lotes de períodos sucesivos</strong></em>. Por ejemplo, la periodicidad de las concentraciones de CO2 es de <em><strong>12 meses</strong></em> y, basándose en ella, se traza una <em><strong>subserie estacional de la media y la desviación estándar de los residuos</strong></em>.</p></li>
<li><p><em><strong>Para visualizar estacionalidad en los residuos, creamos medias y desviaciones estándar trimestrales</strong></em>. Una subserie estacional revela dos propiedades:</p>
<ul>
<li><p><em><strong>Variaciones dentro de las estaciones</strong></em> como dentro de un lote de meses sucesivos.</p></li>
<li><p><em><strong>Variaciones entre las estaciones</strong></em> como entre lotes de meses sucesivos</p></li>
</ul>
</li>
</ul>
</div>
<ul class="simple">
<li><p>En primer lugar, tenemos que <em><strong>añadir los residuos y las etiquetas trimestrales al DataFrame de concentraciones de CO2</strong></em> de la siguiente forma</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CO2</th>
      <th>Year</th>
      <th>Month</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1974-05-01</th>
      <td>333.13</td>
      <td>1974</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1974-06-01</th>
      <td>332.09</td>
      <td>1974</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1974-07-01</th>
      <td>331.10</td>
      <td>1974</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1974-08-01</th>
      <td>329.14</td>
      <td>1974</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1974-09-01</th>
      <td>327.36</td>
      <td>1974</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Residuals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">residuals</span>
<span class="n">month_quarter_map</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;Q1&#39;</span><span class="p">,</span>
                     <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;Q2&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;Q2&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;Q2&#39;</span><span class="p">,</span>
                     <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;Q3&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="s1">&#39;Q3&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="s1">&#39;Q3&#39;</span><span class="p">,</span>
                     <span class="mi">10</span><span class="p">:</span> <span class="s1">&#39;Q4&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="s1">&#39;Q4&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="s1">&#39;Q4&#39;</span><span class="p">}</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Quarter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">month_quarter_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>A continuación, <em><strong>se calculan la media estacional y las desviaciones típicas, agrupando los datos por</strong></em> <code class="docutils literal notranslate"><span class="pre">Year</span></code> <em><strong>y</strong></em> <code class="docutils literal notranslate"><span class="pre">Quarter</span></code>. Esto crea el nuevo <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> como <code class="docutils literal notranslate"><span class="pre">seasonal_sub_series_data</span></code>, que tiene la media trimestral y las desviaciones estándar a lo largo de los años. Estas columnas se renombran como sigue:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seasonal_sub_series_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Quarter&#39;</span><span class="p">])[</span><span class="s1">&#39;Residuals&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">])</span>
<span class="n">seasonal_sub_series_data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Quarterly Mean&#39;</span><span class="p">,</span> <span class="s1">&#39;Quarterly Standard Deviation&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Creamos índices de filas de <code class="docutils literal notranslate"><span class="pre">seasonal_sub_series_data</span></code> utilizando <code class="docutils literal notranslate"><span class="pre">Year</span> <span class="pre">&amp;</span> <span class="pre">Quarter</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seasonal_sub_series_data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">seasonal_sub_series_data</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">seasonal_sub_series_data</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">seasonal_sub_series_data</span><span class="p">[</span><span class="s1">&#39;Quarter&#39;</span><span class="p">]</span>
<span class="n">seasonal_sub_series_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Quarter</th>
      <th>Quarterly Mean</th>
      <th>Quarterly Standard Deviation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1974-Q2</th>
      <td>1974</td>
      <td>Q2</td>
      <td>3.096398</td>
      <td>0.820946</td>
    </tr>
    <tr>
      <th>1974-Q3</th>
      <td>1974</td>
      <td>Q3</td>
      <td>-0.616085</td>
      <td>1.991671</td>
    </tr>
    <tr>
      <th>1974-Q4</th>
      <td>1974</td>
      <td>Q4</td>
      <td>-1.822397</td>
      <td>1.014952</td>
    </tr>
    <tr>
      <th>1975-Q1</th>
      <td>1975</td>
      <td>Q1</td>
      <td>0.754624</td>
      <td>0.511890</td>
    </tr>
    <tr>
      <th>1975-Q2</th>
      <td>1975</td>
      <td>Q2</td>
      <td>2.604978</td>
      <td>0.355093</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">seasonal_sub_series_data</span><span class="p">[</span><span class="s1">&#39;Quarterly Mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Quarterly Mean of Residuals&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;CO2 concentratition&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a2aee8ec990fc2327b96f0eefe0a9d68f9504ecac9af8be209ff33daaa4c466c.png" src="_images/a2aee8ec990fc2327b96f0eefe0a9d68f9504ecac9af8be209ff33daaa4c466c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">seasonal_sub_series_data</span><span class="p">[</span><span class="s1">&#39;Quarterly Standard Deviation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Quarterly Quarterly Standard Deviation of Residuals&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;CO2 concentratition&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/eb2d3905991a8f1fc25126bc5d0c2a6bf652137d4dd76885f44cc649cb8310a9.png" src="_images/eb2d3905991a8f1fc25126bc5d0c2a6bf652137d4dd76885f44cc649cb8310a9.png" />
</div>
</div>
</section>
<section id="graficos-de-cajas-multiples">
<h2><span class="section-number">1.10. </span>Gráficos de cajas múltiples<a class="headerlink" href="#graficos-de-cajas-multiples" title="Link to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title">Boxplot</p>
<ul class="simple">
<li><p>El gráfico de la subserie estacional puede ser más informativo si se redibuja con <em><strong>gráficos de caja estacionales</strong></em> como se muestra en la siguiente figura.</p></li>
<li><p>Un gráfico de cajas muestra tanto la <em><strong>tendencia central</strong></em> como la <em><strong>dispersión de los datos</strong></em> estacionales en un lote de unidades temporales. Además, la <em><strong>separación entre dos gráficos de caja adyacentes revela las variaciones dentro de la temporada</strong></em></p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1974</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Residuals&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Quarter&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Quarterly Boxplots of Residuals&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;CO2 concentratition&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/018c1074fca19ea80b93487906fa0b299b61d8a90164198dd9b7cf1c73d3b648.png" src="_images/018c1074fca19ea80b93487906fa0b299b61d8a90164198dd9b7cf1c73d3b648.png" />
</div>
</div>
</section>
<section id="cambios-ciclicos">
<h2><span class="section-number">1.11. </span>Cambios cíclicos<a class="headerlink" href="#cambios-ciclicos" title="Link to this heading">#</a></h2>
<div class="admonition-cambios-ciclicos admonition">
<p class="admonition-title">Cambios cíclicos</p>
<ul class="simple">
<li><p>Los cambios cíclicos son <em><strong>movimientos que se observan cada pocas unidades de tiempo</strong></em>, menos frecuentes que las fluctuaciones estacionales, <em><strong>pueden no tener un período fijo</strong></em> y suelen <em><strong>ocurrir cada pocos años</strong></em>. Se necesitan <em><strong>datos a largo plazo para identificarlos</strong></em>, como los ciclos económicos recurrentes.</p></li>
</ul>
</div>
<ul class="simple">
<li><p>La inflación del <em><strong>CPI en India y Estados Unidos</strong></em> (<a class="reference external" href="https://en.wikipedia.org/wiki/Consumer_price_index">consumer price index (CPI)</a>) muestra patrones cíclicos cada 2-2.5 años. Los datos se obtuvieron de <code class="docutils literal notranslate"><span class="pre">datamarket</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inflation</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;/home/lihkir/Data/inflation-consumer-prices-annual.xlsx&#39;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inflation</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>India</th>
      <th>United States</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1960-01-01</td>
      <td>1.783265</td>
      <td>1.509929</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1961-01-01</td>
      <td>1.752022</td>
      <td>1.075182</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1962-01-01</td>
      <td>3.576159</td>
      <td>1.116071</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1963-01-01</td>
      <td>2.941176</td>
      <td>1.214128</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1964-01-01</td>
      <td>13.354037</td>
      <td>1.308615</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1960</span><span class="p">,</span><span class="mi">2017</span><span class="p">),</span> <span class="n">inflation</span><span class="p">[</span><span class="s1">&#39;India&#39;</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1960</span><span class="p">,</span><span class="mi">2017</span><span class="p">),</span> <span class="n">inflation</span><span class="p">[</span><span class="s1">&#39;United States&#39;</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;India&#39;</span><span class="p">,</span><span class="s1">&#39;United States&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Inflation in Consumer Price Index&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Inflation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Years&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0fa6d423afec2850b6e8238e0936d0f4c19cd20d38036cddafb60224d511fb5e.png" src="_images/0fa6d423afec2850b6e8238e0936d0f4c19cd20d38036cddafb60224d511fb5e.png" />
</div>
</div>
<ul class="simple">
<li><p>La <em><strong>alta inflación en Estados Unidos e India entre 1970 y 1980</strong></em> se debió principalmente a los <em><strong>aumentos en los precios del petróleo</strong></em> a nivel mundial, <em><strong>políticas económicas expansivas</strong></em> y <em><strong>presión sobre los precios por aumento de la demanda</strong></em> debido al rápido crecimiento económico.</p></li>
</ul>
</section>
<section id="componentes-irregulares">
<h2><span class="section-number">1.12. </span>Componentes irregulares<a class="headerlink" href="#componentes-irregulares" title="Link to this heading">#</a></h2>
<div class="admonition-variaciones-irregulares admonition">
<p class="admonition-title">Variaciones irregulares</p>
<ul class="simple">
<li><p>A pesar de que nuestro modelo que <em><strong>incluye cuatro componentes para expresar una serie temporal</strong></em>, aún puede haber un <em><strong>componente irregular</strong></em>. Este componente es un <em><strong>error irreducible que es aleatorio y no muestra una relación sistemática con el tiempo</strong></em>.</p></li>
<li><p>Refleja <em><strong>variaciones inesperadas en la serie temporal que son estocásticas</strong></em> y no pueden predecirse definitivamente con un modelo matemático, debido a la falta de información sobre variables explicativas o la presencia de ruido aleatorio.</p></li>
</ul>
</div>
</section>
<section id="modelos-de-analisis-de-series-temporales">
<h2><span class="section-number">1.13. </span>Modelos de análisis de series temporales<a class="headerlink" href="#modelos-de-analisis-de-series-temporales" title="Link to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title">Introducción</p>
<ul class="simple">
<li><p>El objetivo del análisis de series temporales es <em><strong>desarrollar un modelo matemático que pueda explicar el comportamiento observado de una serie temporal y, posiblemente, predecir su estado futuro</strong></em>.</p></li>
<li><p>El modelo elegido debe ser capaz de dar cuenta de una o más de las estructuras internas que pueden estar presentes. Con este fin, daremos una <em><strong>visión general</strong></em> de los siguientes modelos que se utilizan a menudo como <em><strong>componentes básicos del análisis de series temporales</strong></em>:</p>
<ul>
<li><p><em><strong>Modelos de media cero</strong></em></p></li>
<li><p><em><strong>Recorrido aleatorio</strong></em></p></li>
<li><p><em><strong>Modelos de tendencia</strong></em></p></li>
<li><p><em><strong>Modelos de estacionalidad</strong></em></p></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="modelos-de-media-cero">
<h2><span class="section-number">1.14. </span>Modelos de media cero<a class="headerlink" href="#modelos-de-media-cero" title="Link to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title">Definición</p>
<ul class="simple">
<li><p>Los <em><strong>modelos de media cero tienen una media y una varianza constantes y no muestran tendencias predecibles ni estacionalidad</strong></em>. Se supone que las observaciones de un modelo de media cero son <em><strong>independientes e idénticamente distribuidas (iid)</strong></em> y representan el <em><strong>ruido aleatorio en torno a una media fija</strong></em>, que se ha deducido de la serie temporal como un término constante.</p></li>
</ul>
</div>
<ul class="simple">
<li><p>Consideremos que <span class="math notranslate nohighlight">\(Y_{1}, Y_{2},\dots, Y_{T}\)</span> representan las <em><strong>variables aleatorias correspondientes a</strong></em> <span class="math notranslate nohighlight">\(T\)</span> <em><strong>observaciones</strong></em> de un modelo de media cero. Si <span class="math notranslate nohighlight">\(y_{1}, y_{2},\dots, y_{T}\)</span> son <span class="math notranslate nohighlight">\(t\)</span> observaciones de la serie temporal de media cero, la <em><strong>distribución conjunta de las observaciones</strong></em> viene dada por el producto de las funciones de masa de probabilidad para cada índice temporal</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
P(Y_{1}=y_{1}, Y_{2}=y_{2}, \dots, Y_{T}=y_{T})=f(Y_{1}=y_{1})f(Y_{2}=y_{2})\cdots f(Y_{T}=y_{T}) 
\]</div>
<ul class="simple">
<li><p>Lo más habitual es <em><strong>modelar</strong></em> <span class="math notranslate nohighlight">\(f(Y_{t} = y_{t})\)</span> <em><strong>mediante una distribución normal de media cero y varianza</strong></em> <span class="math notranslate nohighlight">\(\sigma^2\)</span>, que se supone que es el <em><strong>error irreducible del modelo y, por tanto, se trata como un ruido aleatorio</strong></em>. La siguiente figura muestra una serie de ruido aleatorio con media cero y distribución normal de varianza unitaria</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">zero_mean_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">zero_mean_series</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Zero mean model&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time index&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f5173faa6468f5f8311983ac904301251014883f07e65e2bccd638b301083f10.png" src="_images/f5173faa6468f5f8311983ac904301251014883f07e65e2bccd638b301083f10.png" />
</div>
</div>
<ul>
<li><p><em><strong>La media cero con varianza constante representa un ruido aleatorio</strong></em> que puede asumir infinitos posibles valores reales y es adecuado para <em><strong>representar variaciones irregulares en la serie temporal de una variable continua</strong></em>.</p></li>
<li><p>Sin embargo, en muchos casos, el estado observable del sistema o proceso puede ser de <em><strong>naturaleza discreta y limitarse a un número finito de valores posibles</strong></em> <span class="math notranslate nohighlight">\(s_{1}, s_{2}, \dots, s_{m}\)</span>. En tales casos, se supone que la <em><strong>variable observada</strong></em> <span class="math notranslate nohighlight">\(X\)</span> <em><strong>obedece a la</strong></em> <a class="reference external" href="https://es.wikipedia.org/wiki/Distribuci%C3%B3n_multinomial">distribución multinomial</a>,</p>
<div class="math notranslate nohighlight">
\[
  P(X = s_{1}) = p_{1}, P(X = s_{2}) = p_{2}, \dots, P(X = s_{m}) = p_{m}~\text{tal que}~p_{1} + p_{2} + \cdots + p_{m} = 1.
  \]</div>
<p>Una serie temporal de este tipo es un <em><strong>proceso estocástico discreto</strong></em>.</p>
</li>
<li><p>El <em><strong>lanzamiento múltiple de un dado a lo largo del tiempo es un ejemplo de proceso estocástico discreto</strong></em> con seis resultados posibles para cada lanzamiento. Un proceso estocástico discreto más sencillo es un proceso binario como lanzar una moneda con solo dos resultados: cara y sello.</p></li>
</ul>
</section>
<section id="camino-aleatorio">
<h2><span class="section-number">1.15. </span>Camino aleatorio<a class="headerlink" href="#camino-aleatorio" title="Link to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title">Definición</p>
<ul>
<li><p>Un paseo aleatorio viene dado como una <em><strong>suma de</strong></em> <span class="math notranslate nohighlight">\(n\)</span> <em><strong>iids, que tiene media cero y varianza constante</strong></em>. A partir de esta definición, la <em><strong>realización de un paseo aleatorio en el índice de tiempo</strong></em> <span class="math notranslate nohighlight">\(t\)</span> viene dada por la suma</p>
<div class="math notranslate nohighlight">
\[
  S = y_{1} + y_{2} + \cdots + y_{T}.
  \]</div>
</li>
</ul>
</div>
<ul>
<li><p>La siguiente figura muestra el paseo aleatorio obtenido a partir de las <em>iids</em>, que varían según una <em><strong>distribución normal de media cero y varianza unitaria</strong></em>.</p></li>
<li><p>El paseo aleatorio es importante porque si se encuentra un comportamiento de este tipo en una serie temporal, <em><strong>se puede fácilmente reducir a un modelo de media cero tomando las diferencias de las observaciones de dos índices temporales consecutivos como</strong></em></p>
<div class="math notranslate nohighlight">
\[
  S_{t}-S_{t-1} = y_{t}
  \]</div>
<p>obteniendo así una <em><strong>serie iid con media cero y varianza constante</strong></em>.</p>
</li>
<li><p>El paseo aleatorio puede generarse tomando la <em><strong>suma acumulada del modelo de media cero discutido en la sección anterior</strong></em>. El siguiente código lo implementa</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">random_walk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">zero_mean_series</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">random_walk</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Random Walk&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time index&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/72f457fa3d0c8e32880eabceb49c553a6754b2dbcb1b5df186772131ceaa6cf8.png" src="_images/72f457fa3d0c8e32880eabceb49c553a6754b2dbcb1b5df186772131ceaa6cf8.png" />
</div>
</div>
</section>
<section id="modelos-de-tendencia">
<h2><span class="section-number">1.16. </span>Modelos de tendencia<a class="headerlink" href="#modelos-de-tendencia" title="Link to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title">Introducción</p>
<ul>
<li><p>Este tipo de modelo pretende <em><strong>captar la tendencia a largo plazo de la serie temporal que puede ajustarse como regresión lineal del índice temporal</strong></em>. Cuando la serie temporal no presenta fluctuaciones periódicas o estacionales, puede expresarse simplemente como la suma de la tendencia y la media nula como</p>
<div class="math notranslate nohighlight">
\[
  y_{t} = \mu(t) + \varepsilon_{t}
  \]</div>
<p>donde <span class="math notranslate nohighlight">\(\mu(t)\)</span> es la <em><strong>tendencia a largo plazo</strong></em> dependiente del tiempo de la serie.</p>
</li>
<li><p>La elección del modelo de tendencia <span class="math notranslate nohighlight">\(\mu(t)\)</span> es fundamental para <em><strong>captar correctamente el comportamiento de la serie temporal</strong></em>. El análisis exploratorio de datos suele proporcionar pistas para plantear la hipótesis de si el modelo debería ser lineal o no lineal en <span class="math notranslate nohighlight">\(t\)</span>.</p></li>
<li><p>Un <em><strong>modelo lineal es simplemente</strong></em> <span class="math notranslate nohighlight">\(\mu(t) = wt + b\)</span>, mientras que un <em><strong>modelo cuadrático es</strong></em> <span class="math notranslate nohighlight">\(\mu(t) = w_{1}t + w_{2}t^{2} + b\)</span>. A veces, la tendencia se puede hipotetizar mediante una relación compleja en términos del índice temporal, como <span class="math notranslate nohighlight">\(\mu(t) = w_{0}t^{p} + b\)</span> o <span class="math notranslate nohighlight">\(\mu(t)=w_{0}e^{w_{1}t}\)</span>.</p></li>
</ul>
</div>
<ul class="simple">
<li><p>Los pesos y sesgos en los modos de tendencia como los discutidos anteriormente se obtienen ejecutando una <em><strong>regresión con</strong></em> <span class="math notranslate nohighlight">\(t\)</span> <em><strong>como variable explicativa y</strong></em> <span class="math notranslate nohighlight">\(\mu(t)\)</span> <em><strong>como respuesta</strong></em>. Los <em><strong>residuos</strong></em> <span class="math notranslate nohighlight">\(y_{t} - \mu(t)\)</span> del modelo de tendencia es considerado el <em><strong>ruido irreducible</strong></em> y como realización del componente de media cero <span class="math notranslate nohighlight">\(\varepsilon_{t}\)</span>.</p></li>
</ul>
</section>
<section id="modelos-de-estacionalidad">
<h2><span class="section-number">1.17. </span>Modelos de estacionalidad<a class="headerlink" href="#modelos-de-estacionalidad" title="Link to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title">Definición</p>
<ul>
<li><p>La estacionalidad se manifiesta como <em><strong>fluctuaciones periódicas y repetitivas en una serie temporal</strong></em> y, por tanto, se <em><strong>modelan como una suma ponderada de ondas senoidales de periodicidad conocida</strong></em>.</p></li>
<li><p>Suponiendo que la tendencia a largo plazo se ha eliminado mediante una línea de tendencia, el <em><strong>modelo de estacionalidad puede expresarse como</strong></em> <span class="math notranslate nohighlight">\(y_{t} = s_{t}+ \varepsilon_{t}\)</span>, donde la variación estacional es</p>
<div class="math notranslate nohighlight">
\[
    s_{t}=\sum_{k=1}^{L}(w_{k}\cos(\alpha t)+v_{k}\sin(\alpha t))+b,
    \]</div>
<p>con periocidad <span class="math notranslate nohighlight">\(\alpha\)</span>.</p>
</li>
</ul>
</div>
<ul class="simple">
<li><p>Los modelos de estacionalidad también se conocen como <strong><strong>modelos de regresión armónica</strong></strong>, ya que intentan ajustar la suma de múltiples ondas senoidales. <em><strong>Los cuatro modelos descritos aquí son los componentes básicos de un modelo de series temporales completo</strong></em>.</p></li>
</ul>
<div class="admonition-observacion admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>Como ya se habrá dado cuenta, un modelo de suma cero representa el error irreducible del sistema y los otros tres modelos pretenden transformar una serie temporal dada en modelos de suma cero mediante transformaciones matemáticas adecuadas. <em><strong>Para obtener previsiones en series temporales originales, se aplican las transformaciones inversas pertinentes</strong></em>.</p></li>
</ul>
</div>
<ul class="simple">
<li><p><em><strong>En las próximas secciones se detallarán los cuatro modelos aquí analizados</strong></em>. Sin embargo, hemos llegado a un punto en el que podemos resumir el enfoque genérico de un análisis de series temporales en los siguientes cuatro pasos:</p>
<ul>
<li><p><em><strong>Visualizar los datos en distintas etapas del índice temporal</strong></em> para revelar las tendencias a largo plazo y las fluctuaciones estacionales.</p></li>
<li><p><em><strong>Ajustar la línea de tendencia para captar tendencias a largo plazo</strong></em> y trazar los residuos para comprobar si hay estacionalidad o error irreducible</p></li>
<li><p><em><strong>Ajustar de un modelo de regresión armónica para captar la estacionalidad</strong></em></p></li>
<li><p><em><strong>Trazar los residuos</strong></em> dejados por el modelo de estacionalidad para <em><strong>comprobar si hay error irreducible</strong></em>.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>Estos pasos suelen bastar para <em><strong>desarrollar modelos matemáticos para la mayoría de las series temporales</strong></em>. Los modelos individuales de tendencia y estacionalidad pueden ser sencillos o complejos, dependiendo de la serie temporal original y de la aplicación.</p></li>
</ul>
</section>
<section id="autocorrelacion-y-autocorrelacion-parcial">
<h2><span class="section-number">1.18. </span>Autocorrelación y autocorrelación parcial<a class="headerlink" href="#autocorrelacion-y-autocorrelacion-parcial" title="Link to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title">Introducción</p>
<ul class="simple">
<li><p>Tras aplicar las transformaciones matemáticas comentadas en el apartado anterior, a menudo nos encontramos con lo que se conoce como una <em><strong>serie temporal estacionaria</strong></em> (o <em><strong>débilmente estacionaria</strong></em>), que se caracteriza por una <em><strong>media constante</strong></em> <span class="math notranslate nohighlight">\(\text{E}(y_{t})\)</span> y una <em><strong>correlación que solo depende del desfase entre dos pasos temporales, pero independiente del valor del paso temporal</strong></em>, esto es, <em>su distribución de probabilidad es completamente independiente del tiempo</em>.</p></li>
</ul>
</div>
<ul class="simple">
<li><p>Este tipo de covarianza es la clave en el análisis de series temporales y se denomina autocovarianza o autocorrelación, cuando se normaliza en el intervalo de -1 a 1. La <em><strong>autocorrelación refleja el grado de dependencia lineal entre la serie temporal en el índice</strong></em> <span class="math notranslate nohighlight">\(t\)</span> <em><strong>y las series temporales de los índices</strong></em> <span class="math notranslate nohighlight">\(t-k\)</span> o <span class="math notranslate nohighlight">\(t+k\)</span>.</p></li>
<li><p>Una <em><strong>autocorrelación positiva</strong></em> indica que los <em><strong>valores presentes y futuros de la serie temporal se mueven en la misma dirección</strong></em>, mientras que los <em><strong>valores negativos</strong></em> significan que los <em><strong>valores presentes y futuros se mueven en sentido contrario</strong></em>. Si la <em><strong>autocorrelación es cercana a cero</strong></em>, las <em><strong>dependencias temporales dentro de la serie pueden ser difíciles de encontrar</strong></em>. Debido a esta propiedad, la autocorrelación es útil para predecir el estado futuro de una serie temporal a <span class="math notranslate nohighlight">\(h\)</span> pasos por delante.</p></li>
</ul>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<ul class="simple">
<li><p>La <em><strong>covarianza</strong></em> entre <span class="math notranslate nohighlight">\(y_{t}\)</span> y su valor en otro período de tiempo, digamos, <span class="math notranslate nohighlight">\(y_{t+k}\)</span> se denomina <em><strong>autocovarianza en el desfase (lag)</strong></em> <span class="math notranslate nohighlight">\(k\)</span> y se define como</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\gamma_{k}=\textsf{Cov}(y_{t}, y_{t+k})=\textsf{E}[(y_{t}-\mu)(y_{t+k}-\mu)].
\]</div>
<ul class="simple">
<li><p>La colección de los valores de <span class="math notranslate nohighlight">\(\gamma_{k}, k = 0, 1, 2,\dots\)</span> se denomina <em><strong>función de autocovarianza</strong></em>. Tenga en cuenta que la autocovarianza en el lag <span class="math notranslate nohighlight">\(k = 0\)</span> es solo la <em><strong>varianza</strong></em> de la serie temporal; es decir, <span class="math notranslate nohighlight">\(\gamma_{0}=\sigma_{y}^{2}\)</span>, que es <em><strong>constante para una serie de tiempo estacionaria</strong></em>.</p></li>
<li><p>El <em><strong>coeficiente de autocorrelación</strong></em> en el lag <span class="math notranslate nohighlight">\(k\)</span> para una serie temporal estacionaria es</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\rho_{k}=\frac{\textsf{E}[(y_{t}-\mu)(y_{t+k}-\mu)]}{\sqrt{\textsf{E}[(y_{t}-\mu)^2]\textsf{E}[(y_{t+k}-\mu)^{2}]}}=\frac{\textsf{Cov}(y_{t}, y_{t+k})}{\textsf{Var}(y_{t})}=\frac{\gamma_{k}}{\gamma_{0}}.
\]</div>
<ul>
<li><p>El conjunto de los valores de <span class="math notranslate nohighlight">\(\rho_{k}, k = 0, 1, 2, \dots\)</span> se denomina <em><strong>función de autocorrelación (ACF)</strong></em>. Obsérvese que, por definición, <span class="math notranslate nohighlight">\(\rho_{0} = 1\)</span>. Además, la <em><strong>ACF</strong></em> es independiente de la escala de medición de la serie temporal, por lo que <em><strong>es una cantidad adimensional</strong></em>. Adicionalmente, <span class="math notranslate nohighlight">\(\rho_{k} = \rho_{-k}\)</span><em><strong>; es decir, la ACF es simétrica en torno a cero</strong></em>, por lo que solo es necesario calcular la mitad positiva (o negativa).</p></li>
<li><p>Es necesario estimar la <em><strong>autocovarianza</strong></em> y los <em><strong>ACF</strong></em> a partir de una serie temporal de longitud finita, digamos, <span class="math notranslate nohighlight">\(y_{1}, y_{2}, \dots, y_{T}\)</span>. La estimación habitual de la función de autocovarianza es</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \\[1mm]
    c_{k}=\hat{\gamma}_{k}=\frac{1}{T}\sum_{t=1}^{T-k}(y_{t}-\overline{y})(y_{t+k}-\overline{y}),\quad k=1,2,\dots,K,
    \end{split}\]</div>
<p>y la <em><strong>ACF</strong></em> es estimada por la <em><strong>función de autocorrelación muestral</strong></em> (o <em><strong>ACF muestral</strong></em>)</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \\[1mm]
    r_{k}=\hat{\rho}_{k}=\frac{c_{k}}{c_{0}},\quad k=0,1,2,\dots,K.
    \end{split}\]</div>
</li>
</ul>
</div>
<ul class="simple">
<li><p>El siguiente <em><strong>tutorial</strong></em> puede ser de utilidad para quienes gozan usar <em><strong><code class="docutils literal notranslate"><span class="pre">Excel</span></code></strong></em>. En esta oportunidad puede ser usado como <em><strong>calculadora para obtener de forma manual la función ACF</strong></em> (ver <a class="reference external" href="https://www.youtube.com/watch?v=H3iHEJkh3A8&amp;amp;ab_channel=Sangwoo.StatisticsKim">How to calculate ACF by 2 ways in Excel</a>)</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul>
<li><p>Una buena regla general es que <em><strong>se necesitan al menos 50 observaciones</strong></em> para obtener una estimación fiable de la <em><strong>ACF</strong></em>, y las <em><strong>autocorrelaciones de las muestras</strong></em> individuales <em><strong>deben calcularse hasta el retardo</strong></em> <span class="math notranslate nohighlight">\(K\)</span>, donde <span class="math notranslate nohighlight">\(K\)</span> <em><strong>es aproximadamente</strong></em> <span class="math notranslate nohighlight">\(T/4\)</span>.</p></li>
<li><p>A menudo tendremos que <em><strong>determinar si el coeficiente de autocorrelación en un determinado retardo es cero</strong></em>. Esto puede hacerse comparando el coeficiente de autocorrelación de la muestra en el retardo <span class="math notranslate nohighlight">\(k, r_{k}\)</span>, con su error estándar.</p></li>
<li><p>Sí, suponemos que las observaciones no están correlacionadas, es decir, <span class="math notranslate nohighlight">\(\rho_{k} = 0\)</span> para todo <span class="math notranslate nohighlight">\(k\)</span>, entonces <em><strong>la varianza del coeficiente de autocorrelación de la muestra</strong></em> es (ver <span id="id1">[<a class="reference internal" href="biblio.html#id3" title="Maurice S Bartlett. On the theoretical specification and sampling properties of autocorrelated time-series. Supplement to the Journal of the Royal Statistical Society, 8(1):27–41, 1946.">Bartlett, 1946</a>]</span>)</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \\[1mm]
    \textsf{Var}(r_{k})\cong\frac{1}{T},
    \end{split}\]</div>
<p>y <em><strong>error estándar</strong></em> es</p>
<div class="math notranslate nohighlight">
\[
    \textsf{se}(r_{k})\cong\frac{1}{\sqrt{T}}.
    \]</div>
</li>
</ul>
</div>
<ul class="simple">
<li><p>Para abordar el cálculo de este error, <em><strong>Bartlett</strong></em> considera el <em><strong>proceso estocástico discreto AR</strong></em> <span class="math notranslate nohighlight">\(y_{t+1}=\phi y_{t}+\varepsilon_{t+1}\)</span>. Para este propósito, utiliza la siguiente expresión para la <em><strong>varianza aproximada del coeficiente de autocorrelación</strong></em> estimado de un proceso normal estacionario dada por</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-error-variance-acf">
<span class="eqno">(1.1)<a class="headerlink" href="#equation-error-variance-acf" title="Link to this equation">#</a></span>\[
\textsf{Var}(r_{k})\cong\frac{1}{T}\sum_{v=-\infty}^{\infty}(\rho_{v}^{2}+\rho_{v+k}\rho_{v-k}-4\rho_{k}\rho_{v}\rho_{v-k}+2\rho_{v}^{2}\rho_{k}^{2}).
\]</div>
<ul class="simple">
<li><p>Por ejemplo, si <span class="math notranslate nohighlight">\(\rho_{k}=\phi^{|k|},~(-1&lt;\phi&lt;1)\)</span>, es decir, la función de <em><strong>autocorrelación se reduce exponencialmente</strong></em>, entonces la Ecuación <a class="reference internal" href="#equation-error-variance-acf">(1.1)</a> se convierte en (<strong><code class="docutils literal notranslate"><span class="pre">verifíquelo</span></code></strong>)</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\textsf{Var}(r_{k})\cong\frac{1}{T}\left(1+2\sum_{v=1}^{q}\rho_{v}^{2}\right),\quad k&gt;q.
\]</div>
<ul class="simple">
<li><p>Bajo el supuesto de que los <span class="math notranslate nohighlight">\(\rho_{k}\)</span> <em><strong>son todos cero más allá de un cierto rezago</strong></em> <span class="math notranslate nohighlight">\(k =q\)</span>, el error estándar de gran retardo se aproxima a la desviación estándar de <span class="math notranslate nohighlight">\(r_{k}\)</span> para retardos adecuadamente grandes <span class="math notranslate nohighlight">\((k &gt; q)\)</span>. Entonces los <em><strong>errores estándar para las autocorrelaciones estimadas</strong></em> <span class="math notranslate nohighlight">\(r_{k}\)</span> adoptan la forma simple (<em><strong><code class="docutils literal notranslate"><span class="pre">bonus</span></code></strong></em>)</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\textsf{se}(r_{k})\approx\frac{1}{\sqrt{T}}.
\]</div>
</section>
<section id="experimentos-numericos-acf">
<h2><span class="section-number">1.19. </span>Experimentos numéricos ACF<a class="headerlink" href="#experimentos-numericos-acf" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>La presencia de autocorrelación puede identificarse <em><strong>trazando los valores observados de la función de autocorrelación (ACF) de una serie temporal determinada</strong></em>. Este gráfico suele denominarse <code class="docutils literal notranslate"><span class="pre">ACF</span></code>. Ilustremos cómo el trazado de los valores observados de la <code class="docutils literal notranslate"><span class="pre">ACF</span></code> puede ayudar a <em><strong>detectar la presencia de autocorrelación</strong></em>.</p></li>
<li><p>Para ello, trazaremos primero el valor diario del <a class="reference external" href="https://en.wikipedia.org/wiki/Dow_Jones_Industrial_Average">Dow Jones Industrial Average (DJIA)</a> <em><strong>observado durante enero de 2016 a diciembre de 2016</strong></em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">statsmodels.graphics.tsaplots</span> <span class="kn">import</span> <span class="n">plot_acf</span><span class="p">,</span> <span class="n">plot_pacf</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">djia_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;/home/lihkir/Data/DJIA_Jan2016_Dec2016.xlsx&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">djia_df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span>
<span class="n">djia_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-01-04</th>
      <td>2016-01-04</td>
      <td>17405.480469</td>
      <td>17405.480469</td>
      <td>16957.630859</td>
      <td>17148.939453</td>
      <td>17148.939453</td>
      <td>148060000</td>
    </tr>
    <tr>
      <th>2016-01-05</th>
      <td>2016-01-05</td>
      <td>17147.500000</td>
      <td>17195.839844</td>
      <td>17038.609375</td>
      <td>17158.660156</td>
      <td>17158.660156</td>
      <td>105750000</td>
    </tr>
    <tr>
      <th>2016-01-06</th>
      <td>2016-01-06</td>
      <td>17154.830078</td>
      <td>17154.830078</td>
      <td>16817.619141</td>
      <td>16906.509766</td>
      <td>16906.509766</td>
      <td>120250000</td>
    </tr>
    <tr>
      <th>2016-01-07</th>
      <td>2016-01-07</td>
      <td>16888.359375</td>
      <td>16888.359375</td>
      <td>16463.630859</td>
      <td>16514.099609</td>
      <td>16514.099609</td>
      <td>176240000</td>
    </tr>
    <tr>
      <th>2016-01-08</th>
      <td>2016-01-08</td>
      <td>16519.169922</td>
      <td>16651.890625</td>
      <td>16314.570313</td>
      <td>16346.450195</td>
      <td>16346.450195</td>
      <td>141850000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Dow Jones Industrial Average between Jan 2016 - Dec 2016&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Closing Value&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/60f70e19e0b596887c1ed06f48df54c22c0ebe23271a4c7d6a802fe516a9dfde.png" src="_images/60f70e19e0b596887c1ed06f48df54c22c0ebe23271a4c7d6a802fe516a9dfde.png" />
</div>
</div>
<ul class="simple">
<li><p>De la figura anterior se desprende que <em><strong>cuando el DJIA empieza a subir, continúa haciéndolo durante algún tiempo y viceversa</strong></em>. Sin embargo, debemos <em><strong>comprobarlo mediante un gráfico ACF</strong></em>.</p></li>
<li><p>A continuación, se <em><strong>estima la ACF calculando la autocorrelación para diferentes valores del retardo</strong></em> <span class="math notranslate nohighlight">\(h\)</span>, que <em>en este caso varía de 0 a 30</em>. La función <code class="docutils literal notranslate"><span class="pre">Pandas.Series.autocorr</span></code> <em><strong>se utiliza para calcular la autocorrelación</strong></em> para diferentes valores del retardo</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lag</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">31</span><span class="p">)</span>
<span class="n">djia_acf</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lag</span><span class="p">:</span>
    <span class="n">djia_acf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">autocorr</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>El código anterior, itera sobre una <em><strong>lista de 31 valores de lag, empezando de 0 a 30</strong></em>. Un <em><strong>rezago de 0</strong></em> índica autocorrelación de una observación consigo misma (<span class="math notranslate nohighlight">\(\text{Cov}(y_{t}, y_{t})/\text{Var}(y_{t})\)</span>) y, por lo tanto, <em><strong>se espera que sea 1.0</strong></em>, como también se confirma en la figura siguiente.</p></li>
<li><p>Autocorrelación en <code class="docutils literal notranslate"><span class="pre">DJIA</span> <span class="pre">Close</span></code> <em><strong>parece disminuir linealmente con el retardo, con un cambio aparente en la tasa de caída en torno a los 18 días</strong></em>. Con un desfase de 30 días, la ACF es ligeramente superior a 0.65.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">djia_acf</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Autocorrelation function for DJIA&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lag in terms of number of trading days&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Autocorrelation function&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/162c750bf9018f971754690c7ecc0de3958d836958c03da6383780202f7db9ba.png" src="_images/162c750bf9018f971754690c7ecc0de3958d836958c03da6383780202f7db9ba.png" />
</div>
</div>
<ul class="simple">
<li><p>El gráfico ACF muestra que la autocorrelación, en el caso de los valores de cierre del <em>DJIA</em>, tienen una <em><strong>dependencia funcional del desfase temporal entre las observaciones</strong></em>. Hemos escrito un bucle for para calcular la autocorrelación en distintos retardos y hemos representado los resultados mediante la función <code class="docutils literal notranslate"><span class="pre">sns.pointplot</span></code>. También se puede utilizar la función <code class="docutils literal notranslate"><span class="pre">plot_acf</span></code> de <code class="docutils literal notranslate"><span class="pre">statsmodels.graphics.tsaplots</span></code> <em><strong>para calcular y trazar la autocorrelación en varios rezagos</strong></em>.</p></li>
<li><p>Además, esta función también traza los intervalos de confianza del 95%. <em><strong>La autocorrelación fuera de estos intervalos de confianza es una correlación estadísticamente significativa, mientras que las que están dentro de los intervalos de confianza se deben a ruido aleatorio</strong></em>. La autocorrelación y los intervalos de confianza generados por <code class="docutils literal notranslate"><span class="pre">plot_acf</span></code> se muestran en la figura siguiente:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">));</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">31</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 550x550 with 0 Axes&gt;
</pre></div>
</div>
<img alt="_images/57fde407f71afe8cb40488377ce27da8a3ecbbd4fa08f8e19efaa3c8c7c89990.png" src="_images/57fde407f71afe8cb40488377ce27da8a3ecbbd4fa08f8e19efaa3c8c7c89990.png" />
</div>
</div>
<ul class="simple">
<li><p>Hasta ahora hemos hablado de la <em><strong>autocorrelación, que es una medida de la dependencia lineal entre las variables</strong></em> <span class="math notranslate nohighlight">\(y_{t}\)</span> y <span class="math notranslate nohighlight">\(y_{t+k}\)</span>. Los <em><strong>modelos autorregresivos (AR) captan esta dependencia como una regresión lineal entre</strong></em> <span class="math notranslate nohighlight">\(y_{t+k}\)</span> y <span class="math notranslate nohighlight">\(y_{t}\)</span>. Sin embargo, las series temporales tienden a llevar información y estructuras de dependencia por etapas, por lo que <em><strong>la autocorrelación en el rezago</strong></em> <span class="math notranslate nohighlight">\(k\)</span> <em><strong>también se ve influida por las variables intermedias</strong></em> <span class="math notranslate nohighlight">\(y_t, y_{t+1}, \dots, y_{t+k-1}\)</span>. Por lo tanto, la autocorrelación no es la medida correcta de la correlación mutua entre <span class="math notranslate nohighlight">\(y_{t}\)</span> y <span class="math notranslate nohighlight">\(y_{t+k}\)</span> en presencia de las variables intermedias.</p></li>
<li><p>Sería <em><strong>erróneo elegir</strong></em> <span class="math notranslate nohighlight">\(k\)</span> <em><strong>en modelos AR basados en autocorrelación</strong></em>. La <em><strong>autocorrelación parcial (PACF) resuelve este problema</strong></em> midiendo la correlación entre <span class="math notranslate nohighlight">\(y_{t}\)</span> y <span class="math notranslate nohighlight">\(y_{t+k}\)</span> cuando se ha eliminado la influencia de las variables intermedias. Por lo tanto, <em><strong>la autocorrelación parcial en el análisis de series temporales define la correlación entre</strong></em> <span class="math notranslate nohighlight">\(y_{t}\)</span> <em><strong>y</strong></em> <span class="math notranslate nohighlight">\(y_{t+k}\)</span> <em><strong>que no tiene en cuenta los retardos</strong></em> <span class="math notranslate nohighlight">\(t+1, \dots, t+k-1\)</span>. La <em><strong>PACF ayuda a identificar el orden</strong></em> <span class="math notranslate nohighlight">\(p\)</span> <em><strong>de un modelo</strong></em> <span class="math notranslate nohighlight">\(AR(p)\)</span>. Veamos la autocorrelación parcial de los valores de cierre del <code class="docutils literal notranslate"><span class="pre">DJIA</span></code> utilizando <code class="docutils literal notranslate"><span class="pre">plot_pacf</span></code> como sigue</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">));</span>
<span class="n">plot_pacf</span><span class="p">(</span><span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">31</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 550x550 with 0 Axes&gt;
</pre></div>
</div>
<img alt="_images/e3a9d8e8c3bfd5fa1550c1cd9317ec22c52747a800de0464281890f7c3718dac.png" src="_images/e3a9d8e8c3bfd5fa1550c1cd9317ec22c52747a800de0464281890f7c3718dac.png" />
</div>
</div>
<ul class="simple">
<li><p>La primera <em><strong>autocorrelación parcial en el retardo cero es siempre 1.0</strong></em>. Como se observa en el gráfico anterior, la <em><strong>autocorrelación parcial solo en el retardo uno es estadísticamente significativa</strong></em>, mientras que para el resto de los rezagos está dentro de los intervalos de confianza del 95%. Por lo tanto, para los valores de cierre del <code class="docutils literal notranslate"><span class="pre">DJIA</span></code> el <em><strong>orden de los modelos</strong></em> <span class="math notranslate nohighlight">\(AR\)</span> <em><strong>es uno</strong></em> (usar <span class="math notranslate nohighlight">\(AR(1)\)</span>).</p></li>
</ul>
</section>
<section id="analisis-de-datos-de-series-temporales">
<h2><span class="section-number">1.20. </span>Análisis de datos de series temporales<a class="headerlink" href="#analisis-de-datos-de-series-temporales" title="Link to this heading">#</a></h2>
<div class="admonition-observacion admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>El <em><strong>análisis de series temporales</strong></em> implica dos pasos clave: <em><strong>visualizar los datos para identificar tendencias y patrones, y ajustar estas tendencias y estacionalidades para crear series estacionarias</strong></em>. Las <em><strong>fluctuaciones irregulares restantes se modelan como observaciones independientes e idénticamente distribuidas (iid) mediante regresión lineal</strong></em> sobre variables exógenas.</p></li>
<li><p>Este enfoque mejora las predicciones futuras. La metodología se presenta en un diagrama de flujo y se cubren los primeros tres pasos, incluyendo <em><strong>procesamiento avanzado de datos, pruebas estadísticas para estacionariedad y descomposición de series temporales</strong></em>. Estos conceptos son fundamentales para desarrollar modelos predictivos de series temporales.</p></li>
</ul>
</div>
<figure class="align-center" id="fig1-chapter1">
<a class="reference internal image-reference" href="_images/fig1_chapter1.png"><img alt="_images/fig1_chapter1.png" src="_images/fig1_chapter1.png" style="width: 320.0px; height: 362.40000000000003px;" /></a>
</figure>
</section>
<section id="procesamiento-avanzado-y-visualizacion-de-datos-de-series-temporales">
<h2><span class="section-number">1.21. </span>Procesamiento avanzado y visualización de datos de series temporales<a class="headerlink" href="#procesamiento-avanzado-y-visualizacion-de-datos-de-series-temporales" title="Link to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title">Introducción</p>
<ul class="simple">
<li><p>Las <em><strong>series temporales suelen transformarse en estadísticos agregados</strong></em> como la <em><strong>media o la mediana para períodos de tiempo más largos</strong></em>. Por ejemplo, en ventas mensuales de automóviles, la estacionalidad mensual se resalta al calcular <em><strong>promedios para cada mes a lo largo de varios años</strong></em>. Esto se logra dividiendo la serie en segmentos mensuales y agregando los datos de cada segmento.</p></li>
<li><p>Para un análisis más detallado, a menudo se utilizan <em><strong>agregados móviles, como medias trimestrales</strong></em>, que <em><strong>se calculan desplazando una ventana de tiempo sobre la serie y calculando estadísticos dentro de esa ventana</strong></em>. Esto se demuestra con ejemplos de <em><strong>remuestreo, agrupación y cálculo de estadísticos móviles</strong></em> utilizando librerías de <code class="docutils literal notranslate"><span class="pre">pandas</span></code>.</p></li>
</ul>
</div>
</section>
<section id="remuestreo-de-datos-de-series-temporales">
<h2><span class="section-number">1.22. </span>Remuestreo de datos de series temporales<a class="headerlink" href="#remuestreo-de-datos-de-series-temporales" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>La técnica de <em><strong>remuestreo</strong></em> se ilustra utilizando una <em><strong>serie temporal sobre concentraciones químicas tomadas cada dos horas entre el 1 de enero de 1975 y el 17 de enero de 1975</strong></em>. El conjunto de datos se ha descargado de <a class="reference external" href="http://datamarket.com">datamarket</a>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>A continuación se leen los datos del archivo <code class="docutils literal notranslate"><span class="pre">CSV</span></code> en un <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> y mostramos las primeras filas del <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/home/lihkir/Data/chemical-concentration-readings.csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Shape of the dataset:&#39;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape of the dataset: (197, 2)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Timestamp</th>
      <th>Chemical conc.</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1975-01-01 00:00:00</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1975-01-01 02:00:00</td>
      <td>16.6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1975-01-01 04:00:00</td>
      <td>16.3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1975-01-01 06:00:00</td>
      <td>16.1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1975-01-01 08:00:00</td>
      <td>17.1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p><em><strong>Convertiremos</strong></em> las observaciones de la <em><strong>serie temporal original en medias diarias</strong></em> aplicando las funciones de remuestreo y media en la segunda columna. La función de remuestreo requiere que los índices de fila del <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> sean <code class="docutils literal notranslate"><span class="pre">timestamp</span></code> de tipo <code class="docutils literal notranslate"><span class="pre">numpy.datetime64</span></code>.</p></li>
<li><p>Por lo tanto, <em><strong>cambiamos los índices de fila de números enteros, como se muestra en la tabla anterior, a</strong></em> <code class="docutils literal notranslate"><span class="pre">datetime_rowid</span></code> que es una <code class="docutils literal notranslate"><span class="pre">pandas.Series</span></code> de objetos <code class="docutils literal notranslate"><span class="pre">numpy.datetime64</span></code>.</p></li>
<li><p>Los objetos <code class="docutils literal notranslate"><span class="pre">numpy.datetime64</span></code> se generan a partir de la columna <code class="docutils literal notranslate"><span class="pre">Timestamp</span></code> utilizando la función de utilidad <code class="docutils literal notranslate"><span class="pre">pd.todatetime</span></code>. El siguiente código muestra cómo se realiza la reindexación por filas</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datetime_rowid</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Timestamp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">))</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">datetime_rowid</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Timestamp</th>
      <th>Chemical conc.</th>
    </tr>
    <tr>
      <th>Timestamp</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1975-01-01 00:00:00</th>
      <td>1975-01-01 00:00:00</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>1975-01-01 02:00:00</th>
      <td>1975-01-01 02:00:00</td>
      <td>16.6</td>
    </tr>
    <tr>
      <th>1975-01-01 04:00:00</th>
      <td>1975-01-01 04:00:00</td>
      <td>16.3</td>
    </tr>
    <tr>
      <th>1975-01-01 06:00:00</th>
      <td>1975-01-01 06:00:00</td>
      <td>16.1</td>
    </tr>
    <tr>
      <th>1975-01-01 08:00:00</th>
      <td>1975-01-01 08:00:00</td>
      <td>17.1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Ahora estamos listos para aplicar las funciones de <code class="docutils literal notranslate"><span class="pre">resample</span></code> y <code class="docutils literal notranslate"><span class="pre">mean</span></code> en la columna <code class="docutils literal notranslate"><span class="pre">Chemical</span> <span class="pre">conc.</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">daily</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Chemical conc.&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="n">daily_mean</span> <span class="o">=</span> <span class="n">daily</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Observe que hemos pasado el <em><strong>argumento</strong></em> <code class="docutils literal notranslate"><span class="pre">D</span></code> a la función <code class="docutils literal notranslate"><span class="pre">resample</span></code> <em><strong>para generar las medias diarias</strong></em>. Para los agregados mensuales y anuales, tenemos que pasar <code class="docutils literal notranslate"><span class="pre">M</span></code> e <code class="docutils literal notranslate"><span class="pre">Y</span></code> a la función <code class="docutils literal notranslate"><span class="pre">resample</span></code>. Por último, <em><strong>las medias originales y diarias se representan en la siguiente figura</strong></em>, que muestra el efecto de suavización de esta última.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Chemical conc.&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">daily_mean</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Bi-hourly reading (blue) &amp; Daily Mean (red)&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Day in Jan 1975&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Chemical concentration&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e12b60aef6c6e922bb4913c4615de25d7893abddbdf3e733d775222f63e350bd.png" src="_images/e12b60aef6c6e922bb4913c4615de25d7893abddbdf3e733d775222f63e350bd.png" />
</div>
</div>
</section>
<section id="agregacion-por-grupos">
<h2><span class="section-number">1.23. </span>Agregación por grupos<a class="headerlink" href="#agregacion-por-grupos" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Para demostrar la <em><strong>agregación por grupos</strong></em>, utilizaremos la <em><strong>serie temporal de la temperatura media diaria del río Fisher en Texas, Estados Unidos</strong></em>. La serie temporal tiene observaciones tomadas <em><strong>entre el 1 de enero de 1988 y el 31 de diciembre de 1991</strong></em>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/home/lihkir/Data/mean-daily-temperature-fisher-river.csv&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Shape of dataframe:&#39;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape of dataframe: (1461, 2)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Mean temperature</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1988-01-01</th>
      <td>1988-01-01</td>
      <td>-23.0</td>
    </tr>
    <tr>
      <th>1988-01-02</th>
      <td>1988-01-02</td>
      <td>-20.5</td>
    </tr>
    <tr>
      <th>1988-01-03</th>
      <td>1988-01-03</td>
      <td>-22.0</td>
    </tr>
    <tr>
      <th>1988-01-04</th>
      <td>1988-01-04</td>
      <td>-30.5</td>
    </tr>
    <tr>
      <th>1988-01-05</th>
      <td>1988-01-05</td>
      <td>-31.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Mean temperature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mean daily temperature&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/04f937aae4fb528bbe62576d27edd8fae20e38d0163f60c1bc0569a9f9fd6760.png" src="_images/04f937aae4fb528bbe62576d27edd8fae20e38d0163f60c1bc0569a9f9fd6760.png" />
</div>
</div>
<ul class="simple">
<li><p><em><strong>La serie temporal original parece tener patrones mensuales que se repiten cada año</strong></em> y que pueden verificarse calculando los promedios mensuales. Esto se hace <em><strong>agrupando los datos en 12 meses y luego calculando los promedios de cada mes</strong></em>. Comenzamos agregando una columna <code class="docutils literal notranslate"><span class="pre">Month_Year</span></code> al <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Month_Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%m-%Y&#39;</span><span class="p">))</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Mean temperature</th>
      <th>Month_Year</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1988-01-01</th>
      <td>1988-01-01</td>
      <td>-23.0</td>
      <td>01-1988</td>
    </tr>
    <tr>
      <th>1988-01-02</th>
      <td>1988-01-02</td>
      <td>-20.5</td>
      <td>01-1988</td>
    </tr>
    <tr>
      <th>1988-01-03</th>
      <td>1988-01-03</td>
      <td>-22.0</td>
      <td>01-1988</td>
    </tr>
    <tr>
      <th>1988-01-04</th>
      <td>1988-01-04</td>
      <td>-30.5</td>
      <td>01-1988</td>
    </tr>
    <tr>
      <th>1988-01-05</th>
      <td>1988-01-05</td>
      <td>-31.0</td>
      <td>01-1988</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>A continuación, la columna <code class="docutils literal notranslate"><span class="pre">Mean</span> <span class="pre">temperature</span></code> se agrupa con respecto a la nueva columna <code class="docutils literal notranslate"><span class="pre">Month_Year</span></code> y <em><strong>se calculan la media, la mediana y las desviaciones estándar de cada mes</strong></em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">monthly_stats</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Month_Year&#39;</span><span class="p">)[</span><span class="s1">&#39;Mean temperature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">])</span>
<span class="n">monthly_stats</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">monthly_stats</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Month_Year</th>
      <th>mean</th>
      <th>median</th>
      <th>std</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>01-1988</td>
      <td>-22.137097</td>
      <td>-23.0</td>
      <td>5.260640</td>
    </tr>
    <tr>
      <th>1</th>
      <td>01-1989</td>
      <td>-17.129032</td>
      <td>-18.0</td>
      <td>8.250725</td>
    </tr>
    <tr>
      <th>2</th>
      <td>01-1990</td>
      <td>-15.112903</td>
      <td>-12.0</td>
      <td>6.606764</td>
    </tr>
    <tr>
      <th>3</th>
      <td>01-1991</td>
      <td>-23.038710</td>
      <td>-24.5</td>
      <td>7.095570</td>
    </tr>
    <tr>
      <th>4</th>
      <td>02-1988</td>
      <td>-19.025862</td>
      <td>-19.5</td>
      <td>8.598522</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Tenga en cuenta que las filas de la tabla anterior no están en orden ascendente de <code class="docutils literal notranslate"><span class="pre">Month_Year</span></code>. Por lo tanto, es necesario registrarlo. Esto se hace creando dos nuevas columnas <code class="docutils literal notranslate"><span class="pre">Month</span></code> y <code class="docutils literal notranslate"><span class="pre">Year</span></code> y, a continuación, <em><strong>ordenando en orden ascendente</strong></em> <code class="docutils literal notranslate"><span class="pre">Year</span></code>, <em><strong>seguido de la ordenación en orden ascendente de</strong></em> <code class="docutils literal notranslate"><span class="pre">Month</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">monthly_stats</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">monthly_stats</span><span class="p">[</span><span class="s1">&#39;Month_Year&#39;</span><span class="p">]</span>\
<span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%m-%Y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">))</span>

<span class="n">monthly_stats</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">monthly_stats</span><span class="p">[</span><span class="s1">&#39;Month_Year&#39;</span><span class="p">]</span>\
<span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%m-%Y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%m&#39;</span><span class="p">))</span>

<span class="n">monthly_stats</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Month&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">monthly_stats</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Month_Year</th>
      <th>mean</th>
      <th>median</th>
      <th>std</th>
      <th>Year</th>
      <th>Month</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>01-1988</td>
      <td>-22.137097</td>
      <td>-23.000</td>
      <td>5.260640</td>
      <td>1988</td>
      <td>01</td>
    </tr>
    <tr>
      <th>4</th>
      <td>02-1988</td>
      <td>-19.025862</td>
      <td>-19.500</td>
      <td>8.598522</td>
      <td>1988</td>
      <td>02</td>
    </tr>
    <tr>
      <th>8</th>
      <td>03-1988</td>
      <td>-8.258065</td>
      <td>-9.250</td>
      <td>5.341459</td>
      <td>1988</td>
      <td>03</td>
    </tr>
    <tr>
      <th>12</th>
      <td>04-1988</td>
      <td>2.641667</td>
      <td>1.875</td>
      <td>5.057720</td>
      <td>1988</td>
      <td>04</td>
    </tr>
    <tr>
      <th>16</th>
      <td>05-1988</td>
      <td>11.290323</td>
      <td>11.000</td>
      <td>6.254364</td>
      <td>1988</td>
      <td>05</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Los agregados mensuales se representan en la siguiente figura, que pone de manifiesto la <em><strong>estacionalidad mensual</strong></em> existente en los datos originales.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">monthly_stats</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">monthly_stats</span><span class="p">[</span><span class="s1">&#39;Month_Year&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">monthly_stats</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">monthly_stats</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Monthly statistics: Mean (blue) &amp; Std. Dev. (red)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/174147c9384264a3dbeb835ba99ef5ee9177e0df10dfd3f6ffa4ce1eaa5dd868.png" src="_images/174147c9384264a3dbeb835ba99ef5ee9177e0df10dfd3f6ffa4ce1eaa5dd868.png" />
</div>
</div>
</section>
<section id="estadisticos-moviles">
<h2><span class="section-number">1.24. </span>Estadísticos móviles<a class="headerlink" href="#estadisticos-moviles" title="Link to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title">Introducción</p>
<ul class="simple">
<li><p>Los <em><strong>estadísticos móviles o rodantes</strong></em> se calculan <em><strong>desplazando una ventana sobre la serie temporal original</strong></em> y agregando los datos de cada ventana. Los <em><strong>parámetros clave son el tamaño de la ventana y la longitud del paso</strong></em>, que definen la entrada y el intervalo para cada cálculo.</p></li>
<li><p>Por ejemplo, supongamos que se utiliza un <em><strong>tamaño de ventana de</strong></em> <span class="math notranslate nohighlight">\(k\)</span> y un <em><strong>intervalo de longitud</strong></em> <span class="math notranslate nohighlight">\(l\)</span> para calcular la función <span class="math notranslate nohighlight">\(f\)</span> sobre una serie temporal <span class="math notranslate nohighlight">\(y_{1}, y_{2},\dots, y_{T}\)</span> con <span class="math notranslate nohighlight">\(T\)</span> observaciones. En este caso, el estadístico móvil se obtiene como <span class="math notranslate nohighlight">\(f(y_{1}, y_{2},\dots, y_{k}), f(y_{1+l}, y_{2+l},\dots, y_{k+l})\)</span>, y así sucesivamente.</p></li>
<li><p>Obsérvese que <em><strong>cada vez se calcula la función desplazando la ventana temporal hacia la derecha</strong></em> en <span class="math notranslate nohighlight">\(l\)</span> <em><strong>unidades de tiempo</strong></em>. La <em><strong>media móvil es un caso especial de la función</strong></em> <span class="math notranslate nohighlight">\(f\)</span> y requiere simplemente promediar las observaciones en la ventana de tiempo.</p></li>
</ul>
</div>
<ul class="simple">
<li><p>Vamos a demostrar cómo se pueden <em><strong>calcular las medias móviles en el conjunto de datos de Fisher River</strong></em>. Calcularemos las medias móviles semanales, fijando el <em><strong>tamaño de la ventana en siete y deslizando la ventana un lugar a la derecha</strong></em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weekly_moving_average</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Mean temperature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">monthly_moving_average</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Mean temperature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>La función <code class="docutils literal notranslate"><span class="pre">rolling</span></code> <em><strong>solo toma como argumento el tamaño de la ventana</strong></em>. Por lo tanto, para añadir una <em><strong>longitud de paso de más de uno</strong></em>, seguimos calculando la media móvil como se ha mostrado anteriormente, pero <em><strong>cortamos la serie resultante para obtener el resultado deseado</strong></em>. Para las franjas de más de dos unidades de tiempo utilizamos el siguiente código</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weekly_moving_average_2stride</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Mean temperature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()[::</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">monthly_moving_average_2stride</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Mean temperature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()[::</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>En el análisis de series temporales, los <em><strong>estadísticos móviles basadas en la longitud de paso son las más comunes</strong></em>, por lo que rara vez se necesitará algo más que la función rolling. Los datos originales se representan en la siguiente figura, que muestra la <em><strong>reducción del ruido y el consiguiente efecto de suavización</strong></em> producido por las medias móviles</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Mean temperature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Daily mean temperature&#39;</span><span class="p">);</span>

<span class="n">weekly_moving_average</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Weekly moving average&#39;</span><span class="p">);</span>

<span class="n">monthly_moving_average</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Monthly moving average&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d76842e8420d48cade0dbf35728536c1d599cad6e8c8d0bdb240963ecff6e1c5.png" src="_images/d76842e8420d48cade0dbf35728536c1d599cad6e8c8d0bdb240963ecff6e1c5.png" />
</div>
</div>
<div class="proof theorem admonition" id="th_moving_average">
<p class="admonition-title"><span class="caption-number">Theorem 1.1 </span></p>
<section class="theorem-content" id="proof-content">
<ul class="simple">
<li><p>Una <em><strong>media móvil simple</strong></em> de longitud <span class="math notranslate nohighlight">\(N\)</span> asigna ponderaciones <span class="math notranslate nohighlight">\(1/N\)</span> a las observaciones más recientes <span class="math notranslate nohighlight">\(y_{T}, y_{T-1},\dots, y_{T-N+1}\)</span>, y peso cero a todas las demás observaciones. Si <span class="math notranslate nohighlight">\(M_{T}\)</span> es la media móvil, la media móvil de <span class="math notranslate nohighlight">\(N\)</span> intervalos en el período <span class="math notranslate nohighlight">\(T\)</span> es</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
M_{T}=\frac{y_{T}+y_{T-1}+\cdots+y_{T-N+1}}{N}=\frac{1}{N}\sum_{t=T-N+1}^{T}y_{t}
\]</div>
<ul class="simple">
<li><p>Evidentemente, <em><strong>a medida que se dispone de cada nueva observación, ésta se añade a la suma a partir de la cual se calcula la media móvil</strong></em> y la observación más antigua se descarta (<code class="docutils literal notranslate"><span class="pre">rolling</span></code>). Si la varianza de una observación individual <span class="math notranslate nohighlight">\(y_{t}\)</span> es <span class="math notranslate nohighlight">\(\sigma^{2}\)</span>, entonces, <em><strong>suponiendo que las observaciones no están correlacionadas</strong></em>, la <em><strong>varianza de la media móvil</strong></em> es</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\textsf{Var}(M_{T})=\frac{\sigma^{2}}{N}.
\]</div>
<ul>
<li><p>A veces se utiliza una versión <code class="docutils literal notranslate"><span class="pre">&quot;centrada&quot;</span></code> de la media móvil, dada por</p>
<div class="math notranslate nohighlight">
\[
    M_{t}=\frac{1}{S+1}\sum_{i=-S}^{S}y_{t-i}
    \]</div>
<p>donde el intervalo de la media móvil centrada es <span class="math notranslate nohighlight">\(N=2S+1\)</span></p>
</li>
</ul>
</section>
</div><p><strong><code class="docutils literal notranslate"><span class="pre">Demostración</span></code></strong></p>
<ul class="simple">
<li><p>Si la varianza de una observación individual <span class="math notranslate nohighlight">\(y_{t}\)</span> es <span class="math notranslate nohighlight">\(\sigma^{2}\)</span>, entonces <em><strong>asumiendo que las observaciones no están correlacionadas, la varianza de la media móvil es</strong></em></p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\textsf{Var}\left(M_{T}\right)=\textsf{Var}\left(\frac{1}{N}\sum_{t=T-N+1}^{T}y_{t}\right)=\frac{1}{N^2}\sum_{t=T-N+1}^{T}\textsf{Var}(y_{t})=\frac{\sigma^2}{N}.
\]</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul>
<li><p>La <em><strong>media móvil simple</strong></em> es un <em><strong>suavizador de datos lineal</strong></em>, o un filtro lineal, <em><strong>porque sustituye cada observación</strong></em> <span class="math notranslate nohighlight">\(y_{t}\)</span> <em><strong>por una combinación lineal de los otros puntos de datos que están cerca de él en el tiempo</strong></em>. Si los pesos de la combinación lineal son iguales, la combinación lineal es una media.</p></li>
<li><p>En algunos caso, podrían utilizarse pesos desiguales. Por ejemplo, el <em><strong>filtro de Hanning</strong></em> es una media móvil ponderada y centrada dada por</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \\[2mm]
    M_{t}^{H}=0.25 y_{t+1}+0.5y_{t}+0.25y_{t-1}.
    \end{split}\]</div>
<p><em><strong>Julius von Hann</strong></em>, meteorólogo austriaco del siglo XIX, utilizó este filtro para suavizar datos meteorológicos.</p>
</li>
</ul>
</div>
<ul>
<li><p>Una desventaja obvia de un filtro lineal como una <em><strong>media móvil</strong></em> es que un <em><strong>punto de datos inusual o erróneo o un valor atípico dominará las medias móviles que contengan esa observación</strong></em>, contaminando las medias durante un periodo de tiempo igual al intervalo del filtro. Por ejemplo, consideremos la secuencia de observaciones</p>
<div class="math notranslate nohighlight" id="equation-unusual-data-value">
<span class="eqno">(1.2)<a class="headerlink" href="#equation-unusual-data-value" title="Link to this equation">#</a></span>\[\begin{split}
    \\[1mm]
    \{15, 18, 13, 12, 16, 14, 16, 17, 18, 15, 18, 200, 19, 14, 21, 24, 19, 25\}
    \end{split}\]</div>
<p>que aumenta de forma <em><strong>razonablemente constante de 15 a 25, excepto para el inusual valor 200</strong></em>.</p>
</li>
<li><p>Cualquier versión suavizada razonable de los datos también debería aumentar de forma constante de 15 a 25 y <em><strong>no hacer hincapié en el valor 200</strong></em>. Ahora, incluso si 200 es una observación legítima, y no el <em><strong>resultado de un error de registro de datos (¡quizás debería ser 20!)</strong></em>, es tan inusual que <em><strong>merece una atención especial y probablemente no debería analizarse junto con el resto de los datos</strong></em>.</p></li>
</ul>
<div class="proof definition admonition" id="moving_median">
<p class="admonition-title"><span class="caption-number">Definition 1.1 </span> (Medianas moviles corridas)</p>
<section class="definition-content" id="proof-content">
<ul>
<li><p>Las medianas móviles impares (también denominadas <em><strong>medianas móviles corridas</strong></em>) son una <em><strong>alternativa a las medias móviles que suavizan eficazmente los datos cuando la serie puede estar contaminada con valores inusuales o valores atípicos</strong></em>. La mediana de intervalo <span class="math notranslate nohighlight">\(N\)</span> se define como</p>
<div class="math notranslate nohighlight">
\[
    m_{t}^{[N]}=\textsf{med}(y_{t-u},\dots,y_{t},\dots,\dots,y_{t+u}),
    \]</div>
<p>donde <span class="math notranslate nohighlight">\(N=2u+1\)</span>.</p>
</li>
<li><p>La mediana es la observación intermedia en el orden de clasificación (u orden de valor). La <em><strong>mediana móvil de span 3</strong></em> es un suavizador de datos muy popular y eficaz, donde</p>
<div class="math notranslate nohighlight">
\[
    m_{t}^{3}=\textsf{med}(y_{t-1}, y_{t}, y_{t+1}).
    \]</div>
</li>
</ul>
</section>
</div><ul class="simple">
<li><p>Este suavizador procesaría los datos de tres en tres, y <em><strong>sustituiría las tres observaciones originales por su mediana</strong></em>. Si aplicamos este suavizador a los datos anteriores (ver datos <a class="reference internal" href="#equation-unusual-data-value">(1.2)</a>), obtenemos</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\{\underline{\hspace{9mm}},15, 13, 13, 14, 16, 17, 17, 18, 18, 19, 19, 19, 21, 21, 24, \underline{\hspace{9mm}}\}
\]</div>
<ul class="simple">
<li><p>Estos datos suavizados son una representación razonable de los datos originales, pero ignoran convenientemente el valor 200. <em><strong>Los valores iniciales/finales se pierden al utilizar la mediana móvil, y se representan con</strong></em> “<span class="math notranslate nohighlight">\(\underline{\hspace{9mm}}\)</span>”.</p></li>
<li><p>En general, una mediana móvil pasará secuencias monótonas de datos sin cambios. Seguirá una función escalonada en los datos, pero <em><strong>eliminará un pico o una alteración más persistente en los datos</strong></em> que tenga una duración de como máximo <span class="math notranslate nohighlight">\(u\)</span> observaciones consecutivas. Las medianas móviles <em><strong>pueden aplicarse más de una vez para obtener una serie de observaciones aún más suave</strong></em>.</p></li>
<li><p>Por ejemplo, si se aplica la mediana móvil de longitud 3 a los datos suavizados anteriores, resulta en</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\{\underline{\hspace{9mm}}, 13, 13, 14, 16, 17, 17, 18, 18, 19, 19, 19, 21, 21, \underline{\hspace{9mm}}\}
\]</div>
<ul class="simple">
<li><p>Estos datos son ahora tan suaves como se puede conseguir; es decir, la aplicación repetida de la mediana móvil no cambiará los datos, aparte de los valores finales. <em><strong>Si hay muchas observaciones, la pérdida de información de los valores finales que faltan no es grave</strong></em>. Sin embargo, si es necesario o deseable mantener las longitudes de los conjuntos de datos originales y suavizados, una forma sencilla de hacerlo es <em><strong>“copiar” o volver a añadir los valores finales de los datos originales</strong></em>. Esto daría como resultado los datos suavizados:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\{\underline{\hspace{9mm}}, 15, 18, 13, 13, 14, 16, 17, 17, 18, 18, 19, 19, 19, 21, 21, 19, 25, \underline{\hspace{9mm}}\}
\]</div>
<ul class="simple">
<li><p>También existen métodos para suavizar los valores finales. <span id="id2">[<a class="reference internal" href="biblio.html#id2" title="John W Tukey and others. Exploratory data analysis. Volume 2. Reading, MA, 1977.">Tukey and others, 1977</a>]</span> es una referencia básica sobre este tema y contiene muchas otras técnicas útiles para el análisis de datos.</p></li>
</ul>
</section>
<section id="procesos-estacionarios">
<h2><span class="section-number">1.25. </span>Procesos estacionarios<a class="headerlink" href="#procesos-estacionarios" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>La <em><strong>estacionariedad es un supuesto fundamental en la teoría estadística y el análisis de series temporales</strong></em>. Asegura que los <em><strong>estadísticos muestrales, como la media y la varianza, se mantengan constantes a lo largo del tiempo</strong></em>, lo que permite su uso como <em><strong>estimaciones confiables para futuras ocurrencias</strong></em>.</p></li>
<li><p>En el contexto de series temporales, la <em><strong>estacionariedad implica que las propiedades de la serie, como: la media, la varianza y la autocorrelación, no cambien con el tiempo</strong></em>. En resumen, la estacionariedad requiere que la serie tenga una <em><strong>media y una varianza constantes</strong></em>, <em>sin patrones predecibles o repetitivos</em>.</p></li>
</ul>
<div class="proof definition admonition" id="def_stationarity">
<p class="admonition-title"><span class="caption-number">Definition 1.2 </span> (Serie temporal estacionaria)</p>
<section class="definition-content" id="proof-content">
<ul>
<li><p>Una serie de tiempo se dice que es <em><strong>estrictamente estacionaria si sus propiedades no se ven afectadas por un cambio en el origen temporal</strong></em>. Es decir, si la <em><strong>distribución de probabilidad conjunta de las observaciones</strong></em> <span class="math notranslate nohighlight">\(y_{t}, y_{t+1}, y_{t+2}, \dots, y_{t+n}\)</span> <em><strong>es exactamente igual a la distribución de las observaciones</strong></em> <span class="math notranslate nohighlight">\(y_{t+k}, y_{t+k+1}, y_{t+k+2}, \dots, y_{t+k+n}\)</span> entonces la es estrictamente estacionaria.</p></li>
<li><p>Cuando <span class="math notranslate nohighlight">\(n = 0\)</span>, el supuesto de estacionariedad significa que la <em><strong>distribución de probabilidad de</strong></em> <span class="math notranslate nohighlight">\(y_{t}\)</span> <em><strong>es la misma en todos los periodos de tiempo</strong></em> y puede escribirse como <span class="math notranslate nohighlight">\(f(y)\)</span>.</p></li>
<li><p>Estacionarieda implica un tipo de <em><strong>equilibrio estadístico o estabilidad en los datos</strong></em>. En consecuencia, la serie temporal tiene una <em><strong>media constante</strong></em> definida de la forma habitual como</p>
<div class="math notranslate nohighlight">
\[
    \mu_{y}=\textsf{E}(y)=\int_{-\infty}^{\infty}yf(y)dy
    \]</div>
<p>y una <em><strong>varianza constante</strong></em> definida como</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \\[1mm]
    \sigma_{y}^{2}=\textsf{Var}(y)=\int_{-\infty}^{\infty}(y-\mu_{y})^{2}f(y) dy.
    \end{split}\]</div>
</li>
<li><p>Para <em><strong>estimar estos parámetros se utilizan la media y la varianza muestrales</strong></em>. Si las observaciones de la serie temporal son <span class="math notranslate nohighlight">\(y_{1}, y_{2},\dots, y_{T}\)</span>, la <em><strong>media muestral</strong></em> es</p>
<div class="math notranslate nohighlight">
\[
    \overline{y}=\hat{\mu}_{y}=\frac{1}{T}\sum_{t=1}^{T}y_{t}
    \]</div>
<p>y la <em><strong>varianza muestral</strong></em> es</p>
<div class="math notranslate nohighlight" id="equation-sample-variance-t">
<span class="eqno">(1.3)<a class="headerlink" href="#equation-sample-variance-t" title="Link to this equation">#</a></span>\[
    s^{2}=\hat{\sigma}_{y}^{2}=\frac{1}{T}\sum_{t=1}^{T}(y_{t}-\overline{y})^{2}.
    \]</div>
</li>
<li><p>Obsérvese que el divisor en la Ecuación <a class="reference internal" href="#equation-sample-variance-t">(1.3)</a> es <span class="math notranslate nohighlight">\(T\)</span> en lugar del más familiar <span class="math notranslate nohighlight">\(T-1\)</span>. Esta es la convención común en muchas aplicaciones de series temporales, <em><strong>como</strong></em> <span class="math notranslate nohighlight">\(T\)</span> <em><strong>no suele ser pequeño, habrá poca diferencia entre utilizar</strong></em> <span class="math notranslate nohighlight">\(T\)</span> <em><strong>en lugar de</strong></em> <span class="math notranslate nohighlight">\(T-1\)</span>.</p></li>
</ul>
</section>
</div><ul class="simple">
<li><p>Un ejemplo popular de serie temporal estacionaria es la <em><strong>serie de media cero, que se genera a partir de puntos que se muestrean de una distribución normal de media cero y varianza unitaria</strong></em>.</p></li>
<li><p>Aunque los puntos se muestrean secuencialmente de la distribución normal y se representan como una serie temporal, las <em><strong>observaciones individuales son independientes e idénticamente distribuidas (iid)</strong></em>. La serie de media cero no muestra ningún patrón temporal, como la <em><strong>tendencia, la estacionalidad y la autocorrelación</strong></em>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">seed</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">Series</span>
<span class="kn">import</span> <span class="nn">random</span> 
<span class="kn">from</span> <span class="nn">pandas.plotting</span> <span class="kn">import</span> <span class="n">autocorrelation_plot</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Usamos una semilla <code class="docutils literal notranslate"><span class="pre">seed</span></code> generadora de números aleatorios, y creamos una <em><strong>serie de ruido blanco</strong></em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">series</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)]</span>
<span class="n">series</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>
<span class="n">series</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    1000.000000
mean       -0.013222
std         1.003685
min        -2.961214
25%        -0.684192
50%        -0.010934
75%         0.703915
max         2.737260
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">series</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/623a85423851aab657b6905bfc6d40ebeb586c582dda765336273d280be5551d.png" src="_images/623a85423851aab657b6905bfc6d40ebeb586c582dda765336273d280be5551d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;text.usetex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="o">.</span><span class="n">flat</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">series</span><span class="p">[</span><span class="n">i</span><span class="p">:],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Histogram $\{y_{t+</span><span class="si">%d</span><span class="s1">}\}_{t=1}^</span><span class="si">{T}</span><span class="s1">$&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">))</span> 

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;text.usetex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0c4102d4b3afc6a695ed776d89a7954094dd09965d89e28e90bb6fce01ed214f.png" src="_images/0c4102d4b3afc6a695ed776d89a7954094dd09965d89e28e90bb6fce01ed214f.png" />
</div>
</div>
<ul class="simple">
<li><p>Las <em><strong>series temporales reales suelen no ser estacionarias debido a tendencias y estacionalidades que afectan a la media, la varianza y la autocorrelación</strong></em> a lo largo del tiempo. Las <em><strong>fluctuaciones cíclicas no se consideran al definir la estacionariedad</strong></em>, ya que estas solo pueden explicarse mediante variables exógenas (<em>variables o factores externos</em>).</p></li>
<li><p>Una <em><strong>serie temporal sin patrones predecibles a largo plazo es considerada estacionaria</strong></em>. Para <em><strong>verificar esto</strong></em>, se utiliza la <em><strong>prueba de Dickey-Fuller Aumentada (ADF)</strong></em> y se aplica la diferenciación para <em><strong>estacionarizar series temporales no estacionarias</strong></em>, eliminando tendencias y componentes estacionales. Los métodos de <em><strong>descomposición para tendencias y estacionalidades complejas se discuten a continuación</strong></em>.</p></li>
</ul>
</section>
<section id="transformacion-de-datos-y-ajustes">
<h2><span class="section-number">1.26. </span>Transformación de datos y ajustes<a class="headerlink" href="#transformacion-de-datos-y-ajustes" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Las <em><strong>transformaciones de datos</strong></em> son comunes en estadística y se utilizan principalmente para <em><strong>estabilizar la varianza de los datos</strong></em>. La <em><strong>varianza no constante, conocida como <code class="docutils literal notranslate"><span class="pre">heteroscedasticidad</span></code>, es frecuente en series temporales</strong></em>. Para abordar esto, se emplean modelos como <code class="docutils literal notranslate"><span class="pre">GARCH</span></code>. Ejemplos incluyen <em><strong>series relacionadas con la volatilidad de acciones como Tesla o la criptomoneda BTC</strong></em>, donde una transformación logarítmica puede reducir la varianza.</p></li>
</ul>
<div class="proof definition admonition" id="definition-3">
<p class="admonition-title"><span class="caption-number">Definition 1.3 </span> (Transformaciones de potencia)</p>
<section class="definition-content" id="proof-content">
<ul>
<li><p>Un tipo muy popular de transformación de datos para tratar con la varianza es la <em><strong>familia de transformaciones de potencia</strong></em>, dada por</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    y^{(\lambda)}=
    \begin{cases}
    \frac{\displaystyle{y^{\lambda}-1}}{\displaystyle{\lambda\dot{y}^{\lambda-1}}}, &amp;\quad\lambda\neq0\\[2mm]
    \dot{y}\lambda y, &amp;\quad\lambda=0
    \end{cases},\quad\text{donde}\quad\dot{y}=\exp\left[\frac{1}{T}\sum_{t=1}^{T}\ln(y_{t})\right].
    \end{split}\]</div>
<p><span class="math notranslate nohighlight">\(\dot{y}\)</span> es conocida como la <em><strong>media geométrica de las observaciones</strong></em>.</p>
</li>
</ul>
</section>
</div><div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>Si <span class="math notranslate nohighlight">\(\lambda=1\)</span>, <em><strong>no hay transformación</strong></em>. Los valores típicos de <span class="math notranslate nohighlight">\(\lambda\)</span> utilizados con datos de series temporales son:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\lambda=0.5\)</span> (<em><strong>transformación de raíz cuadrada</strong></em>)</p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda=0\)</span> (<em><strong>transformación logarítmica</strong></em> <span class="math notranslate nohighlight">\((y^{\lambda}-1)/\lambda\rightarrow\log(y)\)</span> cuando <span class="math notranslate nohighlight">\(\lambda\rightarrow 0\)</span>)</p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda=-0.5\)</span> (<em><strong>transformación recíproca de raíz cuadrada</strong></em>)</p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda=-1\)</span> (<em><strong>transformación inversa</strong></em>).</p></li>
</ol>
</li>
<li><p>El <em><strong>divisor es un factor de escala</strong></em> que permite comparar la suma residual de cuadrados al ajustar diferentes modelos con diferentes transformaciones. La <em><strong>transformación logarítmica se usa cuando la variabilidad de la serie temporal original aumenta con su nivel medio</strong></em>, siendo óptima cuando la desviación típica aumenta linealmente con la media.</p></li>
</ul>
</div>
<ul class="simple">
<li><p>La <em><strong>transformación logarítmica</strong></em> también tiene una interpretación física como <em><strong>cambio porcentual</strong></em>. Para ilustrarlo, considere la serie de tiempo <span class="math notranslate nohighlight">\(y_{1}, y_{2}, \dots, y_{T}\)</span> y supongamos que estamos interesados en el porcentaje de cambio en <span class="math notranslate nohighlight">\(y_{t}\)</span>, digamos,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
x_{t}=\frac{100(y_{t}-y_{t-1})}{y_{t-1}}.
\]</div>
<ul>
<li><p>El <em><strong>cambio porcentual aproximado</strong></em> de <span class="math notranslate nohighlight">\(y_{t}\)</span> puede calcularse a partir de las <em><strong>diferencias de la serie temporal transformada logarítmicamente</strong></em> <span class="math notranslate nohighlight">\(x_{t}\cong 100[\ln(y_{t}) - \ln(y_{t}-1)]\)</span> dado que,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \\[1mm]
    \begin{align*}
    100[\ln(y_{t}) - \ln(y_{t}-1)]&amp;=100\ln\left(\frac{y_{t}}{y_{t-1}}\right)\\
    &amp;=100\ln\left(\frac{y_{t-1}+(y_{t}-y_{t-1})}{y_{t-1}}\right)\\
    &amp;=100\ln\left(1+\frac{x_{t}}{100}\right)\cong x_{t},
    \end{align*}
    \end{split}\]</div>
<p>nótese que <span class="math notranslate nohighlight">\(\ln(1+z)\cong z\)</span> cuando <span class="math notranslate nohighlight">\(z\)</span> es pequeño.</p>
</li>
</ul>
</section>
<section id="ajustes-estacionales-y-de-tendencia">
<h2><span class="section-number">1.27. </span>Ajustes estacionales y de tendencia<a class="headerlink" href="#ajustes-estacionales-y-de-tendencia" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Los <em><strong>ajustes de tendencia y estacionales son esenciales en el modelado y la predicción de series temporales</strong></em>. Una serie temporal con tendencia se considera no estacionaria. Para simplificar el análisis, es común <em><strong>eliminar la tendencia ajustando los datos a un modelo de regresión y luego sustraerlo de las observaciones originales</strong></em>, dejando residuos sin tendencia.</p></li>
</ul>
</section>
<section id="diferenciacion">
<h2><span class="section-number">1.28. </span>Diferenciación<a class="headerlink" href="#diferenciacion" title="Link to this heading">#</a></h2>
<ul>
<li><p>Otro enfoque para <em><strong>eliminar la tendencia es mediante la diferenciación de los datos</strong></em>; es decir, <em><strong>aplicando el operador de diferencia a la serie temporal original para obtener una nueva serie temporal</strong></em>, digamos,</p>
<div class="math notranslate nohighlight">
\[
  x_{t}=y_{t}-y_{t-1}=\nabla y_{t},
  \]</div>
<p>donde <span class="math notranslate nohighlight">\(\nabla\)</span> es el <em><strong>operador de diferencia</strong></em> (<code class="docutils literal notranslate"><span class="pre">backward</span></code>). Otra forma de escribir la operación de diferencia es en términos de un <em><strong>operador de desplazamiento hacia atrás</strong></em> (<code class="docutils literal notranslate"><span class="pre">backshift</span> <span class="pre">operator</span></code>) <span class="math notranslate nohighlight">\(B\)</span>, definido como <span class="math notranslate nohighlight">\(By_{t} = y_{t-1}\)</span>, entonces</p>
<div class="math notranslate nohighlight">
\[
  x_{t}=(1-B)y_{t}=\nabla y_{t}=y_{t}-y_{t-1}
  \]</div>
<p>con <span class="math notranslate nohighlight">\(\nabla=(1-B)\)</span>.</p>
</li>
<li><p>La diferenciación puede <em><strong>realizarse sucesivamente si es necesario hasta que se elimine la tendencia</strong></em>; por ejemplo, la <em>segunda diferencia</em> es</p>
<div class="math notranslate nohighlight">
\[
  x_{t}=\nabla^{2}y_{t}=\nabla(\nabla y_{t})=(1-B)^{2}y_{t}=(1-2B+B^{2})=y_{t}-2y_{t-1}+y_{t-2}
  \]</div>
</li>
<li><p>En general, las <em><strong>potencias del operador de desplazamiento y diferencia hacia atrás</strong></em> se definen como</p>
<div class="math notranslate nohighlight">
\[
  B^{d}y_{t}=y_{t-d}\quad\text{y}\quad\nabla^{d}=(1-B)^{d}.
  \]</div>
</li>
</ul>
<ul>
<li><p>La <em><strong>diferenciación se usa para eliminar la estacionalidad</strong></em> en series temporales que tienen tanto <em><strong>tendencia como componentes estacionales</strong></em>. Se define un operador de diferencia estacional con rezago <span class="math notranslate nohighlight">\(d\)</span> como</p>
<div class="math notranslate nohighlight">
\[
  \nabla_{d}y_{t}=(1-B^{d})=y_{t}-y_{t-d}.
  \]</div>
</li>
<li><p>Por ejemplo, si tuviéramos <em><strong>datos mensuales con una estación anual</strong></em> (<em>una situación muy común</em>), es probable que usemos <span class="math notranslate nohighlight">\(d=12\)</span>, por lo que los <em><strong>datos diferenciados estacionalmente serían</strong></em></p>
<div class="math notranslate nohighlight">
\[
  \nabla_{12}y_{t}=(1-B^{12})y_{t}=y_{t}-y_{t-12}
  \]</div>
</li>
<li><p>Cuando hay <em><strong>tendencia y componentes estacionales al mismo tiempo</strong></em>, podemos eliminarlos <em><strong>diferenciando primero estacionalmente</strong></em> y <em><strong>luego usando la diferenciación regular para eliminar la tendencia</strong></em>.</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>La <em><strong>diferenciación es más simple que ajustar un modelo de tendencia porque no necesita estimar parámetros</strong></em>. Además, mientras que el ajuste del modelo supone que la tendencia es constante en el tiempo, la diferenciación permite que cambie. La <em><strong>primera diferencia considera cambios en la media</strong></em>, la <em><strong>segunda en la pendiente</strong></em>, y así sucesivamente. <em><strong>Por lo general, una o dos diferencias son suficientes para eliminar una tendencia</strong></em> en los datos.</p></li>
<li><p>Para <em><strong>verificar si la diferenciación de primer orden ha estacionado una serie temporal</strong></em>, se puede trazar la función de autocorrelación <em><strong>(ACF) y realizar la prueba de Ljung-Box</strong></em> en la serie diferenciada. <em><strong>Esta prueba determina si la autocorrelación observada es estadísticamente significativa</strong></em>, con la <em><strong>hipótesis nula de que la serie es aleatoria y sin autocorrelación predecible</strong></em>.</p></li>
</ul>
</div>
<ul class="simple">
<li><p>Ilustraremos esto con la serie temporal del <em><strong>índice industrial</strong></em> <a class="reference external" href="https://es.wikipedia.org/wiki/%C3%8Dndice_burs%C3%A1til_Dow_Jones">Dow Jones (DJIA)</a>, tomando la <em><strong>primera diferencia de los valores de cierre</strong></em> y trazando la serie resultante.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa</span> <span class="kn">import</span> <span class="n">stattools</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">pandas.plotting</span> <span class="kn">import</span> <span class="n">autocorrelation_plot</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">djia_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;/home/lihkir/Data/DJIA_Jan2016_Dec2016.xlsx&#39;</span><span class="p">)</span>
<span class="n">djia_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2016-01-04</td>
      <td>17405.480469</td>
      <td>17405.480469</td>
      <td>16957.630859</td>
      <td>17148.939453</td>
      <td>17148.939453</td>
      <td>148060000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016-01-05</td>
      <td>17147.500000</td>
      <td>17195.839844</td>
      <td>17038.609375</td>
      <td>17158.660156</td>
      <td>17158.660156</td>
      <td>105750000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2016-01-06</td>
      <td>17154.830078</td>
      <td>17154.830078</td>
      <td>16817.619141</td>
      <td>16906.509766</td>
      <td>16906.509766</td>
      <td>120250000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2016-01-07</td>
      <td>16888.359375</td>
      <td>16888.359375</td>
      <td>16463.630859</td>
      <td>16514.099609</td>
      <td>16514.099609</td>
      <td>176240000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2016-01-08</td>
      <td>16519.169922</td>
      <td>16651.890625</td>
      <td>16314.570313</td>
      <td>16346.450195</td>
      <td>16346.450195</td>
      <td>141850000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Analicemos la columna <code class="docutils literal notranslate"><span class="pre">Date</span></code> y utilicémosla como índice de fila para el <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> y dejémosla como columna</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">djia_df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span>
<span class="n">djia_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">djia_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-01-04</th>
      <td>17405.480469</td>
      <td>17405.480469</td>
      <td>16957.630859</td>
      <td>17148.939453</td>
      <td>17148.939453</td>
      <td>148060000</td>
    </tr>
    <tr>
      <th>2016-01-05</th>
      <td>17147.500000</td>
      <td>17195.839844</td>
      <td>17038.609375</td>
      <td>17158.660156</td>
      <td>17158.660156</td>
      <td>105750000</td>
    </tr>
    <tr>
      <th>2016-01-06</th>
      <td>17154.830078</td>
      <td>17154.830078</td>
      <td>16817.619141</td>
      <td>16906.509766</td>
      <td>16906.509766</td>
      <td>120250000</td>
    </tr>
    <tr>
      <th>2016-01-07</th>
      <td>16888.359375</td>
      <td>16888.359375</td>
      <td>16463.630859</td>
      <td>16514.099609</td>
      <td>16514.099609</td>
      <td>176240000</td>
    </tr>
    <tr>
      <th>2016-01-08</th>
      <td>16519.169922</td>
      <td>16651.890625</td>
      <td>16314.570313</td>
      <td>16346.450195</td>
      <td>16346.450195</td>
      <td>141850000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Utilizaremos los valores <code class="docutils literal notranslate"><span class="pre">&quot;Close&quot;</span></code> del <code class="docutils literal notranslate"><span class="pre">DJIA</span></code> para ilustrar la diferenciación</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_order_diff</span> <span class="o">=</span> <span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Trazamos las series temporales originales y las de primera diferencia</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">)</span>
<span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Close values of DJIA during Jan 2016-Dec 2016&#39;</span><span class="p">);</span>
<span class="n">first_order_diff</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;First-order differences of DJIA during Jan 2016-Dec 2016&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6d088d8f49f5f0c0b683d16d46f30c8a1158a11037e65acb89de65304d6aa4bd.png" src="_images/6d088d8f49f5f0c0b683d16d46f30c8a1158a11037e65acb89de65304d6aa4bd.png" />
</div>
</div>
<ul class="simple">
<li><p>A continuación, se calcula el <em><strong>ACF para diferentes rezagos y se verifica la prueba de Ljung-Box</strong></em>. La figura siguiente muestra la <code class="docutils literal notranslate"><span class="pre">ACF</span></code> de los valores de cierre del <code class="docutils literal notranslate"><span class="pre">DJIA</span></code> y <em><strong>también para la serie temporal de diferencias de primer orden</strong></em>.</p></li>
<li><p>Obsérvese que <em><strong>para las series diferenciadas, la <code class="docutils literal notranslate"><span class="pre">ACF</span></code> no muestra un patrón predecible y cae repentinamente cerca de cero</strong></em>. Además, el valor <span class="math notranslate nohighlight">\(p\)</span> de la prueba nos hace <em><strong>aceptar la hipótesis nula de la prueba de Ljung-Box</strong></em> (<em>aleatoriedad e independencia</em>) para las series diferenciadas</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">)</span>
<span class="n">autocorrelation_plot</span><span class="p">(</span><span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ACF of DJIA Close values&#39;</span><span class="p">)</span>
<span class="n">autocorrelation_plot</span><span class="p">(</span><span class="n">first_order_diff</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ACF of first differences of DJIA Close values&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/47d1e88eaed1f540aa918f356ac07076938d8a248e6cfd3783c5b36100fda6e1.png" src="_images/47d1e88eaed1f540aa918f356ac07076938d8a248e6cfd3783c5b36100fda6e1.png" />
</div>
</div>
<ul class="simple">
<li><p>Para la <em><strong>prueba de Ljung-Box, utilizamos</strong></em> la función <code class="docutils literal notranslate"><span class="pre">acf</span></code> del paquete <code class="docutils literal notranslate"><span class="pre">statsmodels.tsa.stattools</span></code>. La función <code class="docutils literal notranslate"><span class="pre">acf</span></code> está hecha para <em><strong>devolver las autocorrelaciones, los intervalos de confianza, los estadísticos</strong></em> <span class="math notranslate nohighlight">\(Q\)</span> <em><strong>y los valores</strong></em> <span class="math notranslate nohighlight">\(p\)</span> de la prueba</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">acf_djia</span><span class="p">,</span> <span class="n">confint_djia</span><span class="p">,</span> <span class="n">qstat_djia</span><span class="p">,</span> <span class="n">pvalues_djia</span> <span class="o">=</span> <span class="n">stattools</span><span class="o">.</span><span class="n">acf</span><span class="p">(</span><span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">],</span>
                                                                 <span class="n">nlags</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                                                                 <span class="n">qstat</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                                 <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Comprobemos si con un <em><strong>nivel de confianza del</strong></em> 95% (<span class="math notranslate nohighlight">\(\alpha=0.05\)</span>) <em><strong>si se rechaza la hipótesis nula</strong></em> en cualquiera de los rezagos para los <em><strong>valores no diferenciados</strong></em> del <code class="docutils literal notranslate"><span class="pre">DJIA</span> <span class="pre">Close</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">p_val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pvalues_djia</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">p_val</span> <span class="o">&gt;</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Null hypothesis is accepted at lag = </span><span class="si">{}</span><span class="s1"> for p-val = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p_val</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Null hypothesis is rejected at lag = </span><span class="si">{}</span><span class="s1"> for p-val = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p_val</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Null hypothesis is rejected at lag = 0 for p-val = 2.857506276385174e-55
Null hypothesis is rejected at lag = 1 for p-val = 1.7871763971271254e-105
Null hypothesis is rejected at lag = 2 for p-val = 9.927155881909959e-154
Null hypothesis is rejected at lag = 3 for p-val = 8.084096278834598e-200
Null hypothesis is rejected at lag = 4 for p-val = 9.125287802249553e-244
Null hypothesis is rejected at lag = 5 for p-val = 1.0907828815951678e-285
Null hypothesis is rejected at lag = 6 for p-val = 0.0
Null hypothesis is rejected at lag = 7 for p-val = 0.0
Null hypothesis is rejected at lag = 8 for p-val = 0.0
Null hypothesis is rejected at lag = 9 for p-val = 0.0
Null hypothesis is rejected at lag = 10 for p-val = 0.0
Null hypothesis is rejected at lag = 11 for p-val = 0.0
Null hypothesis is rejected at lag = 12 for p-val = 0.0
Null hypothesis is rejected at lag = 13 for p-val = 0.0
Null hypothesis is rejected at lag = 14 for p-val = 0.0
Null hypothesis is rejected at lag = 15 for p-val = 0.0
Null hypothesis is rejected at lag = 16 for p-val = 0.0
Null hypothesis is rejected at lag = 17 for p-val = 0.0
Null hypothesis is rejected at lag = 18 for p-val = 0.0
Null hypothesis is rejected at lag = 19 for p-val = 0.0
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Obtengamos los <em><strong>intervalos de confianza, los estadísticos</strong></em> <span class="math notranslate nohighlight">\(Q\)</span> <em><strong>de Ljung-Box y los valores</strong></em> <span class="math notranslate nohighlight">\(p\)</span> para los <em><strong>valores diferenciados</strong></em> del <code class="docutils literal notranslate"><span class="pre">DJIA</span> <span class="pre">Close</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">acf_first_diff</span><span class="p">,</span> <span class="n">confint_first_diff</span><span class="p">,</span>\
<span class="n">qstat_first_diff</span><span class="p">,</span> <span class="n">pvalues_first_diff</span> <span class="o">=</span> <span class="n">stattools</span><span class="o">.</span><span class="n">acf</span><span class="p">(</span><span class="n">first_order_diff</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
                                                     <span class="n">nlags</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                                                     <span class="n">qstat</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                     <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Comprobemos si con un <em><strong>nivel de confianza del 95%</strong></em> (<span class="math notranslate nohighlight">\(\alpha = 0.05\)</span>) <em><strong>si se rechaza la hipótesis nula</strong></em> en cualquiera de los rezagos</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">p_val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pvalues_first_diff</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">p_val</span> <span class="o">&gt;</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Null hypothesis is accepted at lag = </span><span class="si">{}</span><span class="s1"> for p-val = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p_val</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Null hypothesis is rejected at lag = </span><span class="si">{}</span><span class="s1"> for p-val = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p_val</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Null hypothesis is accepted at lag = 0 for p-val = 0.17742519268365267
Null hypothesis is accepted at lag = 1 for p-val = 0.35711074717194824
Null hypothesis is accepted at lag = 2 for p-val = 0.5569664476694898
Null hypothesis is accepted at lag = 3 for p-val = 0.7025937592112144
Null hypothesis is accepted at lag = 4 for p-val = 0.7937258941281413
Null hypothesis is accepted at lag = 5 for p-val = 0.880645293990265
Null hypothesis is accepted at lag = 6 for p-val = 0.9058055508095895
Null hypothesis is accepted at lag = 7 for p-val = 0.9461503874902826
Null hypothesis is accepted at lag = 8 for p-val = 0.9529107001186853
Null hypothesis is accepted at lag = 9 for p-val = 0.9452880323047996
Null hypothesis is accepted at lag = 10 for p-val = 0.9103701842715781
Null hypothesis is accepted at lag = 11 for p-val = 0.9303312940619602
Null hypothesis is accepted at lag = 12 for p-val = 0.9412519715905938
Null hypothesis is accepted at lag = 13 for p-val = 0.9498882104867831
Null hypothesis is accepted at lag = 14 for p-val = 0.9556341186857322
Null hypothesis is accepted at lag = 15 for p-val = 0.9708115886391275
Null hypothesis is accepted at lag = 16 for p-val = 0.9617513839353877
Null hypothesis is accepted at lag = 17 for p-val = 0.8766266334022736
Null hypothesis is accepted at lag = 18 for p-val = 0.7968569568190992
Null hypothesis is accepted at lag = 19 for p-val = 0.7023038219602964
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Examinaremos ahora la serie temporal de las <em><strong>temperaturas medias diarias del río Fisher</strong></em> para demostrar el efecto de la <em><strong>diferenciación estacional</strong></em>. La <em><strong>serie original y la media mensual muestran un comportamiento estacional</strong></em> evidente.</p></li>
<li><p>Se calcula la <em><strong>autocorrelación de la media mensual</strong></em> y se traza utilizando la función <code class="docutils literal notranslate"><span class="pre">autocorrelation_plot</span></code> de <code class="docutils literal notranslate"><span class="pre">pandas.plotting</span></code>. Esta función es útil para <em><strong>identificar la autocorrelación significativa en una serie temporal y muestra intervalos de confianza del 95% y 99%</strong></em>. La <em><strong>ACF de las temperaturas medias mensuales oscila dentro y fuera de los intervalos de confianza del 99%</strong></em>, indicando que la serie no es estacionaria debido a la estacionalidad.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">daily_temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;/home/lihkir/Data/mean-daily-temperature-fisher-river.xlsx&#39;</span><span class="p">)</span>
<span class="n">daily_temp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Mean_Temperature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1988-01-01</td>
      <td>-23.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1988-01-02</td>
      <td>-20.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1988-01-03</td>
      <td>-22.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1988-01-04</td>
      <td>-30.5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1988-01-05</td>
      <td>-31.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Hacemos que la <em><strong>fecha formateada sea el índice de la fila</strong></em> del conjunto de datos y elimine la columna <code class="docutils literal notranslate"><span class="pre">Date</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">daily_temp</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">daily_temp</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">date</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">))</span>
<span class="n">daily_temp</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">daily_temp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Mean_Temperature</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1988-01-01</th>
      <td>-23.0</td>
    </tr>
    <tr>
      <th>1988-01-02</th>
      <td>-20.5</td>
    </tr>
    <tr>
      <th>1988-01-03</th>
      <td>-22.0</td>
    </tr>
    <tr>
      <th>1988-01-04</th>
      <td>-30.5</td>
    </tr>
    <tr>
      <th>1988-01-05</th>
      <td>-31.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Daily temperatures of Fisher River, TX, US&#39;</span><span class="p">);</span>
<span class="n">daily_temp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/09e0042ce4808a6a08cba3aa86d3b603c7d68989964bb4c95498a8a156a05faf.png" src="_images/09e0042ce4808a6a08cba3aa86d3b603c7d68989964bb4c95498a8a156a05faf.png" />
</div>
</div>
<ul class="simple">
<li><p>Calculamos la <em><strong>temperatura media mensual</strong></em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">montly_resample</span> <span class="o">=</span> <span class="n">daily_temp</span><span class="p">[</span><span class="s1">&#39;Mean_Temperature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="n">monthly_mean_temp</span> <span class="o">=</span> <span class="n">montly_resample</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Shape of monthly mean temperature dataset:&#39;</span><span class="p">,</span> <span class="n">monthly_mean_temp</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">monthly_mean_temp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape of monthly mean temperature dataset: (48,)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date
1988-01-31   -22.137097
1988-02-29   -19.025862
1988-03-31    -8.258065
1988-04-30     2.641667
1988-05-31    11.290323
Freq: ME, Name: Mean_Temperature, dtype: float64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Trazamos la <em><strong>temperatura media mensual</strong></em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Monthly mean temperatures of Fisher River, TX, US&#39;</span><span class="p">)</span>
<span class="n">monthly_mean_temp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/649298ea5781fd6b21fef3b663e4f34f4a394b8be76d5d45a1eb4d3f2a872ecc.png" src="_images/649298ea5781fd6b21fef3b663e4f34f4a394b8be76d5d45a1eb4d3f2a872ecc.png" />
</div>
</div>
<ul class="simple">
<li><p>Trazamos la <em><strong>ACF de la temperatura media mensual</strong></em> con <code class="docutils literal notranslate"><span class="pre">pandas.tools.plotting.autocorrelation_plot</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ACF of monthly mean temperatures of Fisher River, TX, US&#39;</span><span class="p">)</span>
<span class="n">autocorrelation_plot</span><span class="p">(</span><span class="n">monthly_mean_temp</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3a986504bfec19c7ba14a5245846bb7755cfd437b0d6046e6ed45de3abd95c11.png" src="_images/3a986504bfec19c7ba14a5245846bb7755cfd437b0d6046e6ed45de3abd95c11.png" />
</div>
</div>
<ul class="simple">
<li><p>Tomamos las <em><strong>diferencias estacionales con un periodo de 12 meses</strong></em> en las temperaturas medias mensuales. La diferenciación estacional <em><strong>deja valores nulos en sus primeros 12 elementos, que se eliminan antes del análisis</strong></em>:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seasonal_diff</span> <span class="o">=</span> <span class="n">monthly_mean_temp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="n">seasonal_diff</span> <span class="o">=</span> <span class="n">seasonal_diff</span><span class="p">[</span><span class="mi">12</span><span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Trazamos las diferencias estacionales. Las <em><strong>diferencias estacionales parecen ser variaciones aleatorias</strong></em>, como se muestra en la siguiente figura</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Seasonal differences&#39;</span><span class="p">);</span>
<span class="n">seasonal_diff</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4f352f516bc006c0e29da610d78f11ebfb21a01a4011d0ff03cb6aeb075fea9b.png" src="_images/4f352f516bc006c0e29da610d78f11ebfb21a01a4011d0ff03cb6aeb075fea9b.png" />
</div>
</div>
<ul class="simple">
<li><p>Trazamos las diferencias estacionales. Volvemos a utilizar la función <code class="docutils literal notranslate"><span class="pre">autocorrelation_plot</span></code> para generar la <code class="docutils literal notranslate"><span class="pre">ACF</span></code> de la serie diferenciada y los intervalos de confianza al 99% del nivel de confianza. Podemos ver en la siguiente figura que la <em><strong>ACF nunca cruza los intervalos de confianza del 99% para rezagos que varían de 0 a más de 35</strong></em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ACF of Seasonal differences&#39;</span><span class="p">);</span>
<span class="n">autocorrelation_plot</span><span class="p">(</span><span class="n">seasonal_diff</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/936d9c027b29bd63c487b0eac92b3740f8a6954c87916c601f9fff7a197bd212.png" src="_images/936d9c027b29bd63c487b0eac92b3740f8a6954c87916c601f9fff7a197bd212.png" />
</div>
</div>
<ul class="simple">
<li><p>Realizamos la <em><strong>prueba de Ljung-Box sobre la temperatura media mensual</strong></em> para obtener los valores <span class="math notranslate nohighlight">\(p\)</span>. Utilizaremos rezagos de hasta 10. Los valores <span class="math notranslate nohighlight">\(p\)</span> reales se confirman ejecutando la función <code class="docutils literal notranslate"><span class="pre">stattools.acf</span></code> en los <em><strong>datos medios mensuales</strong></em> de la siguiente manera</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">pval_monthly_mean</span> <span class="o">=</span> <span class="n">stattools</span><span class="o">.</span><span class="n">acf</span><span class="p">(</span><span class="n">monthly_mean_temp</span><span class="p">,</span>
                                           <span class="n">nlags</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                                           <span class="n">qstat</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                           <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Null hypothesis is rejected for lags:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pval_monthly_mean</span><span class="o">&lt;=</span><span class="mf">0.05</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Null hypothesis is rejected for lags: (array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]),)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>La prueba de <em><strong>Ljung-Box</strong></em> se realiza también con las <em><strong>series diferenciadas estacionalmente</strong></em>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">pval_seasonal_diff</span> <span class="o">=</span> <span class="n">stattools</span><span class="o">.</span><span class="n">acf</span><span class="p">(</span><span class="n">seasonal_diff</span><span class="p">,</span>
                                            <span class="n">nlags</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                                            <span class="n">qstat</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Null hypothesis is rejected for lags:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pval_seasonal_diff</span><span class="o">&lt;=</span><span class="mf">0.05</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Null hypothesis is rejected for lags: (array([], dtype=int64),)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><em><strong>No hay rezagos para los que se rechace la hipótesis nula</strong></em> de la prueba de Ljung-Box. La elección de una estrategia de diferenciación puede determinarse mediante un análisis exploratorio de los datos como los descritos hasta ahora. Sin embargo, <em><strong>cuando es difícil determinar qué transformaciones son necesarias para estacionar una serie de tiempo, se realiza la prueba ADF para una orientación</strong></em></p></li>
</ul>
</section>
<section id="prueba-de-dickey-fuller">
<h2><span class="section-number">1.29. </span>Prueba de Dickey-Fuller<a class="headerlink" href="#prueba-de-dickey-fuller" title="Link to this heading">#</a></h2>
<ul>
<li><p>Dada serie temporal generada por un proceso con una estructura <em><strong>Autorregresiva de Primer Orden, AR(1)</strong></em>, también conocida como proceso de primer orden de Markov, y es ampliamente utilizada en diversas disciplinas</p>
<div class="math notranslate nohighlight" id="equation-ar1-dickey-fuller">
<span class="eqno">(1.4)<a class="headerlink" href="#equation-ar1-dickey-fuller" title="Link to this equation">#</a></span>\[
  y_{t}=\phi y_{t-1}+\varepsilon_{t},
  \]</div>
<p>donde <span class="math notranslate nohighlight">\(\phi\)</span> es un término de perturbación estacionario o <em><strong>coeficiente de autocorrelación</strong></em>, y <span class="math notranslate nohighlight">\(\varepsilon_{t}\)</span> es una <em><strong>variable aleatoria estacionaria e independiente</strong></em>.</p>
</li>
</ul>
<ul class="simple">
<li><p>Si <span class="math notranslate nohighlight">\(\phi=1\)</span>, la <em><strong>ecuación característica del proceso</strong></em> tiene una raíz unitaria, lo que <em><strong>indica que el proceso es no estacionario</strong></em>. Mientras <span class="math notranslate nohighlight">\(\varepsilon_{t}\)</span> sea estacionario, las primeras diferencias de <span class="math notranslate nohighlight">\(y_{t}\)</span> son estacionarias. La serie <span class="math notranslate nohighlight">\(y_{t}\)</span> es de <em><strong>integración de primer orden</strong></em>. Si <span class="math notranslate nohighlight">\(\phi&lt;1\)</span>, la serie temporal <span class="math notranslate nohighlight">\(\phi_{t}\)</span> <em><strong>es estacionaria</strong></em> en el sentido de que es una <em><strong>integración de orden cero</strong></em>.</p></li>
</ul>
<ul>
<li><p>La prueba de DF <span id="id3">[<a class="reference internal" href="biblio.html#id22" title="David A Dickey and Wayne A Fuller. Distribution of the estimators for autoregressive time series with a unit root. Journal of the American statistical association, 74(366a):427–431, 1979.">Dickey and Fuller, 1979</a>]</span> consiste en la <em><strong>hipótesis nula de que en un modelo, representado por la</strong></em> Ecuación <a class="reference internal" href="#equation-ar1-dickey-fuller">(1.4)</a> para <span class="math notranslate nohighlight">\(\delta=\phi-1\)</span> como sigue</p>
<div class="math notranslate nohighlight">
\[
  \Delta y_{t}=\delta y_{t-1}+\varepsilon_{t}.
  \]</div>
</li>
<li><p>En el caso de <span class="math notranslate nohighlight">\(\delta=0\)</span>, la serie temporal <span class="math notranslate nohighlight">\(y_{t}\)</span> es un <em><strong>proceso browniano con acumulación de choques aleatorios</strong></em>. La <em><strong>hipótesis alternativa</strong></em> <span class="math notranslate nohighlight">\(\delta&lt;0\)</span> <em><strong>implica que la variable es estacionaria</strong></em>. El <em><strong>estadístico de prueba</strong></em> se calcula como <span class="math notranslate nohighlight">\(t=\hat{\delta}/\hat{\sigma}_{\delta}\)</span>, <em><strong>similar al estadístico</strong></em> <span class="math notranslate nohighlight">\(t\)</span> de Student, pero, con una <em><strong>distribución de probabilidad diferente</strong></em>. Para tomar una <em><strong>decisión, se necesita un valor crítico en un nivel de significancia elegido</strong></em>.</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>Si el <em><strong>estadístico de prueba supera un valor crítico</strong></em>, entonces <em><strong>no se puede rechazar la hipótesis nula sobre la presencia de una raíz unitaria en una serie</strong></em>. Sin embargo, <em><strong>si el estadístico de prueba es menor que el valor crítico, entonces se rechaza la hipótesis nula a favor de la estacionariedad</strong></em> de la serie temporal.</p></li>
</ul>
</div>
<ul class="simple">
<li><p>Apliquemos la <em><strong>prueba ADF para verificar la estacionariedad en los datos mensuales de millas de avión de US Airlines</strong></em> recogidos entre 1963 y 1970. Utilizaremos la función <code class="docutils literal notranslate"><span class="pre">adfuller</span></code> de la <code class="docutils literal notranslate"><span class="pre">API</span></code> <code class="docutils literal notranslate"><span class="pre">statsmodels.tsa.stattools</span></code> para realizar las pruebas</p></li>
<li><p>Antes de ejecutar la prueba <code class="docutils literal notranslate"><span class="pre">ADF</span></code>, la serie de tiempo se carga en un <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> y como se muestra en la siguiente figura, es <em><strong>evidente que la serie temporal tiene una tendencia alcista, así como estacionalidad</strong></em> y, por lo tanto, <em><strong>no es estacionaria</strong></em>, lo que se <em><strong>verificará mediante la prueba ADF</strong></em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">air_miles</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/home/lihkir/Data/us-airlines-monthly-aircraft-miles-flown.csv&#39;</span><span class="p">)</span>
<span class="n">air_miles</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">air_miles</span><span class="o">.</span><span class="n">Month</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Shape of the DataFrame:&#39;</span><span class="p">,</span> <span class="n">air_miles</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">air_miles</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape of the DataFrame: (97, 2)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Month</th>
      <th>U.S. airlines: monthly aircraft miles flown (Millions) 1963 -1970</th>
    </tr>
    <tr>
      <th>Month</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1963-01</th>
      <td>1963-01</td>
      <td>6827.0</td>
    </tr>
    <tr>
      <th>1963-02</th>
      <td>1963-02</td>
      <td>6178.0</td>
    </tr>
    <tr>
      <th>1963-03</th>
      <td>1963-03</td>
      <td>7084.0</td>
    </tr>
    <tr>
      <th>1963-04</th>
      <td>1963-04</td>
      <td>8162.0</td>
    </tr>
    <tr>
      <th>1963-05</th>
      <td>1963-05</td>
      <td>8462.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Cambiemos el nombre de la segunda columna</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">air_miles</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;U.S. airlines: monthly aircraft miles flown (Millions) 1963 -1970&#39;</span><span class="p">:</span>\
                          <span class="s1">&#39;Air miles flown&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Comprobamos si existen datos faltantes y eliminamos la fila correspondiente</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">air_miles</span><span class="p">[</span><span class="s1">&#39;Air miles flown&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of missing values found:&#39;</span><span class="p">,</span> <span class="n">missing</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">air_miles</span> <span class="o">=</span> <span class="n">air_miles</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">missing</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of missing values found: 1
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Trazamos la serie temporal de millas aéreas voladas</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">air_miles</span><span class="p">[</span><span class="s1">&#39;Air miles flown&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Monthly air miles flown during 1963 - 1970&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Monthly air miles flown during 1963 - 1970&#39;)
</pre></div>
</div>
<img alt="_images/1232a562f91c8cbf74a557cfaa78dcaae991eea99bd79cdb674f9ee3719bdca9.png" src="_images/1232a562f91c8cbf74a557cfaa78dcaae991eea99bd79cdb674f9ee3719bdca9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adf_result</span> <span class="o">=</span> <span class="n">stattools</span><span class="o">.</span><span class="n">adfuller</span><span class="p">(</span><span class="n">air_miles</span><span class="p">[</span><span class="s1">&#39;Air miles flown&#39;</span><span class="p">],</span> <span class="n">autolag</span><span class="o">=</span><span class="s1">&#39;AIC&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-val of the ADF test in air miles flown:&#39;</span><span class="p">,</span> <span class="n">adf_result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p-val of the ADF test in air miles flown: 0.9945022811234028
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>El <em><strong>argumento</strong></em> <code class="docutils literal notranslate"><span class="pre">autolag='AIC'</span></code> <em><strong>indica a la función que elija un número adecuado de rezagos</strong></em> para la prueba, <em><strong>maximizando el criterio de información de Akaike (AIC)</strong></em>. Esto <em><strong>evita la necesidad de especificar manualmente el número de rezagos y reduce el proceso de prueba y error</strong></em>.</p></li>
<li><p>El <span class="math notranslate nohighlight">\(p\)</span>-value de la prueba ADF es 0.9945, lo que <em><strong>confirma nuestros hallazgos del análisis exploratorio de datos</strong></em>. La función <code class="docutils literal notranslate"><span class="pre">adfuller</span></code> devuelve varios valores en una tupla. Hemos almacenado los resultados en la variable <code class="docutils literal notranslate"><span class="pre">adf_resultado</span></code> y accedido al segundo elemento <code class="docutils literal notranslate"><span class="pre">adf_result[1]</span></code> <em><strong>para obtener el</strong></em> <span class="math notranslate nohighlight">\(p\)</span><em><strong>-value de la prueba</strong></em>. También se proporcionan otros datos interesantes, como el número de <em><strong>rezagos utilizados</strong></em> (<code class="docutils literal notranslate"><span class="pre">usedlag</span></code>) y los <em><strong>valores críticos del estadístico de prueba</strong></em> para diferentes niveles de confianza.</p></li>
</ul>
</section>
<section id="descomposicion-de-series-temporales">
<h2><span class="section-number">1.30. </span>Descomposición de series temporales<a class="headerlink" href="#descomposicion-de-series-temporales" title="Link to this heading">#</a></h2>
<ul>
<li><p>También existe un <em><strong>enfoque “clásico” para la descomposición de una serie de tiempo en componentes de tendencia y estacionales</strong></em> (de hecho, hay muchos algoritmos de descomposición diferentes; aquí explicamos un enfoque muy simple pero útil). El modelo matemático general para esta descomposición es</p>
<div class="math notranslate nohighlight">
\[
  y_{t}=f(S_{t}, T_{t}, \varepsilon_{t})
  \]</div>
<p>donde <span class="math notranslate nohighlight">\(S_{t}\)</span> es el <em><strong>componente estacional</strong></em>, <span class="math notranslate nohighlight">\(T_{t}\)</span> es el <em><strong>efecto de la tendencia</strong></em> y <span class="math notranslate nohighlight">\(\varepsilon_{t}\)</span> es el <em><strong>componente de error aleatorio</strong></em>. Normalmente, hay dos formas para la función <span class="math notranslate nohighlight">\(f\)</span>: un <em><strong>modelo aditivo</strong></em></p>
<div class="math notranslate nohighlight">
\[
  y_{t}=S_{t}+T_{t}+\varepsilon_{t}
  \]</div>
<p>y un <em><strong>modelo multiplicativo</strong></em></p>
<div class="math notranslate nohighlight">
\[
  y_{t}=S_{t}T_{t}\varepsilon_{t}.
  \]</div>
</li>
</ul>
<ul class="simple">
<li><p>El <em><strong>modelo aditivo es apropiado si la magnitud (amplitud) de la variación estacional no varía con el nivel de la serie</strong></em>, mientras que la <em><strong>versión multiplicativa es más apropiada si la amplitud de las fluctuaciones estacionales aumenta o disminuye con el nivel promedio de la serie</strong></em> temporal.</p></li>
<li><p>La descomposición es <em><strong>útil para desglosar una serie temporal en estas partes componentes</strong></em>. Para el modelo aditivo, es relativamente fácil. <em><strong>Primero, modelaríamos y eliminaríamos la tendencia</strong></em>. Se podría utilizar un modelo lineal simple para hacer esto, por ejemplo,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
T_{t}=\beta_{0}+\beta_{1}t.
\]</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>Otros métodos también podrían ser utilizados. <em><strong>Los promedios móviles pueden ser utilizados para aislar una tendencia y eliminarla de los datos originales</strong></em>, al igual que <em><strong>métodos de regresión más sofisticados</strong></em>. Estas técnicas podrían ser apropiadas <em><strong>cuando la tendencia no es una línea recta a lo largo de la historia de la serie temporal</strong></em>. También se podría usar la diferenciación, aunque típicamente no se usa en el enfoque de descomposición clásico.</p></li>
</ul>
</div>
<ul>
<li><p>Una vez <em><strong>estimado el componente de tendencia</strong></em> o ciclo de tendencia, la serie sin tendencia es</p>
<div class="math notranslate nohighlight">
\[
  y_{t}-T_{t}=S_{t}+\varepsilon_{t}.
  \]</div>
</li>
</ul>
<ul>
<li><p>Se calculan factores estacionales para cada período, como los meses, tomando un <em><strong>promedio de los efectos estacionales para cada período</strong></em>. Esto proporciona índices estacionales que representan la variación estacional para cada período. En la <em><strong>descomposición multiplicativa</strong></em>, se utilizan ratios para <em><strong>remover tendencia</strong></em></p>
<div class="math notranslate nohighlight">
\[
  \frac{y_{t}}{T_{t}}=S_{t}\varepsilon_{t}.
  \]</div>
</li>
<li><p>Los <em><strong>índices estacionales</strong></em> se calculan tomando el promedio de todos los valores sin tendencia para cada período en la temporada.</p></li>
</ul>
<ul class="simple">
<li><p>En esta sección, discutiremos los siguientes dos métodos populares para <em><strong>estimar la tendencia y los componentes estacionales</strong></em>:</p>
<ul>
<li><p>Método de <em><strong>medias móviles</strong></em></p></li>
<li><p><em><strong>Descomposición estacional</strong></em> y de <em><strong>tendencia</strong></em> mediante la librería <code class="docutils literal notranslate"><span class="pre">Python</span> <span class="pre">statsmodels.tsa</span></code></p></li>
</ul>
</li>
</ul>
</section>
<section id="medias-moviles-y-efectos-de-suavizacion">
<h2><span class="section-number">1.31. </span>Medias móviles y efectos de suavización<a class="headerlink" href="#medias-moviles-y-efectos-de-suavizacion" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Las <em><strong>medias móviles (MA)</strong></em> en un índice temporal <span class="math notranslate nohighlight">\(t\)</span> <em><strong>estiman el componente de ciclo de tendencia media</strong></em> <span class="math notranslate nohighlight">\(M_{t}\)</span> y se calcula sacando la <em><strong>media a lo largo del periodo de tiempo</strong></em> <span class="math notranslate nohighlight">\(t\pm k\)</span>, donde <span class="math notranslate nohighlight">\(k\)</span> es el rango de la <strong>MA</strong></p></li>
</ul>
<div class="math notranslate nohighlight">
\[\widehat{M}_{t}=\frac{y_{t-k}+y_{t-k+1}+\cdots+y_{t}+\cdots+y_{t+k-1}+y_{t+k}}{2k+1}\]</div>
<ul class="simple">
<li><p>La toma de <em><strong>medias móviles tiene el efecto de suavizar la serie temporal original eliminando el ruido aleatorio</strong></em>. Comúnmente, el número total de observaciones <span class="math notranslate nohighlight">\(m = 2k + 1\)</span> se utiliza para describir la media móvil como <strong>MA</strong> de orden <span class="math notranslate nohighlight">\(m\)</span>, que en adelante se denotará como <span class="math notranslate nohighlight">\(\widehat{M}_{t}^{(m)}\)</span>.</p></li>
</ul>
<ul class="simple">
<li><p>El análisis de las medias móviles se ilustra utilizando el <em><strong>ejemplo de las cotizaciones de acciones de IBM de 1962 a 1965</strong></em>. La serie temporal original, representada en azul en el gráfico, <em><strong>muestra movimientos irregulares debido al ruido aleatorio</strong></em>. Por otro lado, <em><strong>la media móvil (MA) de 5 días</strong></em>, en rojo, <em><strong>es más suave que la serie original</strong></em> y ofrece una <em><strong>estimación del patrón de tendencia-ciclo</strong></em>. Se observa un efecto de suavización en la serie temporal original debido a la MA de 5 días, como se muestra en el gráfico.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Cargamos el conjunto de datos en un <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ibm_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/home/lihkir/Data/ibm-common-stock-closing-prices.csv&#39;</span><span class="p">)</span>
<span class="n">ibm_df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">ibm_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Shape of the dataframe:&#39;</span><span class="p">,</span> <span class="n">ibm_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">ibm_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape of the dataframe: (1009, 2)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>IBM common stock closing prices</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1962-01-02</th>
      <td>1962-01-02</td>
      <td>572.00</td>
    </tr>
    <tr>
      <th>1962-01-03</th>
      <td>1962-01-03</td>
      <td>577.00</td>
    </tr>
    <tr>
      <th>1962-01-04</th>
      <td>1962-01-04</td>
      <td>571.25</td>
    </tr>
    <tr>
      <th>1962-01-05</th>
      <td>1962-01-05</td>
      <td>560.00</td>
    </tr>
    <tr>
      <th>1962-01-08</th>
      <td>1962-01-08</td>
      <td>549.50</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Renombramos la <em>segunda columna</em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ibm_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;IBM common stock closing prices&#39;</span><span class="p">:</span> <span class="s1">&#39;Close_Price&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ibm_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Close_Price</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1962-01-02</th>
      <td>1962-01-02</td>
      <td>572.00</td>
    </tr>
    <tr>
      <th>1962-01-03</th>
      <td>1962-01-03</td>
      <td>577.00</td>
    </tr>
    <tr>
      <th>1962-01-04</th>
      <td>1962-01-04</td>
      <td>571.25</td>
    </tr>
    <tr>
      <th>1962-01-05</th>
      <td>1962-01-05</td>
      <td>560.00</td>
    </tr>
    <tr>
      <th>1962-01-08</th>
      <td>1962-01-08</td>
      <td>549.50</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Eliminamos <em>datos faltantes</em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">ibm_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">ibm_df</span><span class="p">[</span><span class="s1">&#39;Close_Price&#39;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No. of rows with missing values:&#39;</span><span class="p">,</span> <span class="n">missing</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">ibm_df</span> <span class="o">=</span> <span class="n">ibm_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">missing</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No. of rows with missing values: 0
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Para ilustrar la idea de la media móvil, <em><strong>calculamos una media móvil semanal tomando una ventana de 5 días en lugar de 7</strong></em>, ya que el <em><strong>trading se produce solo durante los días laborables</strong></em>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ibm_df</span><span class="p">[</span><span class="s1">&#39;5-Day Moving Avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ibm_df</span><span class="p">[</span><span class="s1">&#39;Close_Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ibm_df</span><span class="p">[</span><span class="s1">&#39;Close_Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;IBM Common Stock Close Prices during 1962-1965&#39;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ibm_df</span><span class="p">[</span><span class="s1">&#39;5-Day Moving Avg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;5-day Moving Average&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ce682678387de57b5d8e3211fae56cffb92024d36e0d9f74e6f51394665a641b.png" src="_images/ce682678387de57b5d8e3211fae56cffb92024d36e0d9f74e6f51394665a641b.png" />
</div>
</div>
<ul>
<li><p>La mencionada <strong>MA</strong> de orden impar <span class="math notranslate nohighlight">\(m = 2\times2 + 1 = 5\)</span> y es <em><strong>simétrica con igual número de observaciones a ambos lados del índice de tiempo</strong></em> <span class="math notranslate nohighlight">\(t\)</span> en el que se calcula la <strong>MA</strong>. Sin embargo, es posible tener una <em><strong>MA asimétrica de orden par</strong></em> <span class="math notranslate nohighlight">\(m = 2k\)</span>.</p></li>
<li><p>La <em><strong>asimetría de un promedio móvil de orden par</strong></em> puede ser <em><strong>eliminada tomando un segundo promedio móvil de igual orden</strong></em>. Ilustremos esto considerando el primer promedio móvil de orden dos y calculado como</p>
<div class="math notranslate nohighlight">
\[
  \widehat{M}_{t}^{(2)}=\frac{y_{t-1}+y_{t}}{2}
  \]</div>
</li>
<li><p>Otro <em><strong>promedio móvil de segundo orden</strong></em>, cuando es <em><strong>aplicado a la serie</strong></em> <span class="math notranslate nohighlight">\(\widehat{M}_{t}^{(2)}\)</span>, <em><strong>producirá un promedio móvil final simétrico</strong></em> que tiene una observación a cada lado de la observación de la serie temporal original en el índice <span class="math notranslate nohighlight">\(t\)</span></p>
<div class="math notranslate nohighlight">
\[
  \overline{\widehat{M}_{t}^{(2)}}^{(t, t+1)}=\frac{\widehat{M}_{t}^{(2)}+\widehat{M}_{t+1}^{(2)}}{2}=\frac{1}{2}\left(\frac{y_{t-1}+y_{t}}{2}+\frac{y_{t}+y_{t+1}}{2}\right)=\frac{1}{4}y_{t-1}+\frac{1}{2}y_{t}+\frac{1}{4}y_{t+1}.
  \]</div>
</li>
</ul>
<ul>
<li><p>Análogamente, dada la MA <span class="math notranslate nohighlight">\(\widehat{M}_{t}^{(3)}=(y_{t-1}+y_{t}+y_{t+1})/3\)</span>, se tiene que (<code class="docutils literal notranslate"><span class="pre">verifíquelo</span></code>)</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  \begin{align*}
  \overline{\widehat{M}_{t}^{(3)}}^{(t-1, t+1)} &amp;= \frac{\widehat{M}_{t-1}^{(3)}+\widehat{M}_{t}^{(3)}+\widehat{M}_{t+1}^{(3)}}{3}=\frac{1}{9}y_{t-2}+\frac{2}{9}y_{t-1}+y_{t}+\frac{2}{9}y_{t+1}+\frac{1}{9}y_{t+2}\\
  \overline{\widehat{M}_{t}^{(3)}}^{(t, t+1)} &amp;= \frac{\widehat{M}_{t}^{(3)}+\widehat{M}_{t+1}^{(3)}}{2}=\frac{1}{6}y_{t-1}+\frac{1}{3}y_{t}+\frac{1}{3}y_{t+1}+\frac{1}{6}y_{t+2}.
  \end{align*}
  \end{split}\]</div>
</li>
</ul>
<ul class="simple">
<li><p>El gráfico que se presenta aquí muestra <em><strong>seis medias móviles</strong></em>, a saber <span class="math notranslate nohighlight">\(\widehat{M}_{t}^{(2)}\)</span>, <span class="math notranslate nohighlight">\(\overline{\widehat{M}_{t}^{(2)}}^{(t,t+1)}\)</span>, <span class="math notranslate nohighlight">\(\widehat{M}_{t}^{(4)}\)</span>, <span class="math notranslate nohighlight">\(\overline{\widehat{M}_{t}^{(4)}}^{(t,t+1)}\)</span>, <span class="math notranslate nohighlight">\(\widehat{M}_{t}^{(3)}\)</span> y <span class="math notranslate nohighlight">\(\overline{\widehat{M}_{t}^{(3)}}^{(t-1,t+1)}\)</span> para los precios de las <em><strong>acciones de IBM hasta los primeros 45 días</strong></em>. Como se ilustra, la suavidad de los <strong>MA</strong> resultantes <em><strong>mejora con el aumento del orden</strong></em> <span class="math notranslate nohighlight">\(m\)</span> y el número de repeticiones <span class="math notranslate nohighlight">\(n\)</span>.</p></li>
<li><p>En la siguiente figura, las <strong>MA</strong> de tipo <span class="math notranslate nohighlight">\(\widehat{M}_{t}^{(m)}\)</span> <em><strong>se indican con líneas continuas</strong></em>, mientras que las del tipo <span class="math notranslate nohighlight">\(\overline{\widehat{M}_{t}^{(m)}}^{(t-i, t+j)}, i,j\in\{0, 1, 2,\dots\}\)</span> <em><strong>se representan con líneas discontinuas</strong></em>. Para generar las seis <strong>MA</strong> mencionadas hemos utilizado ampliamente las funciones <code class="docutils literal notranslate"><span class="pre">rolling</span></code> y <code class="docutils literal notranslate"><span class="pre">mean</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MA2</span> <span class="o">=</span> <span class="n">ibm_df</span><span class="p">[</span><span class="s1">&#39;Close_Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">TwoXMA2</span> <span class="o">=</span> <span class="n">MA2</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">MA4</span> <span class="o">=</span> <span class="n">ibm_df</span><span class="p">[</span><span class="s1">&#39;Close_Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">TwoXMA4</span> <span class="o">=</span> <span class="n">MA4</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">MA3</span> <span class="o">=</span> <span class="n">ibm_df</span><span class="p">[</span><span class="s1">&#39;Close_Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">ThreeXMA3</span> <span class="o">=</span> <span class="n">MA3</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><em><strong>Eliminemos los valores</strong></em> <code class="docutils literal notranslate"><span class="pre">NaN</span></code> de las variables anteriores</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TwoXMA2</span> <span class="o">=</span> <span class="n">MA2</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">TwoXMA4</span> <span class="o">=</span> <span class="n">MA4</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">ThreeXMA3</span> <span class="o">=</span> <span class="n">MA3</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">)</span>

<span class="n">ibm_df</span><span class="p">[</span><span class="s1">&#39;Close_Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">45</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">MA2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">45</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">TwoXMA2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">45</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;2 day MA &amp; 2X2 day MA&#39;</span><span class="p">);</span>

<span class="n">ibm_df</span><span class="p">[</span><span class="s1">&#39;Close_Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">45</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">MA4</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">45</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">TwoXMA4</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">45</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;4 day MA &amp; 2X4 day MA&#39;</span><span class="p">);</span>

<span class="n">ibm_df</span><span class="p">[</span><span class="s1">&#39;Close_Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">45</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">MA3</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">45</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ThreeXMA3</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">45</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;3 day MA &amp; 3X 3day MA&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/842464fac2edf2037422ea213e587dbddbdf7ff271f730161e76b79798d32f40.png" src="_images/842464fac2edf2037422ea213e587dbddbdf7ff271f730161e76b79798d32f40.png" />
</div>
</div>
</section>
<section id="ajuste-estacional-mediante-media-movil">
<h2><span class="section-number">1.32. </span>Ajuste estacional mediante media móvil<a class="headerlink" href="#ajuste-estacional-mediante-media-movil" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>La propiedad de <em><strong>media ponderada</strong></em> de las <span class="math notranslate nohighlight">\(\overline{\widehat{M}_{t}^{(m)}}^{(t-i, t+j)}\hspace{-6mm},i,j\in\{0,1,2,\dots\}\)</span> <em><strong>medias móviles</strong></em> tiene aplicación en <em><strong>suavizar datos con estacionalidad para generar estimaciones de ciclos de tendencia</strong></em>. Por ejemplo, dadas las <em><strong>observaciones trimestrales</strong></em> podemos aplicar la <strong>MA</strong>: <span class="math notranslate nohighlight">\(\overline{\widehat{M}_{t}^{(4)}}^{(t, t+1)}\)</span> para suavizar los datos.</p></li>
<li><p>El enfoque de utilizar <strong>MA</strong> ponderado de la forma <span class="math notranslate nohighlight">\(\overline{\widehat{M}_{t}^{(4)}}^{(t, t+1)}\)</span> se ilustra utilizando los datos de <em><strong>producción de cerveza de Australia</strong></em>. La serie temporal representa la <em><strong>producción trimestral de cerveza desde marzo de 1956 a junio de 1994</strong></em>. La serie temporal original y una serie de <strong>MA</strong> <span class="math notranslate nohighlight">\(\overline{\widehat{M}_{t}^{(4)}}^{(t, t+1)}\)</span> son dibujadas.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">beer_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/home/lihkir/Data/quarterly-beer-production-in-aus-March 1956-June 1994.csv&#39;</span><span class="p">)</span>
<span class="n">beer_df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">beer_df</span><span class="p">[</span><span class="s1">&#39;Quarter&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Shape of the dataframe:&#39;</span><span class="p">,</span> <span class="n">beer_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">beer_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape of the dataframe: (154, 2)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Quarter</th>
      <th>Quarterly beer production in Australia: megalitres. March 1956 ? June 1994</th>
    </tr>
    <tr>
      <th>Quarter</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1956Q1</th>
      <td>1956Q1</td>
      <td>284.4</td>
    </tr>
    <tr>
      <th>1956Q2</th>
      <td>1956Q2</td>
      <td>212.8</td>
    </tr>
    <tr>
      <th>1956Q3</th>
      <td>1956Q3</td>
      <td>226.9</td>
    </tr>
    <tr>
      <th>1956Q4</th>
      <td>1956Q4</td>
      <td>308.4</td>
    </tr>
    <tr>
      <th>1957Q1</th>
      <td>1957Q1</td>
      <td>262.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Renombramos la segunda columna del <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">beer_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Quarterly beer production in Australia: megalitres. March 1956 ? June 1994&#39;</span><span class="p">:</span><span class="s1">&#39;Beer_Prod&#39;</span><span class="p">},</span>
               <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Eliminamos datos faltantes <code class="docutils literal notranslate"><span class="pre">NaNs</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">beer_df</span><span class="p">[</span><span class="s1">&#39;Quarter&#39;</span><span class="p">]))</span> <span class="o">|</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">beer_df</span><span class="p">[</span><span class="s1">&#39;Beer_Prod&#39;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of rows with at least one missing values:&#39;</span><span class="p">,</span> <span class="n">missing</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">beer_df</span> <span class="o">=</span> <span class="n">beer_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">missing</span><span class="p">,</span> <span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Shape after removing missing values:&#39;</span><span class="p">,</span> <span class="n">beer_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of rows with at least one missing values: 0
Shape after removing missing values: (154, 2)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Para eliminar los patrones estacionales, calculemos la <em><strong>media móvil trimestral</strong></em> <span class="math notranslate nohighlight">\(\overline{\widehat{M}_{t}^{(4)}}^{(t, t+1)}\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MA4</span> <span class="o">=</span> <span class="n">beer_df</span><span class="p">[</span><span class="s1">&#39;Beer_Prod&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">TwoXMA4</span> <span class="o">=</span> <span class="n">MA4</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">TwoXMA4</span> <span class="o">=</span> <span class="n">TwoXMA4</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">TwoXMA4</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Trazamos la serie temporal original y las medias móviles estacionales</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">beer_df</span><span class="p">[</span><span class="s1">&#39;Beer_Prod&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">TwoXMA4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">60</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Quaterly Beer Production between in Australia and 2X4 quarter MA&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f3d35e587727007821fd359fb942a86de0d2ad0968c28f8b491e753aa6b86214.png" src="_images/f3d35e587727007821fd359fb942a86de0d2ad0968c28f8b491e753aa6b86214.png" />
</div>
</div>
<ul class="simple">
<li><p>La serie de <em><strong>producción trimestral de cerveza</strong></em> muestra tanto <em><strong>tendencia como estacionalidad</strong></em>, lo que la hace <em><strong>no estacionaria</strong></em>. Para abordar esto, <em><strong>primero eliminamos el componente de tendencia y luego consideramos las diferencias estacionales</strong></em>. Los residuos resultantes después de eliminar la tendencia se muestran en la siguiente figura.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">residuals</span> <span class="o">=</span> <span class="n">beer_df</span><span class="p">[</span><span class="s1">&#39;Beer_Prod&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">TwoXMA4</span>
<span class="n">residuals</span> <span class="o">=</span> <span class="n">residuals</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">residuals</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">residuals</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">60</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Residuals in Quaterly Beer Production time series&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c9628026faa354714a0ea8916a914db7027d1bbf84bdffaf0c604d8d954f0a27.png" src="_images/c9628026faa354714a0ea8916a914db7027d1bbf84bdffaf0c604d8d954f0a27.png" />
</div>
</div>
<ul class="simple">
<li><p>En este punto <em><strong>comprobaremos si los residuos ya están estacionados</strong></em> (aunque poco probable) trazando la <em><strong>función de autocorrelación junto con los intervalos de confianza del 99%</strong></em>. Para obtener este gráfico, que se muestra aquí, utilizaremos la función <code class="docutils literal notranslate"><span class="pre">autocorrelation_plot</span></code> de la <strong>API</strong> <code class="docutils literal notranslate"><span class="pre">pandas.plotting</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pandas.plotting</span> <span class="kn">import</span> <span class="n">autocorrelation_plot</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">autocorrelation_plot</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ACF of Residuals in Quaterly Beer Production time series&#39;</span><span class="p">);</span>
<span class="n">autocorrelation_plot</span><span class="p">(</span><span class="n">residuals</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/36cf1e366347b41b1f41af2fdc2a05c556c754dd37fb2c5fa5ee812436a776e3.png" src="_images/36cf1e366347b41b1f41af2fdc2a05c556c754dd37fb2c5fa5ee812436a776e3.png" />
</div>
</div>
<ul class="simple">
<li><p>Los <em><strong>residuos exhiben una autocorrelación significativa</strong></em>, como se evidencia en el <em><strong>ACF</strong></em>, con varios rezagos superando los intervalos de confianza. Por lo tanto, <em><strong>debemos aplicar diferencias estacionales en los residuos</strong></em>. Dado que los datos originales abarcan todos los trimestres de varios años, y muestran <em><strong>estacionalidad trimestral</strong></em>, optamos por <em><strong>diferencias a lo largo de periodos de cuatro unidades de tiempo</strong></em>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">residuals_qtr_diff</span> <span class="o">=</span> <span class="n">residuals</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Removemos todos los valores faltantes <code class="docutils literal notranslate"><span class="pre">NaNs</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">residuals_qtr_diff</span> <span class="o">=</span> <span class="n">residuals_qtr_diff</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">residuals_qtr_diff</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">residuals_qtr_diff</span></code> parece <em><strong>representar fluctuaciones aleatorias sin patrones estacionales ni autocorrelación notable</strong></em>. Al trazar la autocorrelación de <code class="docutils literal notranslate"><span class="pre">residuals_qtr_diff</span></code>, observamos una ACF principalmente aleatoria, con <em><strong>solo dos rezagos que superan los intervalos de confianza del 99%</strong></em>. Esto sugiere que las diferencias estacionales han logrado estacionar los residuos.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">autocorrelation_plot</span><span class="p">(</span><span class="n">residuals_qtr_diff</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ACF of Quaterly Differenced Residuals&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/911727147048a1254e79bf73a410c867d7cda8285cdba6f3a19e5ac40858f4a2.png" src="_images/911727147048a1254e79bf73a410c867d7cda8285cdba6f3a19e5ac40858f4a2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">pval_monthly_mean</span> <span class="o">=</span> <span class="n">stattools</span><span class="o">.</span><span class="n">acf</span><span class="p">(</span><span class="n">residuals_qtr_diff</span><span class="p">,</span>
                                           <span class="n">nlags</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                                           <span class="n">qstat</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                           <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Null hypothesis is rejected for lags:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pval_monthly_mean</span><span class="o">&lt;=</span><span class="mf">0.05</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Null hypothesis is rejected for lags: (array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]),)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Nuestro <em><strong>enfoque para estacionar la serie temporal de producción de cerveza trimestral</strong></em> puede ser resumir como sigue:</p>
<ol class="arabic simple">
<li><p>Tomar estacionalidad <strong>MA</strong> <span class="math notranslate nohighlight">\(\overline{\widehat{M}_{t}^{(4)}}^{(t, t+1)}\)</span></p></li>
<li><p><em><strong>Calcule los residuos</strong></em>, restando <span class="math notranslate nohighlight">\(y_{t}\)</span> de la <strong>MA</strong> <span class="math notranslate nohighlight">\(\overline{\widehat{M}_{t}^{(4)}}^{(t, t+1)}\)</span> de la serie de tiempo original</p></li>
<li><p><em><strong>Comprobar aleatoriedad/independencia de la ACF</strong></em> de los residuos</p></li>
<li><p>Si el <strong>ACF</strong> de los residuos ya es aleatorio/independiente, entonces los <em><strong>residuos son estacionarios, si no pase a la etapa siguiente</strong></em>.</p></li>
<li><p><em><strong>Tome diferencias estacionales en los residuos con periodicidad de cuatro</strong></em> y compruebe la aleatoriedad de la <strong>ACF</strong> de la serie diferenciada.</p></li>
</ol>
</li>
</ul>
<ul class="simple">
<li><p>Por lo tanto, <em><strong>las medias móviles estacionales y las diferencias estacionales en los residuos</strong></em> han <em>estacionado la serie temporal original</em>.</p></li>
</ul>
</section>
<section id="media-movil-ponderada">
<h2><span class="section-number">1.33. </span>Media móvil ponderada<a class="headerlink" href="#media-movil-ponderada" title="Link to this heading">#</a></h2>
<ul>
<li><p>En la sección anterior, expresamos las <em><strong>medias móviles de la forma</strong></em> <span class="math notranslate nohighlight">\(\overline{\widehat{M}_{t}^{(4)}}^{(t-i, t+j)}\)</span> como <em><strong>suma ponderada de las observaciones de la serie temporal original</strong></em>. Vimos cómo las <em><strong>ponderaciones caen para observaciones alejadas del índice temporal</strong></em> en el que se calcula la <strong>MA</strong>. La noción de <em><strong>medias móviles ponderadas</strong></em>, que es simétrica, puede generalizarse para cualquier aplicación de la siguiente manera:</p>
<div class="math notranslate nohighlight">
\[\widehat{W}_{t}^{(k)}=w_{t-k}y_{t-k}+w_{t-k+1}y_{t-k+1}+\cdots+w_{t}y_{t}+\cdots+w_{t+k-1}y_{t+k-1}+w_{t+k}y_{t+k},\]</div>
<p>donde los pesos <span class="math notranslate nohighlight">\(w_{t-k}+w_{t-k+1}+\cdots+w_{t-k-1}+w_{t+k}=1\)</span>. Las <em><strong>observaciones cercanas al índice de tiempo</strong></em> <span class="math notranslate nohighlight">\(t\)</span> <em><strong>se les asigna una mayor ponderación</strong></em>, mientras que las más alejadas reciben una ponderación menor.</p>
</li>
<li><p>Para un simple <strong>MA</strong> <span class="math notranslate nohighlight">\(\widehat{W}_{t}^{(k)}\)</span> los pesos son <span class="math notranslate nohighlight">\(1/N,~N\in\mathbb{Z}^{+}\)</span>. Se ha observado que el <strong>MA</strong> <em><strong>ponderado produce una estimación más suave del ciclo de la tendencia</strong></em>. Esto se atribuye al hecho de que <em><strong>todas las observaciones de la serie temporal original</strong></em>, que se utilizan para calcular el <strong>MA</strong> ponderado, <em><strong>no se ponderan usando el mismo peso como en el caso de una</strong></em> <strong>MA</strong> <span class="math notranslate nohighlight">\(\widehat{M}_{t}^{(k)}\)</span>.</p></li>
</ul>
</section>
<section id="descomposicion-de-series-temporales-mediante-medias-moviles">
<h2><span class="section-number">1.34. </span>Descomposición de series temporales mediante medias móviles<a class="headerlink" href="#descomposicion-de-series-temporales-mediante-medias-moviles" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Las medias móviles se utilizan para <em><strong>suavizar la serie original y estimar el componente de ciclo de la tendencia</strong></em>. La elección de los parámetros es crucial, siendo la periodicidad de los datos un factor determinante. En el caso de una periodicidad par, se ajusta para obtener una mejor estimación. La <em><strong>estimación del componente estacional se genera a partir de la media estacional de los residuos</strong></em>. Los <em><strong>cálculos difieren entre modelos aditivos y multiplicativos</strong></em>.</p></li>
<li><p>Finalmente, las <em><strong>variaciones irregulares</strong></em> se obtienen mediante <em><strong>ajustes adicionales de la serie original</strong></em>. Se ilustra este enfoque con la serie temporal de los <em><strong>kilómetros mensuales de las aeronaves voladas por US Airlines</strong></em>, aplicando <em><strong>modelos aditivos y multiplicativos</strong></em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa</span> <span class="kn">import</span> <span class="n">stattools</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">air_miles</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/home/lihkir/Data/us-airlines-monthly-aircraft-miles-flown.csv&#39;</span><span class="p">)</span>
<span class="n">air_miles</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">air_miles</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Shape of the DataFrame:&#39;</span><span class="p">,</span> <span class="n">air_miles</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">air_miles</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape of the DataFrame: (97, 2)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Month</th>
      <th>U.S. airlines: monthly aircraft miles flown (Millions) 1963 -1970</th>
    </tr>
    <tr>
      <th>Month</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1963-01</th>
      <td>1963-01</td>
      <td>6827.0</td>
    </tr>
    <tr>
      <th>1963-02</th>
      <td>1963-02</td>
      <td>6178.0</td>
    </tr>
    <tr>
      <th>1963-03</th>
      <td>1963-03</td>
      <td>7084.0</td>
    </tr>
    <tr>
      <th>1963-04</th>
      <td>1963-04</td>
      <td>8162.0</td>
    </tr>
    <tr>
      <th>1963-05</th>
      <td>1963-05</td>
      <td>8462.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Cambiemos el nombre de la segunda columna</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">air_miles</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;U.S. airlines: monthly aircraft miles flown (Millions) 1963 -1970&#39;</span><span class="p">:</span> <span class="s1">&#39;Air miles flown&#39;</span><span class="p">},</span> 
                 <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">air_miles</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Month</th>
      <th>Air miles flown</th>
    </tr>
    <tr>
      <th>Month</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1963-01</th>
      <td>1963-01</td>
      <td>6827.0</td>
    </tr>
    <tr>
      <th>1963-02</th>
      <td>1963-02</td>
      <td>6178.0</td>
    </tr>
    <tr>
      <th>1963-03</th>
      <td>1963-03</td>
      <td>7084.0</td>
    </tr>
    <tr>
      <th>1963-04</th>
      <td>1963-04</td>
      <td>8162.0</td>
    </tr>
    <tr>
      <th>1963-05</th>
      <td>1963-05</td>
      <td>8462.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Comprobar si existen datos faltantes y los eliminamos</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">air_miles</span><span class="p">[</span><span class="s1">&#39;Air miles flown&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of missing values found:&#39;</span><span class="p">,</span> <span class="n">missing</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">air_miles</span> <span class="o">=</span> <span class="n">air_miles</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">missing</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of missing values found: 1
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Estimamos el <em><strong>componente de tendencia mediante la media móvil mensual 2X12</strong></em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MA12</span> <span class="o">=</span> <span class="n">air_miles</span><span class="p">[</span><span class="s1">&#39;Air miles flown&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">trendComp</span> <span class="o">=</span> <span class="n">MA12</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Para el <em><strong>modelo aditivo</strong></em>, el componente estacional se obtiene <em><strong>restando la tendencia-ciclo de la serie temporal original</strong></em> y tomando las medias mensuales de los residuos. La operación de agrupación para calcular el componente estacional de la siguiente manera</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">residuals</span> <span class="o">=</span> <span class="n">air_miles</span><span class="p">[</span><span class="s1">&#39;Air miles flown&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">trendComp</span>

<span class="n">month</span> <span class="o">=</span> <span class="n">air_miles</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span>
<span class="n">monthwise_avg</span> <span class="o">=</span> <span class="n">residuals</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">])</span>
<span class="n">nb_years</span> <span class="o">=</span> <span class="mi">1970</span><span class="o">-</span><span class="mi">1963</span><span class="o">+</span><span class="mi">1</span>

<span class="n">seasonalComp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">monthwise_avg</span><span class="o">.</span><span class="n">values</span><span class="p">]</span><span class="o">*</span><span class="n">nb_years</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">12</span><span class="o">*</span><span class="n">nb_years</span><span class="p">,))</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Dadas las <em><strong>estimaciones de los componentes de tendencia-ciclo y estacional</strong></em>, obtenemos las <em><strong>variaciones irregulares</strong></em> como sigue para un modelo aditivo</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">irr_var</span> <span class="o">=</span> <span class="n">air_miles</span><span class="p">[</span><span class="s1">&#39;Air miles flown&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">trendComp</span> <span class="o">-</span> <span class="n">seasonalComp</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>La <em><strong>serie temporal original</strong></em>, los <em><strong>componentes de tendencia-ciclo</strong></em>, <em><strong>estacional</strong></em> e <em><strong>irregular</strong></em> se muestran en la siguiente figura</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">)</span>

<span class="n">air_miles</span><span class="p">[</span><span class="s1">&#39;Air miles flown&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Monthly air miles&#39;</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">trendComp</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">air_miles</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Trend component in monthly air miles&#39;</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">seasonalComp</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">air_miles</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Seasonal component in monthly air miles&#39;</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">irr_var</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">air_miles</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Irregular variations in monthly air miles&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fb8ef1f17b91fb4c9a6651fceb41db6574c86132e961e63864f8e16a1fbf207f.png" src="_images/fb8ef1f17b91fb4c9a6651fceb41db6574c86132e961e63864f8e16a1fbf207f.png" />
</div>
</div>
<ul class="simple">
<li><p>La <em><strong>prueba ADF</strong></em> de <code class="docutils literal notranslate"><span class="pre">irr_var</span></code> da un valor <span class="math notranslate nohighlight">\(p\)</span> de 0.0658. Con un nivel de confianza del 90% (<span class="math notranslate nohighlight">\(\alpha\)</span>=0.10) la <em><strong>hipótesis nula sobre la no estacionariedad de las variaciones irregulares puede aceptarse</strong></em>. Sin embargo, vamos a intentar <em><strong>mejorar aún más mediante el modelo multiplicativo</strong></em>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adf_result</span> <span class="o">=</span> <span class="n">stattools</span><span class="o">.</span><span class="n">adfuller</span><span class="p">(</span><span class="n">irr_var</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">irr_var</span><span class="p">)],</span> <span class="n">autolag</span><span class="o">=</span><span class="s1">&#39;AIC&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-val of the ADF test on irregular variations in air miles flown:&#39;</span><span class="p">,</span> <span class="n">adf_result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p-val of the ADF test on irregular variations in air miles flown: 0.06577411025730062
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>La estimación del ciclo de la tendencia mediante <strong>MA</strong> es aplicable incluso para el modelo multiplicativo. Sin embargo, <em><strong>el cálculo del componente estacional cambia</strong></em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">residuals</span> <span class="o">=</span> <span class="n">air_miles</span><span class="p">[</span><span class="s1">&#39;Air miles flown&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">trendComp</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Obsérvese que los <em><strong>residuos estacionales</strong></em> <code class="docutils literal notranslate"><span class="pre">residuals</span></code> <em><strong>dividen el componente de tendencia-ciclo de la serie temporal original</strong></em> en el caso de un modelo multiplicativo. Sin embargo, la operación de agrupación en los residuos sigue siendo la misma</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">month</span> <span class="o">=</span> <span class="n">air_miles</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span>
<span class="n">monthwise_avg</span> <span class="o">=</span> <span class="n">residuals</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">])</span>
<span class="n">nb_years</span> <span class="o">=</span> <span class="mi">1970</span><span class="o">-</span><span class="mi">1963</span><span class="o">+</span><span class="mi">1</span>

<span class="n">seasonalComp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">monthwise_avg</span><span class="o">.</span><span class="n">values</span><span class="p">]</span><span class="o">*</span><span class="n">nb_years</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">12</span><span class="o">*</span><span class="n">nb_years</span><span class="p">,))</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Finalmente, llegamos a las <em><strong>variaciones irregulares para el modelo multiplicativo</strong></em> como sigue</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">irr_var</span> <span class="o">=</span> <span class="n">air_miles</span><span class="p">[</span><span class="s1">&#39;Air miles flown&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">trendComp</span> <span class="o">*</span> <span class="n">seasonalComp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Obsérvese que los <em><strong>componentes estacionales e irregulares son de menor magnitud que los obtenidos con el modelo aditivo</strong></em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">)</span>

<span class="n">air_miles</span><span class="p">[</span><span class="s1">&#39;Air miles flown&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Monthly air miles&#39;</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">trendComp</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">air_miles</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Trend component in monthly air miles&#39;</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">seasonalComp</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">air_miles</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Seasonal component in monthly air miles&#39;</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">irr_var</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">air_miles</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Irregular variations in monthly air miles&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d642ac38b25f3c480540afd5c66eb2ec6b98747f3760170a76aaf6242f84588b.png" src="_images/d642ac38b25f3c480540afd5c66eb2ec6b98747f3760170a76aaf6242f84588b.png" />
</div>
</div>
<ul class="simple">
<li><p>La <em><strong>prueba ADF sobre las variaciones irregulares</strong></em> obtenida del modelo multiplicativo da un valor <span class="math notranslate nohighlight">\(p\)</span> de aproximadamente 0.00018, que es mucho menor que el obtenido con el modelo aditivo. Sobre todo, <em><strong>menor que el nivel de significancia del 0.01</strong></em>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adf_result</span> <span class="o">=</span> <span class="n">stattools</span><span class="o">.</span><span class="n">adfuller</span><span class="p">(</span><span class="n">irr_var</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">irr_var</span><span class="p">)],</span> <span class="n">autolag</span><span class="o">=</span><span class="s1">&#39;AIC&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-val of the ADF test on irregular variations in air miles flown:&#39;</span><span class="p">,</span> <span class="n">adf_result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p-val of the ADF test on irregular variations in air miles flown: 0.00017645280908370881
</pre></div>
</div>
</div>
</div>
</section>
<section id="descomposicion-de-series-temporales-mediante-statsmodels-tsa">
<h2><span class="section-number">1.35. </span>Descomposición de series temporales mediante <code class="docutils literal notranslate"><span class="pre">statsmodels.tsa</span></code><a class="headerlink" href="#descomposicion-de-series-temporales-mediante-statsmodels-tsa" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Analizamos el uso de <em><strong>MA para estimar tendencias y estacionalidad en series temporales</strong></em>. Sin embargo, para <em><strong>patrones más complejos</strong></em>, como cambios en la estacionalidad, <em><strong>recurrimos al método</strong></em> <a class="reference external" href="https://www.statsmodels.org/devel/generated/statsmodels.tsa.seasonal.STL.html">STL</a> <span id="id4">[<a class="reference internal" href="biblio.html#id27" title="Robert B Cleveland, William S Cleveland, Jean E McRae, Irma Terpenning, and others. Stl: a seasonal-trend decomposition. J. Off. Stat, 6(1):3–73, 1990.">Cleveland <em>et al.</em>, 1990</a>]</span> en que se usa <a class="reference external" href="https://es.wikipedia.org/wiki/Regresi%C3%B3n_local">Regresión Local (LOESS)</a> en el proceso de suavización. En esta sección, emplearemos <code class="docutils literal notranslate"><span class="pre">statsmodels.tsa</span></code> en <code class="docutils literal notranslate"><span class="pre">Python</span></code> para <em><strong>estimar tendencias, ciclos y estacionalidad</strong></em>, luego <em><strong>aplicaremos la prueba ADF para verificar la estacionariedad de los datos</strong></em>.</p></li>
</ul>
<ul class="simple">
<li><p>Consideremos la <em><strong>serie temporal del empleo mensual en Wisconsin, Estados Unidos</strong></em>, para ilustrar el enfoque antes mencionado. Los datos corresponden al <em><strong>periodo comprendido entre enero de 1961 y octubre de 1975</strong></em>. Comenzamos cargando el conjunto de datos en un <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> <code class="docutils literal notranslate"><span class="pre">wisc_emp</span></code> y ejecutando la prueba <strong>ADF</strong> para la serie temporal original como sigue</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa</span> <span class="kn">import</span> <span class="n">stattools</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa</span> <span class="kn">import</span> <span class="n">seasonal</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wisc_emp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/home/lihkir/Data/wisconsin-employment-time-series.csv&#39;</span><span class="p">)</span>
<span class="n">wisc_emp</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">wisc_emp</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Shape of the DataFrame:&#39;</span><span class="p">,</span> <span class="n">wisc_emp</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">wisc_emp</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape of the DataFrame: (178, 2)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Month</th>
      <th>Employment</th>
    </tr>
    <tr>
      <th>Month</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1961-01</th>
      <td>1961-01</td>
      <td>239.6</td>
    </tr>
    <tr>
      <th>1961-02</th>
      <td>1961-02</td>
      <td>236.4</td>
    </tr>
    <tr>
      <th>1961-03</th>
      <td>1961-03</td>
      <td>236.8</td>
    </tr>
    <tr>
      <th>1961-04</th>
      <td>1961-04</td>
      <td>241.5</td>
    </tr>
    <tr>
      <th>1961-05</th>
      <td>1961-05</td>
      <td>243.7</td>
    </tr>
    <tr>
      <th>1961-06</th>
      <td>1961-06</td>
      <td>246.1</td>
    </tr>
    <tr>
      <th>1961-07</th>
      <td>1961-07</td>
      <td>244.1</td>
    </tr>
    <tr>
      <th>1961-08</th>
      <td>1961-08</td>
      <td>244.2</td>
    </tr>
    <tr>
      <th>1961-09</th>
      <td>1961-09</td>
      <td>244.8</td>
    </tr>
    <tr>
      <th>1961-10</th>
      <td>1961-10</td>
      <td>246.6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">wisc_emp</span><span class="p">[</span><span class="s1">&#39;Employment&#39;</span><span class="p">]))</span> <span class="o">|</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">wisc_emp</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of missing values found:&#39;</span><span class="p">,</span> <span class="n">missing</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">wisc_emp</span> <span class="o">=</span> <span class="n">wisc_emp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">missing</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of missing values found: 0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adf_result</span> <span class="o">=</span> <span class="n">stattools</span><span class="o">.</span><span class="n">adfuller</span><span class="p">(</span><span class="n">wisc_emp</span><span class="p">[</span><span class="s1">&#39;Employment&#39;</span><span class="p">],</span> <span class="n">autolag</span><span class="o">=</span><span class="s1">&#39;AIC&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-val of the ADF test on irregular variations in employment data:&#39;</span><span class="p">,</span> <span class="n">adf_result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p-val of the ADF test on irregular variations in employment data: 0.9810000189539195
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Un valor <span class="math notranslate nohighlight">\(p\)</span> <em><strong>elevado de 0.9810 para la prueba ADF</strong></em> de la serie mensual de empleo <em><strong>indica que la serie temporal original es no estacionaria</strong></em>. Por lo tanto, intentamos <em><strong>descomponer la serie temporal y, en consecuencia, estacionarla</strong></em> utilizando la función <code class="docutils literal notranslate"><span class="pre">seasonal.seasonal_decompose</span></code> de la librería <code class="docutils literal notranslate"><span class="pre">statsmodels.tsa</span></code>. Intentemos primero el modelo aditivo para la descomposición</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">decompose_model</span> <span class="o">=</span> <span class="n">seasonal</span><span class="o">.</span><span class="n">seasonal_decompose</span><span class="p">(</span><span class="n">wisc_emp</span><span class="o">.</span><span class="n">Employment</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">period</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;additive&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>El argumento <code class="docutils literal notranslate"><span class="pre">period</span></code> en el <code class="docutils literal notranslate"><span class="pre">seasonal.seasonal_decompose</span></code> es la <em><strong>periodicidad del comportamiento estacional y la serie temporal original</strong></em>, al ser <em><strong>observaciones mensuales, sospechamos una periodicidad de 12</strong></em>, que puede verificarse mediante un análisis exploratorio de los datos.</p></li>
<li><p>Los <em><strong>componentes de tendencia-ciclo, estacional y residual</strong></em> de la serie temporal descompuesta son accesibles a través de los atributos del objeto <code class="docutils literal notranslate"><span class="pre">decompose_model</span></code> devuelto por el <code class="docutils literal notranslate"><span class="pre">seasonal.seasonal_decompose</span></code>. Estos componentes se pueden obtener a partir de los siguientes <em><strong>atributos de</strong></em> <code class="docutils literal notranslate"><span class="pre">decompose_model</span></code>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">decompose_model.trend</span></code>: Componente de <em><strong>ciclo de tendencia</strong></em></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">decompose_model.seasonal</span></code>: Componente <em><strong>estacional</strong></em></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">decompose_model.resid</span></code>: Variaciones <em><strong>irregulares</strong></em></p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">)</span>

<span class="n">wisc_emp</span><span class="p">[</span><span class="s1">&#39;Employment&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Monthly Employment&#39;</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">decompose_model</span><span class="o">.</span><span class="n">trend</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">wisc_emp</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Trend component in monthly employment&#39;</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">decompose_model</span><span class="o">.</span><span class="n">seasonal</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">wisc_emp</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Seasonal component in monthly employment&#39;</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">decompose_model</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">wisc_emp</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Irregular variations in monthly employment&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">2.0</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6a84295fe530d5008a81ebe5e384a6f13e9d4fc4d51d763e37e3401a754ca7a1.png" src="_images/6a84295fe530d5008a81ebe5e384a6f13e9d4fc4d51d763e37e3401a754ca7a1.png" />
</div>
</div>
<ul class="simple">
<li><p>Ahora ejecutamos la prueba <em><strong>ADF sobre los residuos del modelo aditivo y obtenemos un valor</strong></em> <span class="math notranslate nohighlight">\(p\)</span> <em><strong>de 0.00656</strong></em>, que es mucho menor que el obtenido con la serie temporal original. Sin embargo, <em><strong>construiremos también un modelo multiplicativo</strong></em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adf_result</span> <span class="o">=</span> <span class="n">stattools</span><span class="o">.</span><span class="n">adfuller</span><span class="p">(</span><span class="n">decompose_model</span><span class="o">.</span><span class="n">resid</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">decompose_model</span><span class="o">.</span><span class="n">resid</span><span class="p">))[</span><span class="mi">0</span><span class="p">]],</span> 
                                <span class="n">autolag</span><span class="o">=</span><span class="s1">&#39;AIC&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-val of the ADF test on irregular variations in employment data:&#39;</span><span class="p">,</span> <span class="n">adf_result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p-val of the ADF test on irregular variations in employment data: 0.006560931634642831
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">decompose_model</span> <span class="o">=</span> <span class="n">seasonal</span><span class="o">.</span><span class="n">seasonal_decompose</span><span class="p">(</span><span class="n">wisc_emp</span><span class="o">.</span><span class="n">Employment</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">period</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;multiplicative&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">)</span>

<span class="n">wisc_emp</span><span class="p">[</span><span class="s1">&#39;Employment&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Monthly Employment&#39;</span><span class="p">);</span>

<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">decompose_model</span><span class="o">.</span><span class="n">trend</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Trend component in monthly employment&#39;</span><span class="p">);</span>

<span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">decompose_model</span><span class="o">.</span><span class="n">seasonal</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Seasonal component in monthly employment&#39;</span><span class="p">);</span>

<span class="n">axarr</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">decompose_model</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">axarr</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Irregular variations in monthly employment&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f870e606eae1036b40761d6402f64acbdf48bb45a6faf661e292ed7a66f4cca1.png" src="_images/f870e606eae1036b40761d6402f64acbdf48bb45a6faf661e292ed7a66f4cca1.png" />
</div>
</div>
<ul class="simple">
<li><p>La prueba <em><strong>ADF sobre los residuos de la descomposición multiplicativa da un valor</strong></em> <span class="math notranslate nohighlight">\(p\)</span> <em><strong>de 0.00123</strong></em> que es incluso <em><strong>menor que el obtenido con la descomposición aditiva</strong></em>. Con un nivel de confianza del 99% (<span class="math notranslate nohighlight">\(\alpha\)</span>=0.01) <em><strong>podemos rechazar la hipótesis nula de la prueba ADF</strong></em> y concluir que <em><strong>los residuos del modelo de descomposición multiplicativa corresponden a una serie estacionaria</strong></em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adf_result</span> <span class="o">=</span> <span class="n">stattools</span><span class="o">.</span><span class="n">adfuller</span><span class="p">(</span><span class="n">decompose_model</span><span class="o">.</span><span class="n">resid</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">decompose_model</span><span class="o">.</span><span class="n">resid</span><span class="p">))[</span><span class="mi">0</span><span class="p">]],</span> 
                                <span class="n">autolag</span><span class="o">=</span><span class="s1">&#39;AIC&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-val of the ADF test on irregular variations in employment data:&#39;</span><span class="p">,</span> <span class="n">adf_result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p-val of the ADF test on irregular variations in employment data: 0.0012347837267736395
</pre></div>
</div>
</div>
</div>
</section>
<section id="residual-y-error-de-prediccion">
<h2><span class="section-number">1.36. </span>Residual y error de predicción<a class="headerlink" href="#residual-y-error-de-prediccion" title="Link to this heading">#</a></h2>
<div class="proof definition admonition" id="forecast_error">
<p class="admonition-title"><span class="caption-number">Definition 1.4 </span></p>
<section class="definition-content" id="proof-content">
<ul>
<li><p>Supongamos que se dispone de <span class="math notranslate nohighlight">\(T\)</span> <em><strong>periodos de datos disponibles</strong></em>, siendo el periodo <span class="math notranslate nohighlight">\(T\)</span> <em><strong>el más reciente</strong></em>. Denotemos por <span class="math notranslate nohighlight">\(y_{t}\)</span> la <em><strong>observación de esta variable en el periodo de tiempo</strong></em> <span class="math notranslate nohighlight">\(t,~t = 1,2,\dots, T\)</span>.</p></li>
<li><p>En general, tendremos que distinguir entre una <em><strong>predicción o valor predicho</strong></em> de <span class="math notranslate nohighlight">\(y_{t}\)</span> <em><strong>que se hizo en algún periodo de tiempo previo</strong></em>, digamos, <span class="math notranslate nohighlight">\(t-\tau\)</span> y un <em><strong>valor ajustado</strong></em> de <span class="math notranslate nohighlight">\(y_{t}\)</span> que ha resultado de la estimación de los parámetros de un modelo de series temporales a datos históricos. Tenga en cuenta que <span class="math notranslate nohighlight">\(\tau\)</span> es el <em><strong>horizonte de predicción</strong></em>.</p></li>
<li><p>La <em><strong>predicción realizada en el periodo de tiempo</strong></em> <span class="math notranslate nohighlight">\(t-\tau\)</span> <em><strong>se denota por</strong></em> <span class="math notranslate nohighlight">\(\hat{y}_{t}(t-\tau)\)</span>. Hay mucho interés en la predicción basada en el tiempo previo <span class="math notranslate nohighlight">\(\text{lead}-1\)</span>, que es la <em><strong>predicción de la observación en el periodo</strong></em> <span class="math notranslate nohighlight">\(t\)</span>, <span class="math notranslate nohighlight">\(y_{t}\)</span>, <em><strong>realizada un periodo previo</strong></em>, <span class="math notranslate nohighlight">\(\hat{y}_{t}(t - 1)\)</span>.</p></li>
<li><p>Denotaremos el <em><strong>valor ajustado de</strong></em> <span class="math notranslate nohighlight">\(y_{t}\)</span> por <span class="math notranslate nohighlight">\(\hat{y}_{t}\)</span>. También nos interesará analizar los <em><strong>errores de predicción</strong></em>. El error de predicción que resulta de una predicción de <span class="math notranslate nohighlight">\(y_{t}\)</span> que se realizó en el periodo de tiempo <span class="math notranslate nohighlight">\(t-\tau\)</span> es el <em><strong><code class="docutils literal notranslate"><span class="pre">error</span> <span class="pre">de</span> <span class="pre">predicción</span></code></strong></em> <span class="math notranslate nohighlight">\(\text{lead} - \tau\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \\[2mm]
    e_{t}(\tau)=y_{t}-\hat{y}_{t}(t-\tau).
    \end{split}\]</div>
<p>Por ejemplo, el error de predicción <span class="math notranslate nohighlight">\(\text{lead} - 1\)</span> es</p>
</li>
</ul>
<div class="math notranslate nohighlight">
\[
e_{t}(1)=y_{t}-\hat{y}_{t}(t-1).
\]</div>
<ul class="simple">
<li><p>La <em><strong>diferencia entre la observación</strong></em> <span class="math notranslate nohighlight">\(y_{t}\)</span> <em><strong>y el valor obtenido ajustando un modelo de series temporales</strong></em> a los datos, o un valor ajustado <span class="math notranslate nohighlight">\(\hat{y}_{t}\)</span> definido anteriormente, se denomina <em><strong><code class="docutils literal notranslate"><span class="pre">residual</span></code></strong></em>, y se denota por</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
e_{t}=y_{t}-\hat{y}_{t}.
\]</div>
</section>
</div><div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>La razón de esta cuidadosa distinción entre <em><strong><code class="docutils literal notranslate"><span class="pre">error</span> <span class="pre">de</span> <span class="pre">predicción</span></code></strong></em> y <em><strong><code class="docutils literal notranslate"><span class="pre">residual</span></code></strong></em> es que <em><strong>los modelos suelen ajustarse mejor a los datos históricos de lo que pronostican</strong></em>.</p></li>
<li><p>Es decir, los <em><strong>residuos de un proceso de ajuste de modelo casi siempre serán menores que los errores de predicción</strong></em> que se experimentan cuando ese modelo se utiliza para pronosticar observaciones futuras.</p></li>
</ul>
</div>
</section>
<section id="evaluando-y-monitoreando-el-desempeno-del-modelo-predictivo">
<h2><span class="section-number">1.37. </span>Evaluando y monitoreando el desempeño del modelo predictivo<a class="headerlink" href="#evaluando-y-monitoreando-el-desempeno-del-modelo-predictivo" title="Link to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title">Introducción</p>
<ul class="simple">
<li><p>El <em><strong>desempeño o rendimiento de un modelo predictivo</strong></em> está relacionado con el <em><strong>ajuste del pronóstico o modelo de series temporales a datos historicos</strong></em>. Los usuarios de un modelo predictivo están siempre interesados la <em><strong>precisión de futuras predicciones</strong></em>, no en la bondad de ajuste del modelo, por lo tanto, es importante <em><strong>evaluar este aspecto de cualquier modelo recomendado</strong></em></p></li>
<li><p>En algunos casos, la precisión de predicción es llamada <em><strong>error de predicción “out of sample”</strong></em>, para <em><strong>distinguir esta del residual que proviene del proceso de ajuste del modelo</strong></em>. Cuando mas de una técnica  predictiva parece razonable para una aplicación en particular, estas medidas de precisión del pronóstico pueden ser usadas para <em><strong>discriminar entre modelos que compiten entre ellos</strong></em>.</p></li>
</ul>
</div>
<div class="admonition-rendimiento-del-modelo-predictivo admonition">
<p class="admonition-title">Rendimiento del modelo predictivo</p>
<ul>
<li><p>Es habitual evaluar el <em><strong>rendimiento de un modelo</strong></em> usando el <em><strong>error de pronóstico one-step-ahead</strong></em></p>
<div class="math notranslate nohighlight">
\[
    e_{t}(1)=y_{t}-\hat{y}_{t}(t-1)
    \]</div>
<p>donde <span class="math notranslate nohighlight">\(\hat{y}_{t}(t-1)\)</span> es la <em><strong>predicción de</strong></em> <span class="math notranslate nohighlight">\(y_{t}\)</span> <em><strong>que fue hecha en el periodo previo</strong></em>. Errores de pronósticos en otros rezagos (lags), si está interesado en estos pronósticos particulares.</p>
</li>
<li><p>Suponga que hay <span class="math notranslate nohighlight">\(n\)</span> observaciones para las cuales pronósticos han sido realizados y <span class="math notranslate nohighlight">\(n\)</span> errores one-step-ahead, <span class="math notranslate nohighlight">\(e_{t}(1),~t=1,2,\dots, n\)</span>. Medidas estándar de <em><strong>precisión del pronóstico son</strong></em> el <em><strong>error promedio o error medio</strong></em></p>
<div class="math notranslate nohighlight">
\[
    \text{ME}=\frac{1}{n}\sum_{t=1}^{n}e_{t}(1),
    \]</div>
<p>la <em><strong>desviación media absoluta</strong></em> (o <em><strong>error absoluto medio</strong></em>)</p>
<div class="math notranslate nohighlight">
\[
    \text{MAD}=\frac{1}{n}\sum_{t=1}^{n}|e_{t}(1)|,
    \]</div>
<p>y el <em><strong>error cuadrático medio</strong></em></p>
<div class="math notranslate nohighlight">
\[
    \text{MSE}=\frac{1}{n}\sum_{t=1}^{n}[e_{t}(1)]^{2}
    \]</div>
</li>
<li><p>Claramente, queremos que la <em><strong>variabilidad del error de pronóstico sea pequeña</strong></em>. El MSE es un <em><strong>estimador directo de la varianza del error de predicción one-step-ahead</strong></em></p>
<div class="math notranslate nohighlight">
\[
    \hat{\sigma}_{e(1)}^{2}=\text{MSE}=\frac{1}{n}\sum_{t=1}^{n}[e_{t}(1)]^{2}.
    \]</div>
</li>
<li><p>Si los <em><strong>errores de predicción están normalmente distribuidos</strong></em>, el MAD es relacionado con la <em><strong>desviación estándar de los errores de predicción</strong></em> por</p>
<div class="math notranslate nohighlight">
\[
    \hat{\sigma}_{e(1)}=\sqrt{\frac{\pi}{2}}\text{MAD}\approx 1.25\text{MAD}.
    \]</div>
</li>
<li><p>Además, las <em><strong>medidas de precisión que son dependientes de la escala</strong></em> no facilitan comparaciones de una técnica predictiva a través de diferentes series de tiempo, o comparación a través de diferentes periodos de tiempo. Para solucionar esto, definimos el <em><strong>error de predicción relativo</strong></em> (en <em><strong>porcentaje</strong></em>) como</p>
<div class="math notranslate nohighlight">
\[
    re_{t}(1)=\left(\frac{y_{t}-\hat{y}_{t}(t-1)}{y_{t}}\right)100=\left(\frac{e_{t}(1)}{y_{t}}\right)100.
    \]</div>
</li>
<li><p>La anterior métrica es llamada el <em><strong>error de pronóstico porcentual</strong></em>. La <em><strong>media del error de pronóstico porcentual</strong></em> (MPE) es</p>
<div class="math notranslate nohighlight">
\[
    \text{MPE}=\frac{1}{n}\sum_{t=1}^{n}re_{t}(1)
    \]</div>
<p>y la <em><strong>media absoluta del error de pronóstico porcentual</strong></em> (MAPE) es</p>
<div class="math notranslate nohighlight">
\[
    \text{MAPE}=\frac{1}{n}\sum_{t=1}^{n}|re_{t}(1)|.
    \]</div>
</li>
<li><p>Nótese que el <em><strong>error de pronóstico porcentual relativo</strong></em> solo tiene sentido <em>si la serie de tiempo</em> <span class="math notranslate nohighlight">\(y_{t}\)</span> <em>no tiene valores nulos</em>.</p></li>
</ul>
</div>
<ul>
<li><p>Si una <em><strong>serie temporal es ruido blanco</strong></em>, la <em><strong>distribución del coeficiente de autocorrelación muestral</strong></em> en el rezago <span class="math notranslate nohighlight">\(k\)</span> en muestras grandes es <em><strong>aproximadamente normal con media cero y varianza</strong></em> <span class="math notranslate nohighlight">\(1/T\)</span>; es decir,</p>
<div class="math notranslate nohighlight">
\[
  r_{k}\sim N\left(0, \frac{1}{T}\right).
  \]</div>
</li>
</ul>
<ul>
<li><p>Por lo tanto, podríamos <em><strong>probar la hipótesis</strong></em> <span class="math notranslate nohighlight">\(H_{0}:~\rho_{k} = 0\)</span> utilizando el <em><strong>estadístico de prueba</strong></em></p>
<div class="math notranslate nohighlight" id="equation-test-statistic-acf-normal-dist">
<span class="eqno">(1.5)<a class="headerlink" href="#equation-test-statistic-acf-normal-dist" title="Link to this equation">#</a></span>\[
  Z_{0}=\frac{r_{k}}{\sqrt{1/T}}=r_{k}\sqrt{T}.
  \]</div>
</li>
</ul>
<ul class="simple">
<li><p>Este procedimiento es una prueba one-at-a-time; es decir, <em><strong>el nivel de significancia se aplica a las autocorrelaciones consideradas individualmente</strong></em>. A menudo, <em><strong>estamos interesados en evaluar un conjunto de autocorrelaciones conjuntamente para determinar si indican que la serie temporal es ruido blanco</strong></em>. <span id="id5">[<a class="reference internal" href="biblio.html#id23" title="George EP Box and David A Pierce. Distribution of residual autocorrelations in autoregressive-integrated moving average time series models. Journal of the American statistical Association, 65(332):1509–1526, 1970.">Box and Pierce, 1970</a>]</span> han sugerido dicho procedimiento.</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Box-Pierce test</p>
<ul>
<li><p>Considera el <em><strong>cuadrado del estadístico de prueba</strong></em> <span class="math notranslate nohighlight">\(Z_{0}\)</span> en la Ecuación <a class="reference internal" href="#equation-test-statistic-acf-normal-dist">(1.5)</a>. La distribución de <span class="math notranslate nohighlight">\(Z_{0}^{2} = r_{k}^{2}T\)</span> es <em><strong>aproximadamente chi-cuadrado</strong></em> con <em><strong>un grado de libertad</strong></em>. El <em><strong>estadístico de Box-Pierce</strong></em></p>
<div class="math notranslate nohighlight">
\[
  Q_{BP}=T\sum_{k=1}^{K}r_{k}^{2}
  \]</div>
<p>bajo la <em><strong>hipótesis nula de que la serie temporal es ruido blanco</strong></em>, tiene una <em><strong>distribución chi-cuadrado aproximada</strong></em> con <span class="math notranslate nohighlight">\(K\)</span> grados de libertad. Por lo tanto, si <span class="math notranslate nohighlight">\(Q_{BP} &gt; \chi_{\alpha, K}^{2}\)</span>, <em><strong>rechazaríamos la hipótesis nula y concluiríamos que la serie temporal no es ruido blanco</strong></em> porque algunas de las autocorrelaciones no son cero.</p>
</li>
</ul>
</div>
<ul>
<li><p>Una <em><strong>modificación</strong></em> de esta prueba que <em><strong>funciona mejor para muestras pequeñas</strong></em> fue ideada por <span id="id6">[<a class="reference internal" href="biblio.html#id24" title="Greta M Ljung and George EP Box. On a measure of lack of fit in time series models. Biometrika, 65(2):297–303, 1978.">Ljung and Box, 1978</a>]</span>. El <em><strong>estadístico de bondad de ajuste</strong></em> de <em><strong><code class="docutils literal notranslate"><span class="pre">Ljung-Box</span></code></strong></em> es</p>
<div class="math notranslate nohighlight">
\[
  Q_{LB}=T(T+2)\sum_{k=1}^{K}\left(\frac{1}{T-k}\right)r_{k}^{2}.
  \]</div>
</li>
</ul>
<ul class="simple">
<li><p>Es importante destacar que <em><strong>el estadístico de bondad de ajuste de Ljung-Box es muy similar a la estadística original de Box-Pierce</strong></em>, la diferencia radica en que la <em><strong>autocorrelación muestral al cuadrado en el rezago</strong></em> <span class="math notranslate nohighlight">\(k\)</span> <em><strong>está ponderada por</strong></em> <span class="math notranslate nohighlight">\((T + 2)∕(T − k)\)</span>. Para valores grandes de <span class="math notranslate nohighlight">\(T\)</span>, estos pesos serán aproximadamente unitarios, por lo que los estadísticos <span class="math notranslate nohighlight">\(Q_{LB}\)</span> y <span class="math notranslate nohighlight">\(Q_{BP}\)</span> serán muy similares (<em><strong><code class="docutils literal notranslate"><span class="pre">bonus</span></code></strong></em>).</p></li>
</ul>
</section>
<section id="elegir-entre-modelos-que-compiten">
<h2><span class="section-number">1.38. </span>Elegir entre modelos que compiten<a class="headerlink" href="#elegir-entre-modelos-que-compiten" title="Link to this heading">#</a></h2>
<div class="admonition-introduccion admonition">
<p class="admonition-title">Introducción</p>
<ul class="simple">
<li><p>A menudo hay varios modelos que compiten, los cuales se pueden utilizar para predecir una serie temporal específica. Por ejemplo, existen <em><strong>varias formas de modelar y pronosticar tendencias</strong></em>. En consecuencia, <em><strong>seleccionar un modelo de pronóstico apropiado es de considerable importancia práctica</strong></em>.</p></li>
<li><p>En esta sección discutimos algunos principios generales de <em><strong>selección de modelos</strong></em>. En capítulos posteriores, ilustraremos cómo se aplican estos principios en situaciones específicas.</p></li>
</ul>
</div>
<ul>
<li><p>Al evaluar el <em><strong>ajuste del modelo a los datos históricos</strong></em>, hay varios criterios que pueden ser de valor. El <em><strong>error cuadrático medio de los residuos</strong></em> es</p>
<div class="math notranslate nohighlight">
\[
  s^{2}=\frac{\displaystyle{\sum_{t=1}^{T}e_{t}^{2}}}{T-p}
  \]</div>
<p>donde <span class="math notranslate nohighlight">\(T\)</span> <em><strong>periodos de datos se han utilizado para ajustar un modelo</strong></em> con <span class="math notranslate nohighlight">\(p\)</span> <em><strong>parámetros</strong></em> y <span class="math notranslate nohighlight">\(e_{t}\)</span> es el <em><strong>residuo del proceso de ajuste del modelo</strong></em> en el período <span class="math notranslate nohighlight">\(t\)</span>. El error cuadrático medio <span class="math notranslate nohighlight">\(s^{2}\)</span> es simplemente la <em><strong>varianza muestral de los residuos</strong></em> y es un <em><strong>estimador de la varianza de los errores del modelo</strong></em>.</p>
</li>
</ul>
<ul>
<li><p>Otro criterio es el <em><strong>estadístico</strong></em> <span class="math notranslate nohighlight">\(R\)</span><em><strong>-cuadrado</strong></em></p>
<div class="math notranslate nohighlight" id="equation-r2-test-goodnessoffit">
<span class="eqno">(1.6)<a class="headerlink" href="#equation-r2-test-goodnessoffit" title="Link to this equation">#</a></span>\[
  R^{2}=1-\frac{\displaystyle{\sum_{t=1}^{T}e_{t}^{2}}}{\displaystyle{\sum_{t=1}^{T}(y_{t}-\overline{y})^{2}}}
  \]</div>
</li>
</ul>
<ul class="simple">
<li><p>El <em><strong>denominador</strong></em> de la Ecuación <a class="reference internal" href="#equation-r2-test-goodnessoffit">(1.6)</a> es simplemente la <em><strong>suma total de cuadrados de las observaciones</strong></em>, que es constante (<em>no depende del modelo</em>), y el <em><strong>numerador</strong></em> es simplemente la <em><strong>suma residual de cuadrados</strong></em>.</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p><em><strong>Seleccionar el modelo que maximiza el</strong></em> <span class="math notranslate nohighlight">\(R^2\)</span> es equivalente a <em><strong>seleccionar el modelo que minimiza la suma de los residuos al cuadrado</strong></em>. <em><strong>Valores grandes de</strong></em> <span class="math notranslate nohighlight">\(R^2\)</span> <em><strong>sugieren un buen ajuste a los datos históricos</strong></em>.</p></li>
<li><p>Debido a que la <em><strong>suma residual de cuadrados siempre disminuye cuando se agregan parámetros a un modelo</strong></em>, confiar en <span class="math notranslate nohighlight">\(R^2\)</span> <em><strong>para seleccionar un modelo de pronóstico, fomenta el sobreajuste</strong></em> o la inclusión de más parámetros de los realmente necesarios para obtener buenos pronósticos. Un <em><strong>valor grande de</strong></em> <span class="math notranslate nohighlight">\(R^2\)</span> <em><strong>no garantiza que los errores de pronóstico fuera de la muestra</strong></em> a un paso adelante <em><strong>sean pequeños</strong></em>.</p></li>
</ul>
</div>
<ul>
<li><p>Un mejor criterio es el <em><strong>estadístico</strong></em> <span class="math notranslate nohighlight">\(R^2\)</span> <em><strong>“ajustado”</strong></em>, definido como</p>
<div class="math notranslate nohighlight">
\[
  R_{\text{Adj}}^{2}=1-\frac{\displaystyle{\sum_{t=1}^{T}e_{t}^{2}/(T-p)}}{\displaystyle{\sum_{t=1}^{T}(y_{t}-\overline{y})^{2}/(T-1)}}=\frac{s^{2}}{\displaystyle{\sum_{t=1}^{T}(y_{t}-\overline{y})^{2}/(T-1)}}.
  \]</div>
</li>
</ul>
<ul class="simple">
<li><p>El ajuste es un <em><strong>ajuste “de tamaño”</strong></em>, es decir, <em><strong>ajusta según el número de parámetros en el modelo</strong></em>. Es importante destacar que <em><strong>un modelo que maximiza el estadístico</strong></em> <span class="math notranslate nohighlight">\(R^2\)</span> <em><strong>ajustado, también es el modelo que minimiza el cuadrado medio residual</strong></em>.</p></li>
</ul>
<div class="admonition-aic-y-bic admonition">
<p class="admonition-title">AIC y BIC</p>
<ul>
<li><p>Otros dos criterios importantes son el <em><strong>Criterio de Información de Akaike (AIC)</strong></em> <span id="id7">[<a class="reference internal" href="biblio.html#id25" title="Hirotugu Akaike. A new look at the statistical model identification. IEEE transactions on automatic control, 19(6):716–723, 1974.">Akaike, 1974</a>]</span> y el <em><strong>Criterio de Información Bayesiano de Schwarz</strong></em> (abreviado como <em><strong>BIC</strong></em> o <em><strong>SIC</strong></em> por varios autores) <span id="id8">[<a class="reference internal" href="biblio.html#id26" title="Gideon Schwarz. Estimating the dimension of a model. The annals of statistics, pages 461–464, 1978.">Schwarz, 1978</a>]</span>:</p>
<div class="math notranslate nohighlight">
\[
    AIC=\ln\left(\frac{\displaystyle{\sum_{t=1}^{T}e_{t}^{2}}}{T}\right)+\frac{2p}{T}\quad\text{y}\quad BIC=\ln\left(\frac{\displaystyle{\sum_{t=1}^{T}e_{t}^{2}}}{T}\right)+\frac{p\ln(T)}{T}.
    \]</div>
</li>
</ul>
</div>
<ul class="simple">
<li><p>Estos dos criterios <em><strong>penalizan la suma de los residuos al cuadrado por incluir parámetros adicionales en el modelo</strong></em>. Los modelos que tienen <em><strong>valores pequeños de AIC o BIC se consideran buenos modelos</strong></em>.</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>Un criterio de <em><strong>selección de modelos es <code class="docutils literal notranslate"><span class="pre">consistente</span></code> si</strong></em> selecciona el modelo verdadero cuando <em><strong>el modelo verdadero está entre los considerados con una probabilidad que se aproxima a la unidad a medida que el tamaño de la muestra se vuelve grande</strong></em>.</p></li>
<li><p>Resulta que <span class="math notranslate nohighlight">\(s^{2}\)</span>, <em><strong>el</strong></em> <span class="math notranslate nohighlight">\(R^2\)</span> <em><strong>ajustado y el AIC no son consistentes, porque no penalizan lo suficiente por agregar parámetros</strong></em>. Confiar en estos criterios tiende a resultar en <em><strong>sobreajuste</strong></em>. El <em><strong>BIC, que tiene una penalización más fuerte por el “ajuste de tamaño”, es consistente</strong></em>.</p></li>
<li><p>Los <em><strong>criterios de consistencia no revelan toda la situación</strong></em>. Aunque un criterio puede ser <em><strong>asintóticamente eficiente, como el AIC</strong></em>, <em><strong>esto no garantiza una selección ideal del modelo</strong></em> en situaciones donde el modelo verdadero y sus aproximaciones son altamente complejos.</p></li>
</ul>
</div>
<div class="admonition-aic-corregido admonition">
<p class="admonition-title">AIC corregido</p>
<ul>
<li><p>Existen varias <em><strong>variaciones y extensiones de estos criterios</strong></em>. El AIC es un estimador sesgado de la discrepancia entre todos los modelos candidatos y el verdadero modelo. Esto ha llevado al desarrollo de una <em><strong>versión “corregida” del AIC</strong></em> <span id="id9">[<a class="reference internal" href="biblio.html#id28" title="Clifford M Hurvich and Chih-Ling Tsai. Regression and time series model selection in small samples. Biometrika, 76(2):297–307, 1989.">Hurvich and Tsai, 1989</a>]</span>:</p>
<div class="math notranslate nohighlight">
\[
    AIC_{c}=\ln\left(\frac{\displaystyle{\sum_{t=1}^{T}e_{t}^{2}}}{T}\right)+\frac{2T(p+1)}{T-p-2}.
    \]</div>
</li>
<li><p>Así, <span class="math notranslate nohighlight">\(AIC_{c}\)</span> <em><strong>es esencialmente AIC con un término adicional de penalización</strong></em> por el número de parámetros.</p></li>
</ul>
</div>
<div class="admonition-observacion admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>A veces vemos que el primer término en el AIC, AICc o BIC se escribe como <span class="math notranslate nohighlight">\(-2\ln L(\boldsymbol{\beta}, \sigma^{2})\)</span>, donde <span class="math notranslate nohighlight">\(L(\boldsymbol{\beta}, \sigma^{2})\)</span> es la <em><strong>función de verosimilitud</strong></em> para el modelo ajustado evaluado en las estimaciones de máxima verosimilitud de los parámetros desconocidos <span class="math notranslate nohighlight">\(\boldsymbol{\beta}\)</span> y  <span class="math notranslate nohighlight">\(\sigma^{2}\)</span>. En este contexto, AIC, AICc y SIC se llaman <em><strong>criterios de verosimilitud penalizados</strong></em>.</p></li>
</ul>
</div>
<div class="tip admonition">
<p class="admonition-title">Resumen</p>
<ul class="simple">
<li><p>Comenzamos este capítulo hablando de técnicas avanzadas de procesamiento de datos, como el <em><strong>remuestreo, el agrupamiento y el cálculo de ventanas móviles para obtener estadísticos agregados de una serie temporal</strong></em>. A continuación, describimos las series temporales estacionarias y analizamos las pruebas estadísticas de hipótesis como la <em><strong>prueba de <code class="docutils literal notranslate"><span class="pre">Ljung-Box</span></code> y la prueba de <code class="docutils literal notranslate"><span class="pre">Dickey</span> <span class="pre">Fuller</span></code> aumentada</strong></em> para verificar estacionariedad de una serie temporal.</p></li>
<li><p>La estacionariedad de las series temporales no estacionarias es importante para la predicción de series temporales. Por lo tanto, discutimos dos enfoques diferentes para <em><strong>estacionar las series temporales</strong></em>. En primer lugar, el método de <em><strong>diferenciación, que abarca la primera, la segunda y la diferenciación estacional</strong></em>, se ha descrito para estacionar una serie temporal no estacionaria.</p></li>
<li><p>En segundo lugar, la <em><strong>descomposición de las series temporales utilizando la librería</strong></em> <code class="docutils literal notranslate"><span class="pre">statsmodels.tsa</span></code> para modelos aditivos y multiplicativos. En el siguiente capítulo, se profundiza en las técnicas de suavización exponencial que tratan con datos de series temporales ruidosos.</p></li>
</ul>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "tf"
        },
        kernelOptions: {
            name: "tf",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'tf'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Profesor: Dr. Lihki Rubio</p>
      </div>
    </a>
    <a class="right-next"
       href="exponential_smoothing.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2. </span>Métodos de Suavización Exponencial</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diferentes-tipos-de-datos">1.1. Diferentes tipos de datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos-transversales">1.2. Datos transversales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos-de-series-temporales">1.3. Datos de series temporales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos-de-panel">1.4. Datos de panel</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estructuras-internas-de-las-series-temporales">1.5. Estructuras internas de las series temporales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tendencia-general">1.6. Tendencia general</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estacionalidad">1.7. Estacionalidad</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grafico-de-secuencia-de-series">1.8. Gráfico de secuencia de series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grafico-de-subserie-estacional">1.9. Gráfico de subserie estacional</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graficos-de-cajas-multiples">1.10. Gráficos de cajas múltiples</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cambios-ciclicos">1.11. Cambios cíclicos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#componentes-irregulares">1.12. Componentes irregulares</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-analisis-de-series-temporales">1.13. Modelos de análisis de series temporales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-media-cero">1.14. Modelos de media cero</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#camino-aleatorio">1.15. Camino aleatorio</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-tendencia">1.16. Modelos de tendencia</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-estacionalidad">1.17. Modelos de estacionalidad</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#autocorrelacion-y-autocorrelacion-parcial">1.18. Autocorrelación y autocorrelación parcial</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#experimentos-numericos-acf">1.19. Experimentos numéricos ACF</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-datos-de-series-temporales">1.20. Análisis de datos de series temporales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#procesamiento-avanzado-y-visualizacion-de-datos-de-series-temporales">1.21. Procesamiento avanzado y visualización de datos de series temporales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#remuestreo-de-datos-de-series-temporales">1.22. Remuestreo de datos de series temporales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#agregacion-por-grupos">1.23. Agregación por grupos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estadisticos-moviles">1.24. Estadísticos móviles</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#procesos-estacionarios">1.25. Procesos estacionarios</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transformacion-de-datos-y-ajustes">1.26. Transformación de datos y ajustes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ajustes-estacionales-y-de-tendencia">1.27. Ajustes estacionales y de tendencia</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diferenciacion">1.28. Diferenciación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prueba-de-dickey-fuller">1.29. Prueba de Dickey-Fuller</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descomposicion-de-series-temporales">1.30. Descomposición de series temporales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#medias-moviles-y-efectos-de-suavizacion">1.31. Medias móviles y efectos de suavización</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ajuste-estacional-mediante-media-movil">1.32. Ajuste estacional mediante media móvil</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#media-movil-ponderada">1.33. Media móvil ponderada</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descomposicion-de-series-temporales-mediante-medias-moviles">1.34. Descomposición de series temporales mediante medias móviles</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descomposicion-de-series-temporales-mediante-statsmodels-tsa">1.35. Descomposición de series temporales mediante <code class="docutils literal notranslate"><span class="pre">statsmodels.tsa</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#residual-y-error-de-prediccion">1.36. Residual y error de predicción</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluando-y-monitoreando-el-desempeno-del-modelo-predictivo">1.37. Evaluando y monitoreando el desempeño del modelo predictivo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#elegir-entre-modelos-que-compiten">1.38. Elegir entre modelos que compiten</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Lihki Rubio, Ph.D.
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>Lihki Rubio, Ph.D. All rights reserved.</p>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>