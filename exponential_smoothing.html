
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2. Métodos de Suavización Exponencial &#8212; Análisis y Predicción de Series de Tiempo</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'exponential_smoothing';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/custom.js?v=14184634"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3. Modelos autorregresivos integrados de media móvil" href="arima_model.html" />
    <link rel="prev" title="1. Introducción a las Series de Tiempo" href="statistical_background.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/fotolihki.jpg" class="logo__image only-light" alt="Análisis y Predicción de Series de Tiempo - Home"/>
    <script>document.write(`<img src="_static/fotolihki.jpg" class="logo__image only-dark" alt="Análisis y Predicción de Series de Tiempo - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Profesor: Dr. Lihki Rubio
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="statistical_background.html">1. Introducción a las Series de Tiempo</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">2. Métodos de Suavización Exponencial</a></li>
<li class="toctree-l1"><a class="reference internal" href="arima_model.html">3. Modelos autorregresivos integrados de media móvil</a></li>
<li class="toctree-l1"><a class="reference internal" href="deep_learning.html">4. Deep Learning para la predicción de series temporales</a></li>
<li class="toctree-l1"><a class="reference internal" href="biblio.html">5. Bibliografía</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/exponential_smoothing.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Métodos de Suavización Exponencial</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis">2.1. Análisis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduccion-al-suavizado-de-series-temporales">2.2. Introducción al suavizado de series temporales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#suavizacion-exponencial-de-primer-orden">2.3. Suavización exponencial de primer orden</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#el-valor-de-lambda">2.4. El valor de <span class="math notranslate nohighlight">\(\lambda\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion-ses">2.5. Implementación <span class="math notranslate nohighlight">\(SES\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelado-de-datos-de-series-temporales">2.6. Modelado de datos de series temporales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#suavizacion-exponencial-de-segundo-orden">2.7. Suavización exponencial de segundo orden</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion-des">2.8. Implementación <span class="math notranslate nohighlight">\(DES\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#suavizacion-exponencial-de-alto-orden">2.9. Suavización exponencial de alto orden</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#forecasting">2.10. Forecasting</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#proceso-constante">2.10.1. Proceso constante</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seleccion-de-lambda">2.11. Selección de <span class="math notranslate nohighlight">\(\lambda\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#intervalo-de-prediccion">2.12. Intervalo de predicción</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimacion-de-sigma-e-2">2.13. Estimación de <span class="math notranslate nohighlight">\(\sigma_{e}^{2}\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adaptacion-actualizada-del-factor-de-descuento">2.14. Adaptación actualizada del factor de descuento</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluacion-del-modelo">2.15. Evaluación del modelo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#suavizacion-exponencial-para-datos-estacionales">2.16. Suavización exponencial para datos estacionales</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-estacional-aditivo">2.16.1. Modelo estacional aditivo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-estacional-multiplicativo">2.16.2. Modelo estacional multiplicativo</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#libreria-statsmodels-tsa-holtwinters">2.17. Librería <code class="docutils literal notranslate"><span class="pre">statsmodels.tsa.holtwinters</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-exponential-smoothing">2.17.1. Simple Exponential Smoothing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#double-exponential-smoothing">2.17.2. Double Exponential Smoothing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#triple-exponential-smoothing">2.17.3. Triple Exponential Smoothing</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="metodos-de-suavizacion-exponencial">
<h1><span class="section-number">2. </span>Métodos de Suavización Exponencial<a class="headerlink" href="#metodos-de-suavizacion-exponencial" title="Link to this heading">#</a></h1>
<div class="tip admonition">
<p class="admonition-title">Introducción</p>
<ul class="simple">
<li><p>El presente capítulo trata del <em><strong>suavizado de datos en la señal de series temporales</strong></em>. El capítulo está organizado como sigue:</p>
<ul>
<li><p><em><strong>Introducción al suavizado de series temporales</strong></em></p></li>
<li><p><em><strong>Suavizado exponencial de primer orden</strong></em></p></li>
<li><p><em><strong>Suavizado exponencial de segundo orden</strong></em></p></li>
<li><p><em><strong>Suavizado exponencial de orden superior</strong></em></p></li>
</ul>
</li>
</ul>
</div>
<section id="analisis">
<h2><span class="section-number">2.1. </span>Análisis<a class="headerlink" href="#analisis" title="Link to this heading">#</a></h2>
</section>
<section id="introduccion-al-suavizado-de-series-temporales">
<h2><span class="section-number">2.2. </span>Introducción al suavizado de series temporales<a class="headerlink" href="#introduccion-al-suavizado-de-series-temporales" title="Link to this heading">#</a></h2>
<ul>
<li><p>Los datos de las series temporales se componen de <em><strong>señal y ruido</strong></em>, donde la <em><strong>señal captura la dinámica intrínseca del proceso</strong></em>; sin embargo, el <em><strong>ruido representa el componente no modelado de la señal o error aleatorio no correlacionado</strong></em>, el cual en diferentes tiempos es <em><strong>estadísticamente independiente</strong></em>.</p></li>
<li><p>La dinámica intrínseca de una señal de serie temporal puede ser tan simple como <em><strong>la media del proceso</strong></em> o puede ser una <em><strong>forma funcional compleja</strong></em> dentro de las observaciones, como se representa aquí:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \\[1mm]
    y_{t}=f(t, \boldsymbol{\beta})+\varepsilon_{t},\quad\text{para}\quad i=1,2,3,\dots,T,
\end{split}\]</div>
<p>donde <span class="math notranslate nohighlight">\(y_{t}\)</span> representa las observaciones, <span class="math notranslate nohighlight">\(\boldsymbol{\beta}\)</span> es un vector de parámetros desconocidos, y <span class="math notranslate nohighlight">\(\varepsilon_{t}\)</span> es el <em><strong>error aleatorio no correlacionado</strong></em>, usualmente con media 0 y desviación 1.</p>
</li>
</ul>
<figure class="align-center" id="signal-noise-fig">
<a class="reference internal image-reference" href="_images/signal_noise.png"><img alt="_images/signal_noise.png" src="_images/signal_noise.png" style="width: 589.6px; height: 489.6px;" /></a>
</figure>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(f(t, \boldsymbol{\beta})\)</span> <em><strong>denota la forma funcional de la señal</strong></em>. Un ejemplo puede ser una constante (<em><strong>media</strong></em>) como forma funcional:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
    y_{t}=\mu+\varepsilon_{t}
\]</div>
<ul class="simple">
<li><p>Dado que <span class="math notranslate nohighlight">\(\varepsilon_{t}\)</span> es <em><strong>ruido blanco</strong></em>, este enfoque basado en el suavizado ayuda a <em><strong>separar la forma funcional intrínseca del ruido aleatorio, cancelándolo</strong></em>.</p></li>
<li><p>Los métodos predictivos de suavización pueden considerarse como <em><strong>filtros</strong></em> que toman datos de entrada y <em><strong>separan los componentes de tendencia y de ruido</strong></em>, como se muestra en la <a class="reference internal" href="#fig1-chapter2"><span class="std std-numref">Fig. 2.1</span></a></p></li>
</ul>
<figure class="align-center" id="fig1-chapter2">
<img alt="_images/fig1_chapter2.png" src="_images/fig1_chapter2.png" />
<figcaption>
<p><span class="caption-number">Fig. 2.1 </span><span class="caption-text">Separación de componentes de tendencia y ruido.</span><a class="headerlink" href="#fig1-chapter2" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>Un <em><strong>proceso constante</strong></em> puede ser suavizado reemplazando la observación actual con el mejor estimador para <span class="math notranslate nohighlight">\(\mu\)</span>. Usando el criterio de <em><strong>mínimos cuadrados</strong></em>, definimos la <em><strong>suma de cuadrados de los errores</strong></em> <span class="math notranslate nohighlight">\(SS_{E}\)</span>, para el proceso constante como</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
SS_{E}=\sum_{t=1}^{T}(y_{t}-\mu)^{2}.
\]</div>
<ul>
<li><p>La estimación por mínimos cuadrados de <span class="math notranslate nohighlight">\(\mu\)</span> puede ser calculada <em><strong>derivando</strong></em> <span class="math notranslate nohighlight">\(SS_{E}\)</span> <em><strong>con respecto a</strong></em> <span class="math notranslate nohighlight">\(\mu\)</span> el igualar a cero (<em><strong>verifíquelo</strong></em>). Esto entrega</p>
<div class="math notranslate nohighlight" id="equation-constant-process-ols">
<span class="eqno">(2.1)<a class="headerlink" href="#equation-constant-process-ols" title="Link to this equation">#</a></span>\[
  \hat{\mu}=\frac{1}{T}\sum_{t=1}^{T}y_{t},
  \]</div>
<p>donde <span class="math notranslate nohighlight">\(\hat{\mu}\)</span> <em><strong>es la estimación por mínimos cuadrados</strong></em> de <span class="math notranslate nohighlight">\(\mu\)</span>.</p>
</li>
<li><p>La Ecuación <a class="reference internal" href="#equation-constant-process-ols">(2.1)</a> muestra que la <em><strong>estimación por mínimos cuadrados de</strong></em> <span class="math notranslate nohighlight">\(\mu\)</span>, es, en efecto, el promedio de las observaciones hasta el tiempo <span class="math notranslate nohighlight">\(T\)</span>.</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>El principal problema con el suavizador de la Ecuación <a class="reference internal" href="#equation-constant-process-ols">(2.1)</a> es que <em><strong>reacciona lentamente a procesos de cambios</strong></em>, debido a que <em><strong>acumula más y más puntos de datos ganando algún tipo de inercia</strong></em>. La solución más obvia es de alguna forma descontar datos más antiguos.</p></li>
<li><p>Una solución común es usar la <em><strong>media móvil simple</strong></em> definida por</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-simple-moving-avg">
<span class="eqno">(2.2)<a class="headerlink" href="#equation-simple-moving-avg" title="Link to this equation">#</a></span>\[
M_{T}= \frac{y_{T}+y_{T-1}+\cdots+y_{T-N+1}}{N}=\frac{1}{N}\sum_{t=T-N+1}^{N}y_{t}.
\]</div>
<ul>
<li><p>Una media <em><strong>reaccionará más rápido a cambios si</strong></em> <span class="math notranslate nohighlight">\(N\)</span> <em><strong>es pequeño</strong></em>. Dado que para observaciones no correlacionadas con varianza constante <span class="math notranslate nohighlight">\(\sigma^{2}\)</span> se tiene que</p>
<div class="math notranslate nohighlight" id="equation-variance-sma">
<span class="eqno">(2.3)<a class="headerlink" href="#equation-variance-sma" title="Link to this equation">#</a></span>\[
    \text{Var}(M_{T})=\frac{\sigma^{2}}{N}.
    \]</div>
</li>
<li><p>Dada la Ecuación <a class="reference internal" href="#equation-variance-sma">(2.3)</a>. Si se espera que el <em><strong>proceso es constante</strong></em>, un <em><strong>valor grande de</strong></em> <span class="math notranslate nohighlight">\(N\)</span> puede ser usado, mientras que, un <em><strong>valor pequeño de</strong></em> <span class="math notranslate nohighlight">\(N\)</span> <em><strong>es preferido si el proceso es cambiante</strong></em>.</p></li>
<li><p>Queda como ejercicio para el lector verificar que la <em><strong>función de autocorrelación (ACF)</strong></em> de la media móvil con <span class="math notranslate nohighlight">\(k\)</span>-lags está dada por (<em><strong><code class="docutils literal notranslate"><span class="pre">verifíquelo</span></code></strong></em>)</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-acf-moving-average">
<span class="eqno">(2.4)<a class="headerlink" href="#equation-acf-moving-average" title="Link to this equation">#</a></span>\[\begin{split}
\rho_{k}=
\begin{cases}
\displaystyle{1-\frac{|k|}{N}}, &amp; k&lt;N\\
0, &amp; k\geq N
\end{cases}.
\end{split}\]</div>
</div>
</section>
<section id="suavizacion-exponencial-de-primer-orden">
<h2><span class="section-number">2.3. </span>Suavización exponencial de primer orden<a class="headerlink" href="#suavizacion-exponencial-de-primer-orden" title="Link to this heading">#</a></h2>
<div class="proof theorem admonition" id="th-simple_exp_smoothing">
<p class="admonition-title"><span class="caption-number">Theorem 2.1 </span> (Suavización exponencial simple)</p>
<section class="theorem-content" id="proof-content">
<ul>
<li><p>Dada una serie de tiempo <span class="math notranslate nohighlight">\((y_{t})_{t=1}^{T}\)</span>. Una <em><strong>suavización exponencial ponderada</strong></em> está definida por:</p>
<div class="math notranslate nohighlight" id="equation-eq-simple-exp-smoothing">
<span class="eqno">(2.5)<a class="headerlink" href="#equation-eq-simple-exp-smoothing" title="Link to this equation">#</a></span>\[
    \sum_{t=0}^{T-1}\theta^{t}y_{T-t}=y_{T}+\theta y_{T-1}+\theta^{2}y_{t-2}+\cdots+\theta^{T-1}y_{1}
    \]</div>
<p>donde <span class="math notranslate nohighlight">\(\theta\)</span> satisface <span class="math notranslate nohighlight">\(|\theta|&lt;1\)</span>. Esto es, <em><strong>observaciones pasadas son descontadas de manera geométricamente descendiente</strong></em>.</p>
</li>
<li><p>La <em><strong>suavización exponencial simple</strong></em> <span class="math notranslate nohighlight">\(\tilde{y}_{T}\)</span> está representada por:</p>
<div class="math notranslate nohighlight">
\[
    \tilde{y}_{T}=\lambda y_{T}+(1-\lambda)\tilde{y}_{T-1},\quad\text{donde}\quad\lambda=1-\theta.
    \]</div>
<p><span class="math notranslate nohighlight">\(\lambda\)</span> es conocido como el <em><strong>factor de descuento</strong></em>. Nótese que el factor de descuento <span class="math notranslate nohighlight">\(\lambda\)</span>, representa el peso colocado sobre la última observación <span class="math notranslate nohighlight">\(y_{T}\)</span> y <span class="math notranslate nohighlight">\(1-\lambda\)</span> el peso asignado al valor suavizado de la previa observación <span class="math notranslate nohighlight">\(\tilde{y}_{T-1}\)</span>.</p>
</li>
</ul>
</section>
</div><p><em><strong><code class="docutils literal notranslate"><span class="pre">Demostración</span></code></strong></em></p>
<ul class="simple">
<li><p>Por hipótesis, <em><strong>pasadas observaciones son descontadas en forma geométricamente descendente</strong></em>, con <span class="math notranslate nohighlight">\(|\theta|&lt;1\)</span>. Nótese que el suavizador de la Ecuación <a class="reference internal" href="#equation-eq-simple-exp-smoothing">(2.5)</a> no es una media movil simple. En efecto:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\sum_{t=0}^{T-1}\theta^{t}&amp;=1+\theta+\theta^2+\cdots+\theta^{T-1},\quad\text{multiplicando por}~(1-\theta)\\
(1-\theta)\sum_{t=0}^{T-1}\theta^{t}&amp;=(1-\theta)(1+\theta+\theta^2+\cdots+\theta^{T-1})\\
&amp;=(1+\theta+\theta^2+\cdots+\theta^{T-1})-(\theta+\theta^2+\theta^{3}+\cdots+\theta^{T-1}+\theta^{T})\\[3mm]
&amp;=1-\theta^{T}\Longrightarrow\\
\sum_{t=0}^{T-1}\theta^{t}&amp;=\frac{1-\theta^{T}}{1-\theta}.
\end{align*}
\end{split}\]</div>
<ul>
<li><p>Nótese que la sumatoria:</p>
<div class="math notranslate nohighlight">
\[
    \sum_{t=0}^{T-1}\theta^{t}=\frac{1-\theta^{T}}{1-\theta},
    \]</div>
<p>no necesariamente es igual a 1 (<em>propiedad de los promedios</em>). Esto puede ser ajustado multiplicando la Ecuación <a class="reference internal" href="#equation-eq-simple-exp-smoothing">(2.5)</a> por <span class="math notranslate nohighlight">\((1-\theta)/(1-\theta^{T})\)</span>.</p>
</li>
</ul>
<ul class="simple">
<li><p>Además, dado que <span class="math notranslate nohighlight">\((1-\theta)/(1-\theta^{T})\rightarrow 1-\theta\)</span> para valores grandes de <span class="math notranslate nohighlight">\(T\)</span>, <span class="math notranslate nohighlight">\(~|\theta|&lt;1\)</span>. Entonces, la Ecuación <a class="reference internal" href="#equation-eq-simple-exp-smoothing">(2.5)</a> puede reescribirse como:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\tilde{y}_{T}&amp;=\frac{1-\theta}{1-\theta^{T}}\sum_{t=0}^{T-1}\theta^{t}y_{T-t}\\
&amp;=(1-\theta)\sum_{t=0}^{T-1}\theta^{t}y_{T-t},~\text{para valores grandes de $T$}\\
&amp;=(1-\theta)(y_{T}+\theta y_{T-1}+\theta^{2}y_{T-2}+\cdots+\theta^{T-1}y_{1})
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p>Entonces la <em><strong>suavización exponencial simple</strong></em> está dada por</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-eq-simple-exp-smoothing2">
<span class="eqno">(2.6)<a class="headerlink" href="#equation-eq-simple-exp-smoothing2" title="Link to this equation">#</a></span>\[
\tilde{y}_{T}=(1-\theta)(y_{T}+\theta y_{T-1}+\theta^{2}y_{T-2}+\cdots+\theta^{T-1}y_{1})
\]</div>
<ul class="simple">
<li><p>Una <em><strong>expresión alternativa</strong></em> para la suavización exponencial simple es:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\tilde{y}_{T}&amp;=(1-\theta)(y_{T}+\theta y_{T-1}+\theta^{2}y_{T-2}+\cdots+\theta^{T-1}y_{1}\\
&amp;=(1-\theta)y_{T}+(1-\theta)(\theta y_{T-1}+\theta^{2}y_{T-2}+\cdots+\theta^{T-1}y_{1})\\
&amp;=(1-\theta)y_{T}+\theta(1-\theta)(y_{T-1}+\theta y_{T-2}+\cdots+\theta^{T-2}y_{1})\\
&amp;=(1-\theta)y_{T}+\theta\tilde{y}_{T-1}.
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p>Esto es, la suavización exponencial de primer orden, puede verse como <em><strong>combinación lineal de la observación actual y la observación suavizada en un tiempo previo</strong></em>. Definiendo <span class="math notranslate nohighlight">\(\lambda=1-\theta\)</span>, (<em><strong>factor de corrección</strong></em>) se tiene que:</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-eq-simple-exp-smoothing3">
<span class="eqno">(2.7)<a class="headerlink" href="#equation-eq-simple-exp-smoothing3" title="Link to this equation">#</a></span>\[
\tilde{y}_{T}=\lambda y_{T}+(1-\lambda)\tilde{y}_{T-1}.
\]</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Análogamente a la longitud del periodo en la media movil, <em><strong>un asunto importante para la suavización exponencial es la selección del factor de descuento</strong></em> <span class="math notranslate nohighlight">\(\lambda\)</span>. Además, a partir de la Ecuación <a class="reference internal" href="#equation-eq-simple-exp-smoothing3">(2.7)</a> podemos observa que el cálculo de <span class="math notranslate nohighlight">\(\tilde{y}_{1}\)</span> va a requerir conocer <span class="math notranslate nohighlight">\(\tilde{y}_{0}\)</span>.</p>
</div>
<div class="proof theorem admonition" id="th-initial-value-simple-exp-smoothing">
<p class="admonition-title"><span class="caption-number">Theorem 2.2 </span> (Selección de <span class="math notranslate nohighlight">\(\tilde{y}_{0}\)</span>)</p>
<section class="theorem-content" id="proof-content">
<p>Dada una serie de tiempo <span class="math notranslate nohighlight">\((y_{t})_{t=1}^{T}\)</span>, donde <span class="math notranslate nohighlight">\(T\)</span> es grande, la contribución de <span class="math notranslate nohighlight">\(\tilde{y}_{0}\)</span> a <span class="math notranslate nohighlight">\(\tilde{y}_{T}\)</span> es mínima. Por lo tanto, <em><strong>la estimación de</strong></em> <span class="math notranslate nohighlight">\(\tilde{y}_{0}\)</span> <em><strong>tiene poca influencia sobre la suavización</strong></em>. Sin embargo, dos estimaciones de <span class="math notranslate nohighlight">\(\tilde{y}_{0}\)</span> comunmente usadas en las aplicaciones son las siguientes:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\tilde{y}_{0}=y_{1}\)</span>: Si los cambios esperados del proceso ocurren temprano y rápido, esta selección para el valor inicial de <span class="math notranslate nohighlight">\(\tilde{y}_{T}\)</span> es razonable.</p></li>
<li><p><span class="math notranslate nohighlight">\(\tilde{y}_{0}=\overline{y}\)</span>: Tomar el promedio de los datos disponibles. Si el proceso es constante, al menos al inicio, este sería el valor mas adecuado.</p></li>
</ol>
</section>
</div><p><strong><code class="docutils literal notranslate"><span class="pre">Demostración</span></code></strong></p>
<ul class="simple">
<li><p>Dado que <span class="math notranslate nohighlight">\(\tilde{y}_{0}\)</span> es necesario en el calculo recursivo que inicia con: <span class="math notranslate nohighlight">\(\tilde{y}_{1}=\lambda y_{1}+(1-\lambda)\tilde{y}_{0}\)</span>, estimamos su valor a partir de la Ecuación <a class="reference internal" href="#equation-eq-simple-exp-smoothing3">(2.7)</a></p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\tilde{y}_{1}&amp;=\lambda y_{1}+(1-\lambda)\tilde{y}_{0}\\
\tilde{y}_{2}&amp;=\lambda y_{2}+(1-\lambda)\tilde{y}_{1}=\lambda y_{2}+(1-\lambda)(\lambda y_{1}+(1-\lambda)\tilde{y}_{0})=\lambda(y_{2}+(1-\lambda)y_{1})+(1-\lambda)^{2}\tilde{y}_{0}\\
\tilde{y}_{3}&amp;=\lambda y_{3}+(1-\lambda)\tilde{y}_{2}=\lambda y_{3}+(1-\lambda)(\lambda(y_{2}+(1-\lambda)\tilde{y}_{1})+(1-\lambda)^{2}\tilde{y}_{0})\\
&amp;=\lambda(y_{3}+(1-\lambda)y_{2}+(1-\lambda)^{2}y_{1})+(1-\lambda)^{3}\tilde{y}_{0}\\
&amp;\vdots\\
\tilde{y}_{T}&amp;=\lambda(y_{T}+(1-\lambda)y_{T-1}+(1-\lambda)^{2}y_{T-2}+\cdots+(1-\lambda)^{T-1}y_{1})+(1-\lambda)^{T}\tilde{y}_{0}
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p>Por lo tanto, cuando <span class="math notranslate nohighlight">\(T\)</span> se hace grande, <span class="math notranslate nohighlight">\(~(1-\lambda)^{T}\)</span> se hace pequeño, esto es, la contribución de <span class="math notranslate nohighlight">\(\tilde{y}_{0}\)</span> a <span class="math notranslate nohighlight">\(\tilde{y}_{T}\)</span> es mínima. Esto es, la estimación de <span class="math notranslate nohighlight">\(\tilde{y}_{0}\)</span> <em><strong>no es relevante para un conjunto grande de datos</strong></em>.</p></li>
</ul>
</section>
<section id="el-valor-de-lambda">
<h2><span class="section-number">2.4. </span>El valor de <span class="math notranslate nohighlight">\(\lambda\)</span><a class="headerlink" href="#el-valor-de-lambda" title="Link to this heading">#</a></h2>
<div class="admonition-observacion admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>En general, cuando <span class="math notranslate nohighlight">\(\lambda\)</span> tiende a 1, y se hace más hincapié en la última observación, los <em><strong>valores suavizados se aproximarán a las observaciones originales</strong></em>.</p></li>
<li><p>Si <span class="math notranslate nohighlight">\(\lambda=0\)</span>, los valores suavizados serán todos igual a una constante, a saber <span class="math notranslate nohighlight">\(\tilde{y}_{0}\)</span>. Esta línea constante sería la <em><strong>versión más suavizada</strong></em> de cualquier patrón que siga la serie de tiempo original.</p></li>
<li><p>Para <span class="math notranslate nohighlight">\(\lambda=1\)</span>, tenemos <span class="math notranslate nohighlight">\(\tilde{y}_{T}=y_{T}\)</span> y este representará la <em><strong>versión menos suavizada</strong></em> de la serie de tiempo original.</p></li>
<li><p>Con base en la selección de <span class="math notranslate nohighlight">\(\lambda\)</span>, esperamos acordemente que la varianza varíe entre 0 y la varianza de la serie de tiempo original.</p></li>
</ul>
</div>
<ul class="simple">
<li><p>Nótese que bajo el supuesto de independencia y varianza constante tenemos que</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\text{Var}(\tilde{y}_{T}) &amp;= \text{Var}\left(\lambda\sum_{t=0}^{\infty}(1-\lambda)^{t}y_{T-t}\right)\\
&amp;= \lambda^{2}\sum_{t=0}^{\infty}(1-\lambda)^{2t}\text{Var}(y_{T-t})\\
&amp;= \lambda^{2}\sum_{t=0}^{\infty}(1-\lambda)^{2t}\text{Var}(y_{T})\\
&amp;= \text{Var}(y_{T})\lambda^{2}\sum_{t=0}^{\infty}(1-\lambda)^{2t}
\end{align}
\end{split}\]</div>
<ul class="simple">
<li><p>Observe que</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\sum_{t=0}^{T-1}(1-\lambda)^{2t}=1+(1-\lambda)^{2}+(1-\lambda)^{4}+\cdots+(1-\lambda)^{2(T-1)}
\]</div>
<ul class="simple">
<li><p>Multiplicando por <span class="math notranslate nohighlight">\(1-(1-\lambda)^{2}\)</span> se tiene que:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
(1-(1-\lambda)^{2})\sum_{t=0}^{T-1}(1-\lambda)^{2t} &amp;= 1+(1-\lambda)^{2}+(1-\lambda)^{4}+\cdots+(1-\lambda)^{2(T-1)}\\
&amp;- ((1-\lambda)^{2}+(1-\lambda)^{4}+\cdots+(1-\lambda)^{2T})\\[3mm]
&amp;= 1-(1-\lambda)^{2T}\rightarrow 1,\quad\text{para valores grandes de}~T, |1-\lambda|&lt;1\Rightarrow\\
\sum_{t=0}^{T-1}(1-\lambda)^{2t} &amp;= \frac{1}{\lambda(2-\lambda)}
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p>Por lo tanto,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\begin{align}
\text{Var}(\tilde{y}_{T}) = \text{Var}(y_{T})\lambda^{2}\sum_{t=0}^{\infty}(1-\lambda)^{2t} = \text{Var}(y_{T})\lambda^{2}\frac{1}{\lambda(2-\lambda)} = \frac{\lambda}{2-\lambda}\text{Var}(y_{T})
\end{align}
\]</div>
<ul class="simple">
<li><p>Nótese que si <span class="math notranslate nohighlight">\(\lambda\rightarrow1\)</span>, <span class="math notranslate nohighlight">\(\text{Var}(\tilde{y}_{T})\rightarrow\text{Var}(y_{T})\)</span>, y si <span class="math notranslate nohighlight">\(\lambda\rightarrow0\)</span>, <span class="math notranslate nohighlight">\(\text{Var}(\tilde{y}_{T})\rightarrow0\)</span>. La pregunta ahora es, <em><strong>¿cuánto suavizado se necesita?. En la literatura se recomienda <span class="math notranslate nohighlight">\(\lambda\)</span> entre 0.1 y 0.4</strong></em> y, de hecho, funcionan bien en la práctica. Un método más riguroso para encontrar el valor <span class="math notranslate nohighlight">\(\lambda\)</span> se discutirá más adelante en este capítulo.</p></li>
<li><p>Como <em><strong>medidas de precisión</strong></em> usaremos las siguientes métricas las cuales vienen ya implementadas en <code class="docutils literal notranslate"><span class="pre">Python</span></code>; <code class="docutils literal notranslate"><span class="pre">MAPE,</span> <span class="pre">MAD</span></code> y <code class="docutils literal notranslate"><span class="pre">MSD</span></code>.</p></li>
<li><p>El <em><strong>error porcentual medio absoluto (MAPE)</strong></em> es el cambio porcentual medio absoluto entre el valor predicho, esto es <span class="math notranslate nohighlight">\(\tilde{y}_{t-1}:=\tilde{y}_{t}(t-1)\)</span>, para una predicción <em><strong>one-step-ahead</strong></em> y el valor real dado por</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\text{MAPE}=\frac{\displaystyle{\sum_{t=1}^{T}|(y_{t}-\tilde{y}_{t-1})/y_{t}|}}{T}\times 100,\quad (y_{t}\neq 0).
\]</div>
<ul class="simple">
<li><p>La <em><strong>desviación media absoluta (MAD)</strong></em> es la diferencia absoluta media entre los valores predichos y los verdaderos, dada por</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\text{MAD}=\frac{\displaystyle{\sum_{t=1}^{T}|(y_{t}-\tilde{y}_{t-1})|}}{T}.
\]</div>
<ul class="simple">
<li><p>La <em><strong>desviación cuadrática media (MSD)</strong></em> es la diferencia cuadrática media entre los valores predichos y los verdaderos, dada por</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\text{MSD}=\frac{\displaystyle{\sum_{t=1}^{T}(y_{t}-\tilde{y}_{t-1})^{2}}}{T}.
\]</div>
</section>
<section id="implementacion-ses">
<h2><span class="section-number">2.5. </span>Implementación <span class="math notranslate nohighlight">\(SES\)</span><a class="headerlink" href="#implementacion-ses" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;darkgrid&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Data/main/DJIA_Jan2016_Dec2016.xlsx&#39;</span>
<span class="n">djia_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">djia_df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span>
<span class="n">djia_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">djia_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-01-04</th>
      <td>17405.480469</td>
      <td>17405.480469</td>
      <td>16957.630859</td>
      <td>17148.939453</td>
      <td>17148.939453</td>
      <td>148060000</td>
    </tr>
    <tr>
      <th>2016-01-05</th>
      <td>17147.500000</td>
      <td>17195.839844</td>
      <td>17038.609375</td>
      <td>17158.660156</td>
      <td>17158.660156</td>
      <td>105750000</td>
    </tr>
    <tr>
      <th>2016-01-06</th>
      <td>17154.830078</td>
      <td>17154.830078</td>
      <td>16817.619141</td>
      <td>16906.509766</td>
      <td>16906.509766</td>
      <td>120250000</td>
    </tr>
    <tr>
      <th>2016-01-07</th>
      <td>16888.359375</td>
      <td>16888.359375</td>
      <td>16463.630859</td>
      <td>16514.099609</td>
      <td>16514.099609</td>
      <td>176240000</td>
    </tr>
    <tr>
      <th>2016-01-08</th>
      <td>16519.169922</td>
      <td>16651.890625</td>
      <td>16314.570313</td>
      <td>16346.450195</td>
      <td>16346.450195</td>
      <td>141850000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">djia_ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">djia_df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">djia_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">djia_ts</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date
2016-01-04    17148.939453
2016-01-05    17158.660156
2016-01-06    16906.509766
2016-01-07    16514.099609
2016-01-08    16346.450195
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;text.usetex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">djia_ts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Dow Jones Industrial Average between Jan 2016 - Dec 2016&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Closing Value&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f22c1c762a4c1300ac4cee2a15609ef6334a5143959d7194a56dae51c6e9a0f6.png" src="_images/f22c1c762a4c1300ac4cee2a15609ef6334a5143959d7194a56dae51c6e9a0f6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">firstsmooth</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">ytilde</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ytilde</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">lambda_</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">lambda_</span><span class="p">)</span> <span class="o">*</span> <span class="n">start</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
        <span class="n">ytilde</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lambda_</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">lambda_</span><span class="p">)</span> <span class="o">*</span> <span class="n">ytilde</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">ytilde</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dji_smooth1</span> <span class="o">=</span> <span class="n">firstsmooth</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">djia_ts</span><span class="p">,</span> <span class="n">lambda_</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">djia_ts</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Dow Jones&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dji_smooth1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SES $\lambda=0.4$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Dow Jones&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/62d7801cc36c1d312d6c7fb73283b4871bdd0df2f410c7abe54afc145af09c32.png" src="_images/62d7801cc36c1d312d6c7fb73283b4871bdd0df2f410c7abe54afc145af09c32.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">measacc_fs</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">firstsmooth</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">)</span>
    <span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">yh</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">out</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
    <span class="n">prederr</span> <span class="o">=</span> <span class="n">yh</span> <span class="o">-</span> <span class="n">out</span>
    <span class="n">SSE</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">prederr</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">MAPE</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">prederr</span> <span class="o">/</span> <span class="n">yh</span><span class="p">))</span> <span class="o">/</span> <span class="n">T</span>
    <span class="n">MAD</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">prederr</span><span class="p">))</span> <span class="o">/</span> <span class="n">T</span>
    <span class="n">MSD</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">prederr</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">T</span>
    <span class="n">ret1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s2">&quot;SSE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">SSE</span><span class="p">],</span>
        <span class="s2">&quot;MAPE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">MAPE</span><span class="p">],</span>
        <span class="s2">&quot;MAD&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">MAD</span><span class="p">],</span>
        <span class="s2">&quot;MSD&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">MSD</span><span class="p">]</span>
    <span class="p">})</span>
    <span class="n">ret1</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ret1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">measacc_fs</span><span class="p">(</span><span class="n">djia_ts</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SSE</th>
      <th>MAPE</th>
      <th>MAD</th>
      <th>MSD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6.844383e+06</td>
      <td>0.689939</td>
      <td>121.602389</td>
      <td>27160.251204</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.tsa.holtwinters</span> <span class="kn">import</span> <span class="n">ExponentialSmoothing</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">measacc_hw</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">fit</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">smoothing_level</span><span class="o">=</span><span class="n">lambda_</span><span class="p">)</span>
    <span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">yh</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">fit</span><span class="o">.</span><span class="n">fittedvalues</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">y_pred</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
    <span class="n">prederr</span> <span class="o">=</span> <span class="n">yh</span> <span class="o">-</span> <span class="n">out</span>
    <span class="n">SSE</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">prederr</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">MAPE</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">prederr</span> <span class="o">/</span> <span class="n">yh</span><span class="p">))</span> <span class="o">/</span> <span class="n">T</span>
    <span class="n">MAD</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">prederr</span><span class="p">))</span> <span class="o">/</span> <span class="n">T</span>
    <span class="n">MSD</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">prederr</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">T</span>
    <span class="n">ret1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s2">&quot;SSE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">SSE</span><span class="p">],</span>
        <span class="s2">&quot;MAPE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">MAPE</span><span class="p">],</span>
        <span class="s2">&quot;MAD&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">MAD</span><span class="p">],</span>
        <span class="s2">&quot;MSD&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">MSD</span><span class="p">]</span>
    <span class="p">})</span>
    <span class="n">ret1</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ret1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">measacc_hw</span><span class="p">(</span><span class="n">djia_ts</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SSE</th>
      <th>MAPE</th>
      <th>MAD</th>
      <th>MSD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.084431e+07</td>
      <td>0.876061</td>
      <td>154.763888</td>
      <td>43032.984921</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>En este caso, se obtuvo un MAPE del 0.87% lo cual significa que, <em><strong>en promedio, las predicciones tienen un error del 0.87% en relación con los valores reales</strong></em>, el cual es más alto que el implementado en la función <code class="docutils literal notranslate"><span class="pre">firstsmooth</span></code>.</p></li>
</ul>
</section>
<section id="modelado-de-datos-de-series-temporales">
<h2><span class="section-number">2.6. </span>Modelado de datos de series temporales<a class="headerlink" href="#modelado-de-datos-de-series-temporales" title="Link to this heading">#</a></h2>
<div class="proof theorem admonition" id="th-constant-process-simple-exp-smoothing">
<p class="admonition-title"><span class="caption-number">Theorem 2.3 </span></p>
<section class="theorem-content" id="proof-content">
<ul>
<li><p>Considere un <em><strong>proceso constante</strong></em>, esto es, un proceso donde los datos de series de tiempo se espera que varíen en torno a un nivel constante, con fluctuaciones aleatorias, las cuales son caracterizadas usualmente por <em><strong>errores no correlacionados con media 0 y varianza constante</strong></em>.</p></li>
<li><p>La clase general de modelos puede expresarse como</p>
<div class="math notranslate nohighlight">
\[
    y_{t}=f(t, \boldsymbol{\beta})+\varepsilon_{t},
    \]</div>
<p>donde <span class="math notranslate nohighlight">\(\boldsymbol{\beta}\)</span> es un vector de parámetros desconocidos y <span class="math notranslate nohighlight">\(\varepsilon_{t}\)</span> representa errores no correlacionados.</p>
</li>
<li><p>El <em><strong>proceso constante</strong></em> es miembro de esta clase general:</p>
<div class="math notranslate nohighlight">
\[
    y_{t}=\beta_{0}+\varepsilon_{t},
    \]</div>
<p>donde <span class="math notranslate nohighlight">\(\beta_{0}\)</span> es igual a <span class="math notranslate nohighlight">\(\mu\)</span>.</p>
</li>
<li><p>Entonces, la <em><strong>estimación de mínimos cuadrados ponderada</strong></em> de <span class="math notranslate nohighlight">\(\beta_{0}\)</span> en el proceso constante, con <em><strong>pesos exponencialmente decrecientes en el tiempo</strong></em> es</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\hat{\beta}_{0}=(1-\theta)\sum_{t=0}^{T-1}\theta^{t}y_{T-t}.
\]</div>
</section>
</div><p><strong><code class="docutils literal notranslate"><span class="pre">Demostración</span></code></strong></p>
<ul class="simple">
<li><p>Consideremos la <em><strong>suma de errores cuadráticos</strong></em> para el proceso constante, dada por</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
SS_{E}=\sum_{t=1}^{T}(y_{t}-\mu)^{2}
\]</div>
<ul class="simple">
<li><p>Si afirmamos que no todas las observaciones deberían tener igual influencia sobre la suma, introducimos una cadena de <em><strong>pesos geométricamente decrecientes en tiempo</strong></em></p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-error-sq-sum1">
<span class="eqno">(2.8)<a class="headerlink" href="#equation-error-sq-sum1" title="Link to this equation">#</a></span>\[
SS_{E}^{\star}=\sum_{t=0}^{T-1}\theta^{t}(y_{T-t}-\beta_{0})^{2},~\text{donde}~|\theta|&lt;1.
\]</div>
<ul class="simple">
<li><p>Derivando la Ecuación <a class="reference internal" href="#equation-error-sq-sum1">(2.8)</a> con respecto a <span class="math notranslate nohighlight">\(\beta_{0}\)</span> e igualando a cero obtenemos el <em><strong>estimador por mínimos cuadrados</strong></em> para <span class="math notranslate nohighlight">\(\beta_{0}\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\begin{align*}
\frac{\partial SS_{E}^{\star}}{\partial\beta_{0}} &amp;= \frac{\partial}{\partial\beta_{0}}\left(\sum_{t=0}^{T-1}\theta^{t}(y_{T-t}-\hat{\beta}_{0})^{2}\right)=-2\sum_{t=0}^{T-1}\theta^{t}(y_{T-t}-\hat{\beta}_{0})=0
\end{align*}
\]</div>
<ul class="simple">
<li><p>Dado que <span class="math notranslate nohighlight">\(\sum_{t=0}^{T-1}\theta^{t}=(1-\theta^{T})/(1-\theta)\)</span>, entonces</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\hat{\beta}_{0}=\frac{1-\theta}{1-\theta^{T}}\sum_{t=0}^{T-1}\theta^{t}y_{T-t}\rightarrow(1-\theta)\sum_{t=0}^{T-1}\theta^{t}y_{T-t},\quad\text{para valores grandes de}~T.
\]</div>
<ul class="simple">
<li><p>Nótese que <span class="math notranslate nohighlight">\(\hat{\beta}_{0}=\tilde{y}_{T}\)</span>. Esto es, el proceso de suavización exponencial simple en efecto provee una <em><strong>estimación de mínimos cuadrados ponderada</strong></em> de <span class="math notranslate nohighlight">\(\beta_{0}\)</span>, para el proceso constante con pesos que son exponencialmente decrecientes en el tiempo.</p></li>
</ul>
<div class="admonition-observacion admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>Retomando con nuestra clase de modelo general <span class="math notranslate nohighlight">\(y_{t}=f(t; \boldsymbol{\beta})+\varepsilon_{t},~f(t, \boldsymbol{\beta})\)</span> puede ser cualquier función de <span class="math notranslate nohighlight">\(t\)</span>.</p></li>
<li><p>Por ejemplo, para <em><strong>series de tiempo no estacionarias</strong></em>, es mas conveniente considerar una <em><strong>familia polinómica</strong></em>, donde el proceso constante es el modelos mas simple que podemos considerar.</p></li>
</ul>
</div>
</section>
<section id="suavizacion-exponencial-de-segundo-orden">
<h2><span class="section-number">2.7. </span>Suavización exponencial de segundo orden<a class="headerlink" href="#suavizacion-exponencial-de-segundo-orden" title="Link to this heading">#</a></h2>
<div class="proof theorem admonition" id="th-linear-tendency-simple-exp-smoothing">
<p class="admonition-title"><span class="caption-number">Theorem 2.4 </span></p>
<section class="theorem-content" id="proof-content">
<ul>
<li><p>Un modelo apropiado en tiempo para <em><strong>tendencias lineales</strong></em> está dado por:</p>
<div class="math notranslate nohighlight">
\[
    y_{t}=\beta_{0}+\beta_{1}t+\varepsilon_{t},
    \]</div>
<p>donde <span class="math notranslate nohighlight">\(\varepsilon_{t}\)</span> es no correlacionado con media 0 y varianza constante <span class="math notranslate nohighlight">\(\sigma_{\varepsilon}^{2}\)</span>.</p>
</li>
<li><p>Demuestre que el suavizador exponencial simple es un estimador sesgado para el <em><strong>modelo de tendencia lineal</strong></em> y la cantidad de sesgo es: <span class="math notranslate nohighlight">\(-(1-\lambda)\beta_{1}/\lambda\)</span>, donde</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\text{E}(\tilde{y}_{T})=\beta_{0}+\beta_{1}T-\frac{1-\lambda}{\lambda}\beta_{1}=\text{E}(y_{T})-\frac{1-\lambda}{\lambda}\beta_{1}.
\]</div>
<ul>
<li><p>Dada la <em><strong>suavización exponencial de segundo orden</strong></em> definida por:</p>
<div class="math notranslate nohighlight">
\[
    \tilde{y}_{T}^{(2)}=\lambda\tilde{y}_{T}^{(1)}+(1-\lambda)\tilde{y}_{T-1}^{(2)},
    \]</div>
<p>donde <span class="math notranslate nohighlight">\(\tilde{y}_{T}^{(1)}, \tilde{y}_{T}^{(2)}\)</span> denotan las suavizaciones exponenciales de primer y segundo orden respectivamente, demuestre que el predictor de <span class="math notranslate nohighlight">\(\tilde{y}_{T}\)</span> está dado por</p>
<div class="math notranslate nohighlight">
\[
    \tilde{y}_{T}=2\tilde{y}_{T}^{(1)}-\tilde{y}_{T}^{(2)}.
    \]</div>
</li>
<li><p>Puede demostrarse  además que <span class="math notranslate nohighlight">\(\tilde{y}_{T}\)</span> es insesgado.</p></li>
</ul>
</section>
</div><p><strong><code class="docutils literal notranslate"><span class="pre">Demostración</span></code></strong></p>
<ul class="simple">
<li><p>Bajo el supuesto de independencia sobre <span class="math notranslate nohighlight">\((y_{t})_{t=1}^{\infty}\)</span>, calculamos suavización exponencial para datos de series de tiempo que exhiben tendencia lineal</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\text{E}(\tilde{y}_{T})=\text{E}\left(\lambda\sum_{t=0}^{T-1}(1-\lambda)^{t}y_{T-t}\right)=\lambda\sum_{t=0}^{T-1}(1-\lambda)^{t}\text{E}(y_{T-t}).
\]</div>
<ul class="simple">
<li><p>Dado que para la tendencia lineal: <span class="math notranslate nohighlight">\(\text{E}(y_{t})=\text{E}(\beta_{0}+\beta_{1}t+\varepsilon_{t})=\beta_{0}+\beta_{1}t\)</span>, entonces</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{E}(\tilde{y}_{T}) &amp;= \lambda\sum_{t=0}^{T-1}(1-\lambda)^{t}(\beta_{0}+\beta_{1}(T-t))\\
&amp;= \lambda\sum_{t=0}^{T-1}(1-\lambda)^{t}(\beta_{0}+\beta_{1}T)-\lambda\sum_{t=0}^{T-1}(1-\lambda)^{t}(\beta_{1}t)\\
&amp;= (\beta_{0}+\beta_{1}T)\lambda\sum_{t=0}^{T-1}(1-\lambda)^{t}-\lambda\beta_{1}\sum_{t=0}^{T-1}(1-\lambda)^{t}t.
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p>Dado que <span class="math notranslate nohighlight">\(|1-\lambda|&lt;1\)</span> se tiene que <span class="math notranslate nohighlight">\(\sum_{t=0}^{T-1}(1-\lambda)^{t}=1/(1-(1-\lambda))=1/\lambda\)</span>. Nótese además que</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\sum_{t=0}^{\infty}(1-\lambda)^{t}t&amp;=(1-\lambda)\sum_{t=0}^{\infty}t(1-\lambda)^{t-1}\\
&amp;= -(1-\lambda)\sum_{t=0}^{\infty}\frac{\partial}{\partial\lambda}(1-\lambda)^{t}\\
&amp;= -(1-\lambda)\frac{\partial}{\partial\lambda}\left(\sum_{t=0}^{\infty}(1-\lambda)^{t}\right)\\
&amp;= -(1-\lambda)\frac{\partial}{\partial\lambda}\left(\frac{1}{1-(1-\lambda)}\right)\\
&amp;= -(1-\lambda)\frac{\partial}{\partial\lambda}\left(\frac{1}{\lambda}\right)=-(1-\lambda)\left(-\frac{1}{\lambda^{2}}\right)=\frac{1-\lambda}{\lambda^{2}}.
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p>Entonces</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\text{E}(\tilde{y}_{T})=(\beta_{0}+\beta_{1}T)\lambda\left(\frac{1}{\lambda}\right)-\lambda\beta_{1}\left(\frac{1-\lambda}{\lambda^{2}}\right)=(\beta_{0}+\beta_{1}T)-\frac{1-\lambda}{\lambda}\beta_{1}=\text{E}(y_{T})-\frac{1-\lambda}{\lambda}\beta_{1}.
\]</div>
<ul class="simple">
<li><p>Esto es, la suavización exponencial simple es <em><strong>sesgada como estimador</strong></em> y la cantidad de sesgo está dada por <span class="math notranslate nohighlight">\(-(1-\lambda)\beta_{1}/\lambda\)</span>, la cual puede generar <em><strong>errores de subestimación</strong></em>.</p></li>
<li><p>Una solución puede ser usar <span class="math notranslate nohighlight">\(\lambda\)</span> grande, ya que <span class="math notranslate nohighlight">\((1-\lambda)/\lambda\rightarrow0\)</span> cuando <span class="math notranslate nohighlight">\(\lambda\rightarrow1\)</span>. Técnicas autoadaptativas para <span class="math notranslate nohighlight">\(\lambda\)</span> pueden ser estudiadas, las cuales sigan los cambios en el proceso.</p></li>
</ul>
<ul>
<li><p>Dado que la suavización de segundo orden está dada por</p>
<div class="math notranslate nohighlight">
\[
    \tilde{y}_{T}^{(2)}=\lambda\tilde{y}_{T}^{(1)}+(1-\lambda)y_{T-1}^{(2)},
    \]</div>
<p>esto es, <span class="math notranslate nohighlight">\(\tilde{y}_{T}^{(2)}\)</span> es obtenida aplicando suavización exponencial simple a <span class="math notranslate nohighlight">\(\tilde{y}_{T}\)</span>.</p>
</li>
</ul>
<ul class="simple">
<li><p>Por <em><strong>motivos de derivación de la expresión, consideramos el mismo</strong></em> <span class="math notranslate nohighlight">\(\lambda\)</span> para <span class="math notranslate nohighlight">\(\tilde{y}_{T}^{(1)}\)</span> y <span class="math notranslate nohighlight">\(\tilde{y}_{t}^{(2)}\)</span>. Dado que la suavización exponencial de primer orden es sesgada, su suavización (<em><strong>suavización de segundo orden</strong></em>) también es sesgada. Entonces</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\text{E}(\tilde{y}_{T}^{(2)})=\text{E}(\tilde{y}_{T}^{(1)})-\frac{1-\lambda}{\lambda}\beta_{1}. 
\]</div>
<ul class="simple">
<li><p>Además</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\frac{1-\lambda}{\lambda}\beta_{1}=\text{E}(\tilde{y}_{T}^{(1)})-E(\tilde{y}_{T}^{(2)})\Rightarrow\tilde{y}_{T}^{(1)}-\tilde{y}_{T}^{(2)}=\frac{1-\lambda}{\lambda}\beta_{1},~\text{entonces}
\]</div>
<div class="math notranslate nohighlight" id="equation-beta1-estimation-eq">
<span class="eqno">(2.9)<a class="headerlink" href="#equation-beta1-estimation-eq" title="Link to this equation">#</a></span>\[
\textcolor{red}{\hat{\beta}_{1, T}=\frac{\lambda}{1-\lambda}(\tilde{y}_{T}^{(1)}-\tilde{y}_{T}^{(2)})}.
\]</div>
<ul class="simple">
<li><p>Usando la Ecuación <a class="reference internal" href="#equation-beta1-estimation-eq">(2.9)</a> tenemos que: <span class="math notranslate nohighlight">\(\text{E}(\tilde{y}_{T}^{(1)})=(\hat{\beta}_{0, T}+\hat{\beta}_{1, T}T)-(1-\lambda)\hat{\beta}_{1, T}/\lambda\)</span>, entonces, análogamente</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-beta0-estimation-eq">
<span class="eqno">(2.10)<a class="headerlink" href="#equation-beta0-estimation-eq" title="Link to this equation">#</a></span>\[
\textcolor{red}{\hat{\beta}_{0, T}=\tilde{y}_{T}^{(1)}-T\hat{\beta}_{1, T}+\displaystyle{\frac{1-\lambda}{\lambda}}\hat{\beta}_{1, T}.}
\]</div>
<ul class="simple">
<li><p>Reescribiendo <span class="math notranslate nohighlight">\(\hat{\beta}_{0, T}\)</span> en términos de <span class="math notranslate nohighlight">\(\tilde{y}_{T}^{(1)}\)</span> y <span class="math notranslate nohighlight">\(\tilde{y}_{T}^{(2)}\)</span> obtenemos</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\hat{\beta}_{0, T} &amp;= \tilde{y}_{T}^{(1)}-T\left(\frac{\lambda}{1-\lambda}(\tilde{y}_{T}^{(1)}-\tilde{y}_{T}^{(2)})\right)+\frac{1-\lambda}{\lambda}\left(\frac{\lambda}{1-\lambda}(\tilde{y}_{T}^{(1)}-\tilde{y}_{T}^{(2)})\right)\\
&amp;= \tilde{y}_{T}^{(1)}-T\frac{\lambda}{1-\lambda}(\tilde{y}_{T}^{(1)}-\tilde{y}_{T}^{(2)})+(\tilde{y}_{T}^{(1)}-\tilde{y}_{T}^{(2)})\\
&amp;= \left(2-T\frac{\lambda}{1-\lambda}\right)\tilde{y}_{T}^{(1)}-\left(1-T\frac{\lambda}{1-\lambda}\right)y_{T}^{(2)},
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p>Entonces</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-beta0-estimation-eq-yhat">
<span class="eqno">(2.11)<a class="headerlink" href="#equation-beta0-estimation-eq-yhat" title="Link to this equation">#</a></span>\[
\textcolor{red}{\hat{\beta}_{0, T} = \left(2-T\frac{\lambda}{1-\lambda}\right)\tilde{y}_{T}^{(1)}-\left(1-T\frac{\lambda}{1-\lambda}\right)y_{T}^{(2)}},
\]</div>
<ul class="simple">
<li><p>Combinando las Ecuaciones <a class="reference internal" href="#equation-beta1-estimation-eq">(2.9)</a>-<a class="reference internal" href="#equation-beta0-estimation-eq-yhat">(2.11)</a> tenemos que</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\tilde{y}_{T} &amp;= \hat{\beta}_{0, T}+\hat{\beta}_{1, T}T=\left(2-T\frac{\lambda}{1-\lambda}\right)\tilde{y}_{T}^{(1)}-\left(1-T\frac{\lambda}{1-\lambda}\right)\tilde{y}_{T}^{(2)}+\frac{\lambda}{1-\lambda}(\tilde{y}_{T}^{(1)}-\tilde{y}_{T}^{(2)})T\\
&amp;= \left(2-T\frac{\lambda}{1-\lambda}+T\frac{\lambda}{1-\lambda}\right)\tilde{y}_{T}^{(1)}-\left(1-T\frac{\lambda}{1-\lambda}+T\frac{\lambda}{1-\lambda}\right)\tilde{y}_{T}^{(2)}\\[2mm]
&amp;=2\tilde{y}_{T}^{(1)}-\tilde{y}_{T}^{(2)}.
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p>Entonces</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-first-exp-smooth">
<span class="eqno">(2.12)<a class="headerlink" href="#equation-first-exp-smooth" title="Link to this equation">#</a></span>\[
\textcolor{red}{\tilde{y}_{T}=2\tilde{y}_{T}^{(1)}-\tilde{y}_{T}^{(2)}}
\]</div>
<ul class="simple">
<li><p>Nótese que como</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\text{E}(\tilde{y}_{T}^{(1)}) = (\beta_{0}+\beta_{1}T)-\frac{1-\lambda}{\lambda}\beta_{1}\Rightarrow\tilde{y}_{T}^{(1)}=(\hat{\beta}_{0, T}+\hat{\beta}_{1, T}T)-\frac{1-\lambda}{\lambda}\hat{\beta}_{1, T}
\]</div>
<ul class="simple">
<li><p>Además</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\text{E}(\tilde{y}_{T}^{(2)}) &amp;= \text{E}(\tilde{y}_{T}^{(1)})-\frac{1-\lambda}{\lambda}\hat{\beta}_{1, T}=\text{E}\left((\hat{\beta}_{0, T}+\hat{\beta}_{1, T}T)-\frac{1-\lambda}{\lambda}\hat{\beta}_{1, T}\right)-\frac{1-\lambda}{\lambda}\hat{\beta}_{1, T}\\
&amp;= (\hat{\beta}_{0, T}+\hat{\beta}_{1, T})-\frac{1-\lambda}{\lambda}\hat{\beta}_{1, T}-\frac{1-\lambda}{\lambda}\hat{\beta}_{1, T}=(\hat{\beta}_{0, T}+\hat{\beta}_{1, T})-2\left(\frac{1-\lambda}{\lambda}\right)\hat{\beta}_{1, T}
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p>Entonces</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\textcolor{red}{
\begin{align*}
\tilde{y}_{T}^{(1)} &amp;= (\hat{\beta}_{0, T}+\hat{\beta}_{1, T})-\frac{1-\lambda}{\lambda}\hat{\beta}_{1, T}\\
\tilde{y}_{T}^{(2)} &amp;= (\hat{\beta}_{0, T}+\hat{\beta}_{1, T})-2\left(\frac{1-\lambda}{\lambda}\right)\hat{\beta}_{1, T}
\end{align*}
}
\end{split}\]</div>
<ul class="simple">
<li><p>Con los respectivos valores iniciales</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\tilde{y}_{0}^{(1)} &amp;= \hat{\beta}_{0, 0}-\frac{1-\lambda}{\lambda}\hat{\beta}_{1, 0}\\
\tilde{y}_{0}^{(2)} &amp;= \hat{\beta}_{0, 0}-2\left(\frac{1-\lambda}{\lambda}\right)\hat{\beta}_{1, 0}
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p>La <em><strong>estimación de los parámetros iniciales</strong></em> es obtenida usualmente por medio del <em><strong>método de mínimos cuadrado</strong></em>. Por ejemplo, los parámetros <span class="math notranslate nohighlight">\(\hat{\beta}_{0, 0}, \hat{\beta}_{1, 0}\)</span> asociados al <em><strong>US Consumer Prices Index (CPI)</strong></em> de Enero 1995 a Diciembre 2004, obtenidos por mínimos cuadrados están dados por <span class="math notranslate nohighlight">\(\hat{\beta}_{0, 0}=149.89\)</span> y <span class="math notranslate nohighlight">\(\hat{\beta}_{1, 0}=0.3\)</span>. Usando <span class="math notranslate nohighlight">\(\lambda=0.3\)</span> se tiene que</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\hat{y}_{0}^{(1)} &amp;= \hat{\beta}_{0, 0}-\frac{1-\lambda}{\lambda}\hat{\beta}_{1, 0}=149.89-\frac{1-0.3}{0.3}0.3=146.22\\
\hat{y}_{0}^{(2)} &amp;= \hat{\beta}_{0, 0}-2\frac{1-\lambda}{\lambda}\hat{\beta}_{1, 0}=149.89-2\frac{1-0.3}{0.3}0.3=142.56\\
\end{align}
\end{split}\]</div>
</section>
<section id="implementacion-des">
<h2><span class="section-number">2.8. </span>Implementación <span class="math notranslate nohighlight">\(DES\)</span><a class="headerlink" href="#implementacion-des" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cpi_smooth1</span> <span class="o">=</span> <span class="n">firstsmooth</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">djia_ts</span><span class="p">,</span> <span class="n">lambda_</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">cpi_smooth2</span> <span class="o">=</span> <span class="n">firstsmooth</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">cpi_smooth1</span><span class="p">,</span> <span class="n">lambda_</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cpi_hat</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">cpi_smooth1</span> <span class="o">-</span> <span class="n">cpi_smooth2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">djia_ts</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Dow Jones&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cpi_hat</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;DES $\lambda=0.3$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Dow Jones&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9e1be23387c3bad9104d6f0143374eb8675474ab82acd7fc73a2dabc0c4e1649.png" src="_images/9e1be23387c3bad9104d6f0143374eb8675474ab82acd7fc73a2dabc0c4e1649.png" />
</div>
</div>
</section>
<section id="suavizacion-exponencial-de-alto-orden">
<h2><span class="section-number">2.9. </span>Suavización exponencial de alto orden<a class="headerlink" href="#suavizacion-exponencial-de-alto-orden" title="Link to this heading">#</a></h2>
<ul>
<li><p>Hasta ahora hemos discutido el uso de suavizadores exponenciales al estimar los <em><strong>modelos de tendencia constante y lineal</strong></em>. Para el primero empleamos el suavizador exponencial simple o de primer orden y para el segundo el suavizador exponencial de segundo orden. Además, se puede demostrar que para el <em><strong>modelo polinómico general de</strong></em> <span class="math notranslate nohighlight">\(n\text{th}\)</span>-ésimo grado de la forma</p>
<div class="math notranslate nohighlight" id="equation-highorder-exponential-smoothing">
<span class="eqno">(2.13)<a class="headerlink" href="#equation-highorder-exponential-smoothing" title="Link to this equation">#</a></span>\[
    y_{t}=\beta_{0}+\beta_{1}t+\frac{\beta_{2}}{2!}t^{2}+\cdots+\frac{\beta_{n}}{n!}t^{n}+\varepsilon_{t},
    \]</div>
<p>donde <span class="math notranslate nohighlight">\(\varepsilon_{t}\)</span> se supone independiente con media 0 y varianza constante <span class="math notranslate nohighlight">\(\sigma_{\varepsilon}^{2}\)</span>, empleamos suavizadores exponenciales de orden <span class="math notranslate nohighlight">\(n-1\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align*}
    \tilde{y}_{T}^{(1)} &amp;= \lambda y_{T}+(1-\lambda)\tilde{y}_{T-1}^{(1)}\\
    \tilde{y}_{T}^{(2)} &amp;= \lambda \tilde{y}_{T}^{(1)}+(1-\lambda)\tilde{y}_{T-1}^{(2)}\\
    &amp;\vdots\\
    \tilde{y}_{T}^{(n)} &amp;= \lambda \tilde{y}_{T}^{(n-1)}+(1-\lambda)\tilde{y}_{T-1}^{(n)},
    \end{align*}
    \end{split}\]</div>
<p>para estimar los parámetros del modelo.</p>
</li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>Incluso para el modelo cuadrático, los cálculos se vuelven bastante complicados. Consulte <span id="id1">[<a class="reference internal" href="biblio.html#id5" title="D.C. Montgomery, L.A. Johnson, and J.S. Gardiner. Forecasting and Time Series Analysis. Industrial engineering series. McGraw-Hill, 1990. ISBN 9780070428584. URL: https://books.google.com.co/books?id=t9HuAAAAMAAJ.">Montgomery <em>et al.</em>, 1990</a>]</span>, <span id="id2">[<a class="reference internal" href="biblio.html#id6" title="Robert Goodell Brown. Smoothing, forecasting and prediction of discrete time series. Courier Corporation, 2004.">Brown, 2004</a>]</span> y <span id="id3">[<a class="reference internal" href="biblio.html#id9" title="B. Abraham and J. Ledolter. Statistical Methods for Forecasting. Wiley Series in Probability and Statistics. Wiley, 2009. ISBN 9780470317297. URL: https://books.google.com.co/books?id=WIPxdb2P8sAC.">Abraham and Ledolter, 2009</a>]</span> para las <em><strong>soluciones a problemas de suavizamiento exponencial de orden superior</strong></em> (<em><strong><code class="docutils literal notranslate"><span class="pre">bonus</span></code></strong></em>).</p></li>
<li><p>Si un polinomio de alto orden parece ser necesario para la serie de tiempo, los <em><strong>modelos autorregresivos de media móvil integrada (ARIMA) pueden considerarse en cambio</strong></em>.</p></li>
</ul>
</div>
</section>
<section id="forecasting">
<h2><span class="section-number">2.10. </span>Forecasting<a class="headerlink" href="#forecasting" title="Link to this heading">#</a></h2>
<div class="admonition-forecasting admonition">
<p class="admonition-title">Forecasting</p>
<ul class="simple">
<li><p>En el tiempo <span class="math notranslate nohighlight">\(T\)</span>, deseamos <em><strong>predecir la observación en la unidad de tiempo siguiente</strong></em>, <span class="math notranslate nohighlight">\(T+1\)</span>, u otro valor en el futuro. Denotaremos el pronóstico <span class="math notranslate nohighlight">\(\tau\)</span> pasos hacia adelante (<em>horizonte</em> <span class="math notranslate nohighlight">\(\tau\)</span>) realizado en el tiempo <span class="math notranslate nohighlight">\(T\)</span> como <span class="math notranslate nohighlight">\(\hat{y}_{T+\tau}(T)\)</span>.</p></li>
</ul>
</div>
<section id="proceso-constante">
<h3><span class="section-number">2.10.1. </span>Proceso constante<a class="headerlink" href="#proceso-constante" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>La <em><strong>suavización exponencial de primer orden</strong></em> para el proceso constante está dada por</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\tilde{y}_{T}=\lambda y_{T}+(1-\lambda)\tilde{y}_{T-1}
\]</div>
<ul class="simple">
<li><p>Se demostró también que <span class="math notranslate nohighlight">\(f(t, \boldsymbol{\beta})=\beta_{0}\)</span> puede ser estimado con <span class="math notranslate nohighlight">\(\tilde{y}_{T}\)</span>. Dado que <em><strong>hasta el momento, el error aleatorio no puede ser predicho</strong></em></p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\hat{y}_{T+\tau}(T)=\tilde{y}_{T}=\hat{\beta}_{0}.
\]</div>
<ul class="simple">
<li><p>Dado que <em><strong>pronósticos constantes pueden no ser correctos</strong></em> a medida que vamos acumulando observaciones, <em><strong>actualizamos nuestra predicción por medio de técnicas como <code class="docutils literal notranslate"><span class="pre">rolling</span></code></strong></em>.</p></li>
<li><p>Por ejemplo, si la observación en el tiempo <span class="math notranslate nohighlight">\(T+1\)</span> está disponible, nuestro pronóstico para futuras observaciones sería</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-fc-in-tplustau-eq">
<span class="eqno">(2.14)<a class="headerlink" href="#equation-fc-in-tplustau-eq" title="Link to this equation">#</a></span>\[\begin{split}
\begin{align*}
\tilde{y}_{T+1} &amp;= \lambda y_{T+1}+(1-\lambda)\tilde{y}_{T},\quad\text{o bien}\\
\tilde{y}_{T+1+\tau}(T+1) &amp;= \lambda y_{T+1}+(1-\lambda)\tilde{y}_{T+\tau}(T)\\[4mm]
\end{align*}
\end{split}\]</div>
<figure class="align-center" id="forecasttau-timeseries-fig">
<a class="reference internal image-reference" href="_images/forecasttau_timeseries.png"><img alt="_images/forecasttau_timeseries.png" src="_images/forecasttau_timeseries.png" style="width: 540.0px; height: 105.66px;" /></a>
</figure>
<ul>
<li><p>Para <span class="math notranslate nohighlight">\(\tau=1\)</span> la Ecuación <a class="reference internal" href="#equation-fc-in-tplustau-eq">(2.14)</a> puede reescribirse como</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align*}
    \tilde{y}_{T+2}(T+1) &amp;= \lambda y_{T+1}+(1-\lambda)\tilde{y}_{T+1}(T)\\
    &amp;= \tilde{y}_{T+1}(T)+\lambda(y_{T+1}-\tilde{y}_{T+1}(T))\\
    &amp;= \tilde{y}_{T+1}(T)+\lambda e_{T+1}(1),
    \end{align*}
    \end{split}\]</div>
<p>donde <span class="math notranslate nohighlight">\(e_{T+1}(1):=y_{T+1}-\tilde{y}_{T+1}(T)\)</span> es llamado, predicción de un paso hacia adelante (<em><strong>one-step-ahead</strong></em>) o error de predicción.</p>
</li>
</ul>
<div class="admonition-observacion admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>Pronostico para la observación siguiente es simplemente, el <em><strong>pronostico actual mas una fracción del error cometido en el pronostico de la observación actual</strong></em></p></li>
<li><p>Nótese que la velocidad de reacción del pronostico al error de predicción depende del factor de descuento <span class="math notranslate nohighlight">\(\lambda\)</span></p></li>
</ul>
</div>
</section>
</section>
<section id="seleccion-de-lambda">
<h2><span class="section-number">2.11. </span>Selección de <span class="math notranslate nohighlight">\(\lambda\)</span><a class="headerlink" href="#seleccion-de-lambda" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Definimos la <em><strong>suma de cuadrado para los errores de predicción de horizonte 1</strong></em> como</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
SS_{E}(\lambda)=\sum_{t=1}^{T}e_{t}^{2}(1).
\]</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>Para un conjunto histórico de datos, podemos en general calcular <span class="math notranslate nohighlight">\(SS_{E}(\lambda)\)</span> para varios valores de <span class="math notranslate nohighlight">\(\lambda\)</span> y <em><strong>seleccionar aquel con la menor suma de errores de predicción al cuadrado</strong></em>.</p></li>
</ul>
</div>
<ul class="simple">
<li><p>Por ejemplo, supongamos que interesados en la <em><strong>velocidad promedio en un tramo específico de una autopista durante las horas no pico</strong></em>. Durante el último año y medio (78 semanas), tenemos disponibles <em><strong>promedios semanales de la velocidad promedio en millas por hora entre las 10 a. m. y las 3 p. m</strong></em>. Los datos se presentan en la siguiente tabla</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">speed_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/lihkir/Data/main/weekly_average_speed.csv&quot;</span><span class="p">)</span>
<span class="n">speed_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>week</th>
      <th>speed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>47.12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>45.01</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>44.69</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>45.41</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>45.45</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">speed_ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">speed_df</span><span class="p">[</span><span class="s1">&#39;speed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">speed_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">speed_ts</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    47.12
1    45.01
2    44.69
3    45.41
4    45.45
dtype: float64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>La siguiente figura muestra que los <em><strong>datos de la serie temporal siguen un proceso constante</strong></em>. Sin embargo, para <em><strong>suavizar la variación excesiva, podemos usar el suavizado exponencial de primer orden</strong></em>. La “mejor” constante de suavizado se puede determinar encontrando el valor de la constante de suavizado que minimiza la suma de los errores de predicción de un paso adelante al cuadrado.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">speed_ts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;The weekly average speed during nonrush hours.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Week&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Speed&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/15794a73c8eb0dc3cc817db1bc6fe8270df259b886bc7b0b1985c72229580cb6.png" src="_images/15794a73c8eb0dc3cc817db1bc6fe8270df259b886bc7b0b1985c72229580cb6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lambda_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sse_speed</span><span class="p">(</span><span class="n">sc</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">measacc_fs</span><span class="p">(</span><span class="n">speed_ts</span><span class="p">,</span> <span class="n">sc</span><span class="p">)[</span><span class="s1">&#39;SSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sse_vec</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
<span class="k">for</span> <span class="n">lambda_</span> <span class="ow">in</span> <span class="n">lambda_vec</span><span class="p">:</span>
    <span class="n">sse_vec</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">sse_vec</span><span class="p">)]</span> <span class="o">=</span> <span class="n">sse_speed</span><span class="p">(</span><span class="n">lambda_</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">opt_lambda</span> <span class="o">=</span> <span class="n">sse_vec</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lambda_vec</span><span class="p">,</span> <span class="n">sse_vec</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;$SSE$ vs. $\lambda$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$\lambda$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$SSE$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">lambda_vec</span><span class="p">[</span><span class="n">sse_vec</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/070425fea634a9aa70ed0a198263204d9a4d4f815b297689dccb93e175ada7c0.png" src="_images/070425fea634a9aa70ed0a198263204d9a4d4f815b297689dccb93e175ada7c0.png" />
</div>
</div>
</section>
<section id="intervalo-de-prediccion">
<h2><span class="section-number">2.12. </span>Intervalo de predicción<a class="headerlink" href="#intervalo-de-prediccion" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>El cálculo de intervalos de predicción requiere de la <em><strong>estimación de la varianza del error de predicción</strong></em>. Este tipo de técnicas serán estudiadas mas adelante en la presente sección</p></li>
</ul>
<div class="admonition-proceso-contante admonition">
<p class="admonition-title">Proceso contante</p>
<ul>
<li><p>Para un <em><strong>proceso constante, el intervalo de predicción</strong></em> <span class="math notranslate nohighlight">\(100(1-\alpha/2)\)</span> para cualquier horizonte <span class="math notranslate nohighlight">\(\tau\)</span> está dado por</p>
<div class="math notranslate nohighlight">
\[
    \tilde{y}\pm Z_{\alpha/2}\hat{\sigma}_{e},
    \]</div>
<p>donde <span class="math notranslate nohighlight">\(\tilde{y}_{T}\)</span> es la <em><strong>suavización exponencial de primer orden</strong></em>, <span class="math notranslate nohighlight">\(Z_{\alpha/2}\)</span> es el <span class="math notranslate nohighlight">\(100(1-\alpha/2)\)</span> percentíl de la distribución normal estándar, y <span class="math notranslate nohighlight">\(\hat{\sigma}_{e}\)</span> es la estimación de la desviación estándar de los errores predichos.</p>
</li>
</ul>
</div>
<ul class="simple">
<li><p>Encontraremos solución a problemas de intervalo constante para todos los horizontes de predicción.</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Proceso de tendencia lineal</p>
<ul class="simple">
<li><p>El pronóstico de horizonte <span class="math notranslate nohighlight">\(\tau\)</span> para el <em><strong>modelo de tendencia lineal</strong></em> está dado por</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\hat{y}_{T+\tau}=\hat{\beta}_{0, T}+\hat{\beta}_{1, T}(T+\tau)=\hat{\beta}_{0, T}+\hat{\beta}_{1, T}T+\hat{\beta}_{1, T}\tau=\hat{y}_{T}+\hat{\beta}_{1, T}\tau.
\]</div>
<ul class="simple">
<li><p>En términos de suavizadores exponenciales</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\hat{y}_{T+\tau}(T) &amp;= (2\tilde{y}_{T}^{(1)}-\tilde{y}_{T}^{(2)})+\tau\frac{\lambda}{1-\lambda}(\tilde{y}_{T}^{(1)}-\tilde{y}_{T}^{(2)})\\
&amp;= \left(2+\frac{\lambda}{1-\lambda}\tau\right)\tilde{y}_{T}^{(1)}-\left(1+\frac{\lambda}{1-\lambda}\tau\right)\tilde{y}_{T}^{(2)}.
\end{align*}
\end{split}\]</div>
</div>
<ul>
<li><p>Nótese que <em><strong>las predicciones dependerán ahora del horizonte de predicción</strong></em> <span class="math notranslate nohighlight">\(\tau\)</span>. En este caso, el <span class="math notranslate nohighlight">\(100(1-\alpha/2)\)</span> intervalo de predicción para cualquier horizonte de tiempo <span class="math notranslate nohighlight">\(\tau\)</span> está dado por (<em><strong><code class="docutils literal notranslate"><span class="pre">bonus</span></code></strong></em>)</p>
<div class="math notranslate nohighlight">
\[
  \left(2+\frac{\lambda}{1-\lambda}\tau\right)\tilde{y}_{T}^{(1)}-\left(1+\frac{\lambda}{1-\lambda}\tau\right)\tilde{y}_{T}^{(2)}\pm Z_{\alpha/2}\frac{c_{\tau}}{c_{1}}\hat{\sigma}_{e}.
  \]</div>
<p>donde</p>
<div class="math notranslate nohighlight">
\[
  c_{i}^{2}=1+\frac{\lambda}{(2-\lambda)^{3}}[(10-14\lambda+5\lambda^{2})+2i\lambda(4-3\lambda)+2i^{2}\lambda^{2}].
  \]</div>
</li>
</ul>
<ul class="simple">
<li><p>A manera de ejemplo, consideremos los datos asociados al <em><strong>US Consumer Price Index (CPI)</strong></em>. Como primera opción, realizaremos <em><strong>pronósticos para todo el año 2004</strong></em> (<em>pronósticos de 1 a 12 pasos por delante</em>)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cpi_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/lihkir/Data/main/CPI.csv&quot;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">skipfooter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cpi_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Period</th>
      <th>Consumer Price Index</th>
      <th>Over-the-Year Percent Change</th>
      <th>Over-the-Month Percent Change</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2024</td>
      <td>March</td>
      <td>312.3</td>
      <td>3.5%</td>
      <td>0.6%</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2024</td>
      <td>February</td>
      <td>310.3</td>
      <td>3.2%</td>
      <td>0.6%</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2024</td>
      <td>January</td>
      <td>308.4</td>
      <td>3.1%</td>
      <td>0.5%</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2023</td>
      <td>December</td>
      <td>306.7</td>
      <td>3.4%</td>
      <td>-0.1%</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2023</td>
      <td>November</td>
      <td>307.1</td>
      <td>3.1%</td>
      <td>-0.2%</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cpi_data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cpi_data</span><span class="p">[</span><span class="s1">&#39;Period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">cpi_data</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cpi_data</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">cpi_data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span>
<span class="n">cpi_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">cpi_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Period</th>
      <th>Consumer Price Index</th>
      <th>Over-the-Year Percent Change</th>
      <th>Over-the-Month Percent Change</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>March-2024</th>
      <td>2024</td>
      <td>March</td>
      <td>312.3</td>
      <td>3.5%</td>
      <td>0.6%</td>
    </tr>
    <tr>
      <th>February-2024</th>
      <td>2024</td>
      <td>February</td>
      <td>310.3</td>
      <td>3.2%</td>
      <td>0.6%</td>
    </tr>
    <tr>
      <th>January-2024</th>
      <td>2024</td>
      <td>January</td>
      <td>308.4</td>
      <td>3.1%</td>
      <td>0.5%</td>
    </tr>
    <tr>
      <th>December-2023</th>
      <td>2023</td>
      <td>December</td>
      <td>306.7</td>
      <td>3.4%</td>
      <td>-0.1%</td>
    </tr>
    <tr>
      <th>November-2023</th>
      <td>2023</td>
      <td>November</td>
      <td>307.1</td>
      <td>3.1%</td>
      <td>-0.2%</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cpi_ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cpi_data</span><span class="p">[</span><span class="s1">&#39;Consumer Price Index&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">cpi_data</span><span class="o">.</span><span class="n">index</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cpi_ts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date
January-1913       9.8
February-1913      9.8
March-1913         9.8
April-1913         9.8
May-1913           9.7
                 ...  
November-2023    307.1
December-2023    306.7
January-2024     308.4
February-2024    310.3
March-2024       312.3
Length: 1335, dtype: float64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Consideremos el <em><strong>US Consumer Price Index (CPI)</strong></em> de Estados Unidos <em><strong>desde enero de 1995 hasta diciembre de 2004</strong></em>. La siguiente figura muestra claramente que los datos exhiben una tendencia lineal.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cpi_dates</span> <span class="o">=</span> <span class="n">cpi_ts</span><span class="p">[</span><span class="n">cpi_ts</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="s1">&#39;January-1995&#39;</span><span class="p">):</span><span class="n">cpi_ts</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="s1">&#39;December-2004&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cpi_dates</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date
January-1995      150.3
February-1995     150.9
March-1995        151.4
April-1995        151.9
May-1995          152.2
                  ...  
August-2004       189.5
September-2004    189.9
October-2004      190.9
November-2004     191.0
December-2004     190.3
Length: 120, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">cpi_dates</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;US Consumer Price Index (CPI)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Closing Value&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2a529656b5867d19ecd811e6eaee5ab20563b36c1637e3bc9fd18d503e1fb3ec.png" src="_images/2a529656b5867d19ecd811e6eaee5ab20563b36c1637e3bc9fd18d503e1fb3ec.png" />
</div>
</div>
<ul class="simple">
<li><p>En <em><strong>diciembre de 2003</strong></em>, realiza las <em><strong>previsiones para todo el año 2004</strong></em> (<em>previsiones de 1 a 12 pasos adelante</em>)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lambda_</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">tau_length</span> <span class="o">=</span> <span class="mi">12</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cpi_smooth1</span> <span class="o">=</span> <span class="n">firstsmooth</span><span class="p">(</span><span class="n">cpi_dates</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="n">tau_length</span><span class="p">],</span> <span class="n">lambda_</span><span class="p">)</span>
<span class="n">cpi_smooth2</span> <span class="o">=</span> <span class="n">firstsmooth</span><span class="p">(</span><span class="n">cpi_smooth1</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cpi_hat</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">cpi_smooth1</span> <span class="o">-</span> <span class="n">cpi_smooth2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">tau_length</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cpi_smooth1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cpi_forecast</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">tau</span> <span class="o">*</span> <span class="p">(</span><span class="n">lambda_</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">lambda_</span><span class="p">)))</span> <span class="o">*</span> <span class="n">cpi_smooth1</span><span class="p">[</span><span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">tau</span> <span class="o">*</span> <span class="p">(</span><span class="n">lambda_</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">lambda_</span><span class="p">)))</span> <span class="o">*</span> <span class="n">cpi_smooth2</span><span class="p">[</span><span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ctau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">lambda_</span> <span class="o">/</span> <span class="p">((</span><span class="mi">2</span> <span class="o">-</span> <span class="n">lambda_</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">10</span> <span class="o">-</span> <span class="mi">14</span> <span class="o">*</span> <span class="n">lambda_</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">*</span> <span class="p">(</span><span class="n">lambda_</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">tau</span> <span class="o">*</span> <span class="n">lambda_</span> <span class="o">*</span> <span class="p">(</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">lambda_</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">tau</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">lambda_</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha_lev</span> <span class="o">=</span> <span class="mf">0.05</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sig_est</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">cpi_dates</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">cpi_hat</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">ctau</span> <span class="o">/</span> <span class="n">ctau</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">sig_est</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">alpha_lev</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cpi_dates</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="o">-</span><span class="n">tau_length</span><span class="p">],</span> <span class="n">cpi_dates</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="n">tau_length</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cpi_dates</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="n">tau_length</span><span class="p">:],</span> <span class="n">cpi_dates</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">tau_length</span><span class="p">:]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cpi_dates</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="n">tau_length</span><span class="p">:],</span> <span class="n">cpi_forecast</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Forecast&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cpi_dates</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="n">tau_length</span><span class="p">:],</span> <span class="n">cpi_forecast</span> <span class="o">+</span> <span class="n">cl</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Upper bound&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cpi_dates</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="n">tau_length</span><span class="p">:],</span> <span class="n">cpi_forecast</span> <span class="o">-</span> <span class="n">cl</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lower bound&#39;</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cpi_dates</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="n">n</span><span class="p">),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Closing Value&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f5a01abfd3fe3cc720fb752d94eeac7e1417aaf6947e0f62c6f2fb031d8279d8.png" src="_images/f5a01abfd3fe3cc720fb752d94eeac7e1417aaf6947e0f62c6f2fb031d8279d8.png" />
</div>
</div>
<ul class="simple">
<li><p>Como segunda opción. <em><strong>En diciembre de 2003, hacer el pronóstico para enero de 2004</strong></em>. Luego, <em><strong>cuando los datos de enero de 2004 estén disponibles, hacer el pronóstico para febrero de 2004</strong></em> (<em>solo pronósticos de un paso por delante</em>)”</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lambda_</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">108</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">alpha_lev</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">cpi_forecast</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span>
<span class="n">cl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span>
<span class="n">cpi_smooth1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span> <span class="o">+</span> <span class="n">tau</span><span class="p">)</span>
<span class="n">cpi_smooth2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span> <span class="o">+</span> <span class="n">tau</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">tau</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">cpi_smooth1</span><span class="p">[:</span><span class="n">T</span> <span class="o">+</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">firstsmooth</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">cpi_dates</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">T</span> <span class="o">+</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">lambda_</span><span class="o">=</span><span class="n">lambda_</span><span class="p">)</span>
    <span class="n">cpi_smooth2</span><span class="p">[:</span><span class="n">T</span> <span class="o">+</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">firstsmooth</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">cpi_smooth1</span><span class="p">[:</span><span class="n">T</span> <span class="o">+</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">lambda_</span><span class="o">=</span><span class="n">lambda_</span><span class="p">)</span>
    <span class="n">cpi_forecast</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">lambda_</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">lambda_</span><span class="p">)))</span> <span class="o">*</span> <span class="n">cpi_smooth1</span><span class="p">[</span><span class="n">T</span> <span class="o">+</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">-</span> \
                          <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">lambda_</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">lambda_</span><span class="p">)))</span> <span class="o">*</span> <span class="n">cpi_smooth2</span><span class="p">[</span><span class="n">T</span> <span class="o">+</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="c1"># horizon one each time</span>
    <span class="n">cpi_hat</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">cpi_smooth1</span><span class="p">[:</span><span class="n">T</span> <span class="o">+</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">cpi_smooth2</span><span class="p">[:</span><span class="n">T</span> <span class="o">+</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">sig_est</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">cpi_dates</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">T</span> <span class="o">+</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">cpi_hat</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">cl</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha_lev</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">sig_est</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cpi_dates</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="o">-</span><span class="n">tau</span><span class="p">],</span> <span class="n">cpi_dates</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="n">tau</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;CPI&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cpi_dates</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="n">tau</span><span class="p">:],</span> <span class="n">cpi_dates</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">tau</span><span class="p">:]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cpi_dates</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="n">tau</span><span class="p">:],</span> <span class="n">cpi_forecast</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cpi_dates</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="n">tau</span><span class="p">:],</span> <span class="n">cpi_forecast</span> <span class="o">+</span> <span class="n">cl</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Confidence Interval&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cpi_dates</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="n">tau</span><span class="p">:],</span> <span class="n">cpi_forecast</span> <span class="o">-</span> <span class="n">cl</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cpi_dates</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="n">n</span><span class="p">),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;CPI&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b901bfaed7ae574d2e1759b651d10878b67e52eb457f2244d5099958a525e3ec.png" src="_images/b901bfaed7ae574d2e1759b651d10878b67e52eb457f2244d5099958a525e3ec.png" />
</div>
</div>
</section>
<section id="estimacion-de-sigma-e-2">
<h2><span class="section-number">2.13. </span>Estimación de <span class="math notranslate nohighlight">\(\sigma_{e}^{2}\)</span><a class="headerlink" href="#estimacion-de-sigma-e-2" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>En el proceso de <em><strong>estimar la varianza de los errores de pronóstico</strong></em>, representada como <span class="math notranslate nohighlight">\(\sigma_{e}^{2}\)</span>, frecuentemente se postula que <em><strong>el modelo subyacente</strong></em> (por ejemplo, <em>constante, tendencia lineal</em>) es <em><strong>correcto e invariante en el tiempo</strong></em> (<em>predicciones precisas y estables a medida que se avanza en el tiempo</em>). Bajo estas condiciones, dos metodologías distintas están disponibles para estimar <span class="math notranslate nohighlight">\(\sigma_{e}^{2}\)</span></p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Bonus</p>
<ul class="simple">
<li><p>Encuentre la <em><strong>estimación de la varianza de los errores de pronóstico</strong></em> <span class="math notranslate nohighlight">\(\sigma_{e}^{2}\)</span> para el modelo de suavización exponencial. Utilice los siguientes documentos como guía <a class="reference external" href="https://www.pomsmeetings.org/confproceedings/015/fullpapers/015-0271.pdf">Peter Wanke et. al</a> y <a class="reference external" href="http://adjifern.lecture.ub.ac.id/files/2016/03/bahan-ADE-minggu-11b.pdf">Kuliah Genap</a>, así como aquellos que encuentre en su revisión.</p></li>
</ul>
</div>
<ol class="arabic simple">
<li><p>Dado el pronóstico <code class="docutils literal notranslate"><span class="pre">one-step-ahead</span></code> definido como <span class="math notranslate nohighlight">\(e_{T}(1)=y_{T}-\hat{y}_{T}(T-1)\)</span>. El objetivo es aplicar el modelo a los datos históricos y obtener la <em><strong>varianza del error de pronóstico</strong></em> a calcular</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
\sigma_{e}^{2}=\frac{1}{T}\sum_{t=1}^{T}e_{t}^{2}(1)=\frac{1}{T}\sum_{t=1}^{T}(y_{t}-\hat{y}_{t}(t-1))^{2}.
\]</div>
<ul class="simple">
<li><p>Nótese que en el cálculo de la varianza, la media del ajuste no fue necesaria, ya que para el modelo correcto los pronósticos son insesgados; esto es, <em><strong>el valor esperado de los errores de pronóstico es 0</strong></em>.</p></li>
<li><p>A medida que se recopilan más datos, la varianza de los errores de pronóstico puede ser actualizada</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\hat{\sigma}_{eT+1}=\frac{1}{T+1}\left(T\hat{\sigma}_{e, T}^{2}+e_{T+1}^{2}(1)\right).
\]</div>
<ul class="simple">
<li><p>Puede resultar contraintuitivo tener una varianza constante de errores de pronóstico para todos los horizontes de predicción. En su lugar, podemos definir <span class="math notranslate nohighlight">\(\sigma_{e}^{2}(\tau)\)</span> como la <em><strong>varianza del error de pronóstico a</strong></em> <span class="math notranslate nohighlight">\(\tau\)</span> <em><strong>pasos hacia adelante</strong></em> y estimarla mediante</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-error-variance-estimation-tau">
<span class="eqno">(2.15)<a class="headerlink" href="#equation-error-variance-estimation-tau" title="Link to this equation">#</a></span>\[
\hat{\sigma}_{e}^{2}(\tau)=\frac{1}{T-\tau+1}\sum_{t=\tau}^{T}e_{1}^{2}(\tau).
\]</div>
<ul class="simple">
<li><p>Por lo tanto, la estimación en la Ecuación <a class="reference internal" href="#equation-error-variance-estimation-tau">(2.15)</a> puede ser utilizada en los cálculos del <em><strong>intervalo de predicción para el pronóstico a</strong></em> <span class="math notranslate nohighlight">\(\tau\)</span> <em><strong>pasos hacia adelante</strong></em>.</p></li>
</ul>
<ol class="arabic" start="2">
<li><p>Para el segundo método de estimación de <span class="math notranslate nohighlight">\(\sigma_{e}^{2}\)</span>, primero definiremos la <em><strong>desviación media absoluta</strong></em> <span class="math notranslate nohighlight">\(\Delta\)</span> como</p>
<div class="math notranslate nohighlight">
\[
    \Delta = \text{E}(|e-\text{E}(e)|)
    \]</div>
<p>y, asumiendo que el modelo es correcto, calcular su estimación mediante</p>
<div class="math notranslate nohighlight" id="equation-mean-absolute-deviationt">
<span class="eqno">(2.16)<a class="headerlink" href="#equation-mean-absolute-deviationt" title="Link to this equation">#</a></span>\[
    \hat{\Delta}_{T}=\delta|e_{T}(1)|+(1-\delta)\hat{\Delta}_{T-1}.
    \]</div>
<p>Entonces, el estimador de <span class="math notranslate nohighlight">\(\sigma_{e}^{2}\)</span> está dado por <span id="id4">[<a class="reference internal" href="biblio.html#id5" title="D.C. Montgomery, L.A. Johnson, and J.S. Gardiner. Forecasting and Time Series Analysis. Industrial engineering series. McGraw-Hill, 1990. ISBN 9780070428584. URL: https://books.google.com.co/books?id=t9HuAAAAMAAJ.">Montgomery <em>et al.</em>, 1990</a>]</span> (<em><strong><code class="docutils literal notranslate"><span class="pre">bonus</span></code></strong></em>)</p>
<div class="math notranslate nohighlight">
\[
    \hat{\sigma}_{e, T}=1.25\hat{\Delta}_{T}.
    \]</div>
</li>
</ol>
</section>
<section id="adaptacion-actualizada-del-factor-de-descuento">
<h2><span class="section-number">2.14. </span>Adaptación actualizada del factor de descuento<a class="headerlink" href="#adaptacion-actualizada-del-factor-de-descuento" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Cambios en el modelo subyacente de series temporales dificultarán que el suavizador exponencial con factor de descuento fijo siga estos cambios. Por lo tanto, surge la necesidad de <em><strong>monitorear y, si es necesario, modificar el factor de descuento</strong></em>. Al hacerlo, el factor de descuento se adaptará a los cambios en el modelo de series temporales.</p></li>
<li><p>Para ello, emplearemos el procedimiento descrito originalmente por <span id="id5">[<a class="reference internal" href="biblio.html#id4" title="DW Trigg and A Gi Leach. Exponential smoothing with an adaptive response rate. Journal of the Operational Research Society, 18:53–59, 1967.">Trigg and Leach, 1967</a>]</span> para un único factor de descuento. Como ejemplo, consideraremos el <em><strong>suavizador exponencial de primer orden</strong></em> y lo modificaremos de la siguiente manera:</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-adaptive-discount-factor">
<span class="eqno">(2.17)<a class="headerlink" href="#equation-adaptive-discount-factor" title="Link to this equation">#</a></span>\[
\hat{y}_{T}=\lambda_{T}y_{T}+(1-\lambda_{T})\hat{y}_{T-1}.
\]</div>
<ul>
<li><p>Nótese que en la Ecuación <a class="reference internal" href="#equation-adaptive-discount-factor">(2.17)</a>, el factor de descuento <span class="math notranslate nohighlight">\(\lambda_{T}\)</span> se introduce como una función del tiempo y, por lo tanto, <em><strong>se le permite adaptarse a los cambios en el modelo de series temporales</strong></em>.</p></li>
<li><p>También definimos el <em><strong>error de suavizado</strong></em> como</p>
<div class="math notranslate nohighlight">
\[
    Q_{T}=\delta e_{T}(1)+(1-\delta)Q_{T-1},
    \]</div>
<p>donde <span class="math notranslate nohighlight">\(\delta\)</span> es un parámetro de suavización.</p>
</li>
</ul>
<ul>
<li><p>Por último, definimos la señal de seguimiento como</p>
<div class="math notranslate nohighlight">
\[
    \frac{Q_{T}}{\hat{\Delta}_{T}},
    \]</div>
<p>donde <span class="math notranslate nohighlight">\(\hat{\Delta}_{T}\)</span> está dado por la Ecuación <a class="reference internal" href="#equation-mean-absolute-deviationt">(2.16)</a>.</p>
</li>
</ul>
<ul>
<li><p><em><strong>Se espera que este cociente sea cercano a 0 cuando el sistema de predicción funciona bien, y que se acerque a</strong></em> <span class="math notranslate nohighlight">\(\pm1\)</span> <em><strong>cuando empiece a fallar</strong></em>. De hecho, <span id="id6">[<a class="reference internal" href="biblio.html#id4" title="DW Trigg and A Gi Leach. Exponential smoothing with an adaptive response rate. Journal of the Operational Research Society, 18:53–59, 1967.">Trigg and Leach, 1967</a>]</span> sugieren fijar el factor de descuento en</p>
<div class="math notranslate nohighlight" id="equation-adaptive-discount-factor-abs">
<span class="eqno">(2.18)<a class="headerlink" href="#equation-adaptive-discount-factor-abs" title="Link to this equation">#</a></span>\[
    \lambda_{T}=\left|\frac{Q_{T}}{\hat{\Delta}_{T}}\right|,
    \]</div>
<p>Donde <span class="math notranslate nohighlight">\(\hat{\Delta}_{T}\)</span> está dado por la Ecuación <a class="reference internal" href="#equation-mean-absolute-deviationt">(2.16)</a>. La Ecuación <a class="reference internal" href="#equation-adaptive-discount-factor-abs">(2.18)</a> <em><strong>permitirá actualizar automáticamente el factor de descuento</strong></em>.</p>
</li>
</ul>
<ul class="simple">
<li><p>La siguiente figura muestra <em><strong>dos suavizadores exponenciales simples</strong></em> para el <em><strong>Índice Dow Jones</strong></em>, uno con <span class="math notranslate nohighlight">\(\lambda\)</span> fijo de 0.3 y otro con actualización adaptativa basada en el <em><strong>método Trigg-Leach</strong></em> dado en la Ecuación <a class="reference internal" href="#equation-adaptive-discount-factor-abs">(2.18)</a>. Visualizaremos los <em><strong>últimos cien registros</strong></em> para poder apreciar mejor las predicciones de cada modelo</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">tlsmooth</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">delta_</span><span class="p">,</span> <span class="n">y_tilde_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lambda_start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    
    <span class="n">Qt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">y_tilde</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">lambd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    
    <span class="n">lambd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">lambda_start</span>
    <span class="k">if</span> <span class="n">y_tilde_start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">y_tilde</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">y_tilde</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_tilde_start</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="n">err</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_tilde</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Qt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">delta_</span> <span class="o">*</span> <span class="n">err</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">delta_</span><span class="p">)</span> <span class="o">*</span> <span class="n">Qt</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Dt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">delta_</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">err</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">delta_</span><span class="p">)</span> <span class="o">*</span> <span class="n">Dt</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">lambd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Qt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">Dt</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">y_tilde</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lambd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">lambd</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="n">y_tilde</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">y_tilde</span><span class="p">,</span> <span class="n">lambd</span><span class="p">,</span> <span class="n">err</span><span class="p">,</span> <span class="n">Qt</span><span class="p">,</span> <span class="n">Dt</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out_tl_dji</span> <span class="o">=</span> <span class="n">tlsmooth</span><span class="p">(</span><span class="n">djia_ts</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">last_fc</span> <span class="o">=</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">djia_ts</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="n">last_fc</span><span class="p">:],</span> <span class="n">djia_ts</span><span class="p">[</span><span class="o">-</span><span class="n">last_fc</span><span class="p">:],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Dow Jones&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">djia_ts</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="n">last_fc</span><span class="p">:],</span> <span class="n">out_tl_dji</span><span class="p">[</span><span class="o">-</span><span class="n">last_fc</span><span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;TL Smoother&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">djia_ts</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="n">last_fc</span><span class="p">:],</span> <span class="n">dji_smooth1</span><span class="p">[</span><span class="o">-</span><span class="n">last_fc</span><span class="p">:],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Exponential Smoother&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Dow Jones&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/08d82de9d5b04e179c69db1bc9defdd3f589a5501c04b50bea65b3894bae93df.png" src="_images/08d82de9d5b04e179c69db1bc9defdd3f589a5501c04b50bea65b3894bae93df.png" />
</div>
</div>
</section>
<section id="evaluacion-del-modelo">
<h2><span class="section-number">2.15. </span>Evaluación del modelo<a class="headerlink" href="#evaluacion-del-modelo" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Si el modelo de pronóstico funciona como se esperaba, <em><strong>los errores de pronóstico deberían no exhibir ningún patrón o estructura</strong></em>; es decir, no deberían estar correlacionados. Por lo tanto, siempre es una buena idea verificar esto. Puede hacerlo calculando el <em><strong>ACF muestral de los errores de pronóstico</strong></em> de</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
r_{k}=\frac{\displaystyle{\sum_{t=k}^{T-1}[e_{t}(1)-\overline{e}][e_{t-k}(1)-\overline{e}]}}{\displaystyle{\sum_{T=0}^{T-1}[e_{t}(1)-\overline{e}]^{2}}},~\text{donde}~\overline{e}=\frac{1}{n}\sum_{t=1}^{T}e_{t}(1).
\]</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>Si los <em><strong>errores de pronóstico</strong></em> de un paso adelante en realidad <em><strong>no están correlacionados</strong></em>, las <em><strong>autocorrelaciones muestrales para cualquier rezago</strong></em> <span class="math notranslate nohighlight">\(k\)</span> <em><strong>deben estar alrededor de 0</strong></em> con un error estándar <span class="math notranslate nohighlight">\(1/\sqrt{T}\)</span>.</p></li>
<li><p>De ahí una <em><strong>autocorrelación muestral</strong></em> para cualquier rezago <span class="math notranslate nohighlight">\(k\)</span> que se encuentre <em><strong>fuera de los límites</strong></em> <span class="math notranslate nohighlight">\(\pm2/\sqrt{T}\)</span> <em><strong>requerirán una mayor investigación del modelo</strong></em>.</p></li>
</ul>
</div>
</section>
<section id="suavizacion-exponencial-para-datos-estacionales">
<h2><span class="section-number">2.16. </span>Suavización exponencial para datos estacionales<a class="headerlink" href="#suavizacion-exponencial-para-datos-estacionales" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Algunos datos de series de tiempo exhiben <em><strong>patrones cíclicos o estacionales</strong></em> que no se pueden modelar efectivamente utilizando el modelo polinómico de la Ecuación <a class="reference internal" href="#equation-highorder-exponential-smoothing">(2.13)</a>. Hay varios enfoques disponibles para el análisis de dichos datos.</p></li>
<li><p>La metodología en la que nos centraremos fue introducida originalmente por <span id="id7">[<a class="reference internal" href="biblio.html#id7" title="Charles C Holt. Forecasting seasonals and trends by exponentially weighted moving averages. International journal of forecasting, 20(1):5–10, 2004.">Holt, 2004</a>]</span> y <span id="id8">[<a class="reference internal" href="biblio.html#id8" title="Peter R Winters. Forecasting sales by exponentially weighted moving averages. Management science, 6(3):324–342, 1960.">Winters, 1960</a>]</span> y generalmente se conoce como <em><strong>método de Winters</strong></em>, donde se realiza un ajuste estacional al modelo de tendencia lineal.</p></li>
</ul>
<section id="modelo-estacional-aditivo">
<h3><span class="section-number">2.16.1. </span>Modelo estacional aditivo<a class="headerlink" href="#modelo-estacional-aditivo" title="Link to this heading">#</a></h3>
<ul>
<li><p>Para el caso del <em><strong>modelo estacional aditivo</strong></em>, asumiremos que la serie temporal estacional se puede representar mediante el siguiente modelo:</p>
<div class="math notranslate nohighlight" id="equation-additive-stational-model">
<span class="eqno">(2.19)<a class="headerlink" href="#equation-additive-stational-model" title="Link to this equation">#</a></span>\[
    y_{t}=L_{t}+S_{t}+\varepsilon_{t},
    \]</div>
<p>donde <span class="math notranslate nohighlight">\(L_{t}\)</span> representa el nivel o <em><strong>componente de tendencia lineal</strong></em> y puede a su vez ser representado por <span class="math notranslate nohighlight">\(\beta_{0}+\beta_{1}t\)</span>; <span class="math notranslate nohighlight">\(S_{t}\)</span> representa el <em><strong>ajuste estacional</strong></em> con <span class="math notranslate nohighlight">\(S_{t}=S_{t+s}=S_{t+2s}=\cdots\)</span> para <span class="math notranslate nohighlight">\(t=1, 2,\cdots, s-1\)</span> donde <span class="math notranslate nohighlight">\(s\)</span> <em><strong>es la longitud de período (estación) de los ciclos</strong></em>; y suponemos que <span class="math notranslate nohighlight">\(\varepsilon_{t}\)</span> es <em><strong>no correlacionado con media o y varianza constante</strong></em> <span class="math notranslate nohighlight">\(\sigma_{\varepsilon}^{2}\)</span>.</p>
</li>
</ul>
<ul class="simple">
<li><p>Una <em>restricción habitual</em> de este modelo es que los <em><strong>ajustes estacionales suman cero durante un periodo</strong></em> (<em>evitar tendencia acumulativa en los ajustes estacionales</em>),</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\sum_{t=1}^{s}S_{t}=0.
\]</div>
<ul class="simple">
<li><p>En el modelo dado en la Ecuación <a class="reference internal" href="#equation-additive-stational-model">(2.19)</a>, para pronosticar las observaciones futuras, emplearemos <em><strong>suavizadores exponenciales de primer orden con diferentes factores de descuento</strong></em>.</p></li>
<li><p>El procedimiento para actualizar las estimaciones de los parámetros una vez que se obtiene la observación actual <span class="math notranslate nohighlight">\(y_{T}\)</span> es el siguiente.</p></li>
</ul>
<ol class="arabic">
<li><p>Actualizar la estimación de <span class="math notranslate nohighlight">\(L_{t}\)</span> usando</p>
<div class="math notranslate nohighlight" id="equation-lt-estimation">
<span class="eqno">(2.20)<a class="headerlink" href="#equation-lt-estimation" title="Link to this equation">#</a></span>\[
    \hat{L}_{t}=\lambda_{1}(y_{T}-\hat{S}_{T-s})+(1-\lambda_{1})(\hat{L}_{T-1}+\hat{\beta}_{1, T-1}),
    \]</div>
<p>donde <span class="math notranslate nohighlight">\(0&lt;\lambda_{1}&lt;1\)</span>. Cabe señalar que en la Ecuación <a class="reference internal" href="#equation-lt-estimation">(2.20)</a>, la primera parte puede verse como el valor “actual” de <span class="math notranslate nohighlight">\(L_{T}\)</span> y la segunda parte como el pronóstico de <span class="math notranslate nohighlight">\(L_{T}\)</span> basado en las estimaciones en <span class="math notranslate nohighlight">\(T-1\)</span>.</p>
</li>
</ol>
<ol class="arabic" start="2">
<li><p>Actualizar la estimación de <span class="math notranslate nohighlight">\(\beta_{1}\)</span> usando</p>
<div class="math notranslate nohighlight" id="equation-beta1t-additive-seasonal-model">
<span class="eqno">(2.21)<a class="headerlink" href="#equation-beta1t-additive-seasonal-model" title="Link to this equation">#</a></span>\[
   \hat{\beta}_{1, T}=\lambda_{2}(\hat{L}_{T}-\hat{L}_{T-1})+(1-\lambda_{2})\hat{\beta}_{1, T-1},
   \]</div>
<p>donde <span class="math notranslate nohighlight">\(0&lt;\lambda_{2}&lt;1\)</span>. Como en el Paso 1, la estimación de <span class="math notranslate nohighlight">\(\beta_{1}\)</span> en la Ecuación <a class="reference internal" href="#equation-beta1t-additive-seasonal-model">(2.21)</a> puede verse como la combinación lineal del actual valor de <span class="math notranslate nohighlight">\(\beta_{1}\)</span> y su pronóstico an el tiempo <span class="math notranslate nohighlight">\(T-1\)</span>.</p>
</li>
</ol>
<ol class="arabic" start="3">
<li><p>Actualizar la estimación de <span class="math notranslate nohighlight">\(S_{t}\)</span> usando</p>
<div class="math notranslate nohighlight" id="equation-seasonal-forecast-additive-model">
<span class="eqno">(2.22)<a class="headerlink" href="#equation-seasonal-forecast-additive-model" title="Link to this equation">#</a></span>\[
   \hat{S}_{T}=\lambda_{3}(y_{T}-\hat{L}_{T})+(1-\lambda_{3})\hat{S}_{T-s},
   \]</div>
<p>donde <span class="math notranslate nohighlight">\(0&lt;\lambda_{3}&lt;1\)</span>.</p>
</li>
</ol>
<ol class="arabic" start="4">
<li><p>Finalmente, el pronóstico <span class="math notranslate nohighlight">\(\tau\)</span> pasos hacia adelante, <span class="math notranslate nohighlight">\(\hat{y}_{T+\tau}(T)\)</span>, es</p>
<div class="math notranslate nohighlight">
\[
   \hat{y}_{T+\tau}(T)=\hat{L}_{T}+\hat{\beta}_{1, T}\tau+\hat{S}_{T}(\tau-s).
   \]</div>
</li>
</ol>
<ul>
<li><p><em><strong>Estimar los valores iniciales de una suavización exponencial es crucial</strong></em>. Para un conjunto dado de datos históricos con <span class="math notranslate nohighlight">\(n\)</span> estaciones (<span class="math notranslate nohighlight">\(ns\)</span> observaciones), podemos usar las <em><strong>estimaciones de mínimos cuadrados</strong></em> del siguiente modelo:</p>
<div class="math notranslate nohighlight" id="equation-ols-estimation-additive-model">
<span class="eqno">(2.23)<a class="headerlink" href="#equation-ols-estimation-additive-model" title="Link to this equation">#</a></span>\[
  y_{t}=\beta_{0}+\beta_{1}t+\sum_{i=1}^{s-1}\gamma_{i}(I_{t, i}-I_{t, s})+\varepsilon_{t},
  \]</div>
<p>donde</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  I_{t, i}=
  \begin{cases}
  1, &amp; t=i, i+s, i+2s, \dots\\
  0, &amp; \text{en otro caso}.
  \end{cases}
  \end{split}\]</div>
</li>
</ul>
<ul class="simple">
<li><p>Las <em><strong>estimaciones de mínimos cuadrados de los parámetros</strong></em> de la Ecuación <a class="reference internal" href="#equation-ols-estimation-additive-model">(2.23)</a> se utilizan para obtener los valores iniciales como</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\hat{\beta}_{0, 0} &amp;= \hat{L}_{0}=\hat{\beta}_{0}\\
\hat{\beta}_{1, 0} &amp;= \hat{\beta}_{1}\\
\hat{S}_{j-s} &amp;= \hat{Y}_{j},~\text{para}~ 1\leq j\leq s-1\\
\hat{S}_{0} &amp;= -\sum_{j=1}^{s-1}\hat{y}_{j}.
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p>Estos son valores iniciales de los parámetros del modelo en el origen original de tiempo, <span class="math notranslate nohighlight">\(t = 0\)</span>. Para realizar pronósticos desde el origen correcto de tiempo, la componente permanente debe trasladarse al tiempo <span class="math notranslate nohighlight">\(T\)</span> calculando <span class="math notranslate nohighlight">\(\hat{L}_{T}=\hat{L}_{0}+ns\hat{\beta}_{1}\)</span>. Alternativamente, se podrían suavizar los parámetros usando las Ecuaciones <a class="reference internal" href="#equation-lt-estimation">(2.20)</a>-<a class="reference internal" href="#equation-seasonal-forecast-additive-model">(2.22)</a> para periodos de tiempo <span class="math notranslate nohighlight">\(t = 1, 2,\dots, T\)</span> <span id="id9">[<a class="reference internal" href="biblio.html#id29" title="R. Hyndman, A.B. Koehler, J.K. Ord, and R.D. Snyder. Forecasting with Exponential Smoothing: The State Space Approach. Springer Series in Statistics. Springer Berlin Heidelberg, 2008. ISBN 9783540719182. URL: https://books.google.com.co/books?id=GSyzox8Lu9YC.">Hyndman <em>et al.</em>, 2008</a>]</span>.</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>Intervalos de predicción como en el caso del suavizado no estacional, requerirían <em><strong>estimación de la varianza del error de predicción</strong></em>. El enfoque más común es utilizar la <em><strong>relación entre las técnicas de suavizado exponencial y modelos ARIMA</strong></em> que abordaremos en el siguiente capítulo, y estimar la variación del error de predicción acordemente.</p></li>
</ul>
</div>
</section>
<section id="modelo-estacional-multiplicativo">
<h3><span class="section-number">2.16.2. </span>Modelo estacional multiplicativo<a class="headerlink" href="#modelo-estacional-multiplicativo" title="Link to this heading">#</a></h3>
<ul>
<li><p>Si la <em><strong>amplitud del patrón estacional es proporcional al nivel medio de la serie temporal estacional</strong></em>, el siguiente modelo estacional multiplicativo será el más adecuado</p>
<div class="math notranslate nohighlight" id="equation-multiplicative-stational-model">
<span class="eqno">(2.24)<a class="headerlink" href="#equation-multiplicative-stational-model" title="Link to this equation">#</a></span>\[
  y_{t}=L_{t}S_{t}+\varepsilon_{t},
  \]</div>
<p>donde <span class="math notranslate nohighlight">\(L_{t}\)</span> una vez más representa la componente permanente (i.e. <span class="math notranslate nohighlight">\(\beta_{0}+\beta_{1}t\)</span>); <span class="math notranslate nohighlight">\(S_{t}\)</span> representa el ajuste estacional con <span class="math notranslate nohighlight">\(S_{t}=S_{t+s}=S_{t+2s}=\cdots\)</span> para <span class="math notranslate nohighlight">\(t=1,2,\dots, s-1\)</span>, donde <span class="math notranslate nohighlight">\(s\)</span> es la longitud del periodo de los ciclos; y <span class="math notranslate nohighlight">\(\varepsilon_{t}\)</span> se supone no correlacionado con media 0 y varianza constante <span class="math notranslate nohighlight">\(\sigma_{\varepsilon}^{2}\)</span>.</p>
</li>
<li><p>La restricción para los ajustes estacionales en este caso se convierte en</p>
<div class="math notranslate nohighlight">
\[
  \sum_{t}^{s}S_{t}=s.
  \]</div>
</li>
</ul>
<ul class="simple">
<li><p>Como en el modelo aditivo, emplearemos tres suavizadores exponenciales para estimar los parámetros en la Ecuación <a class="reference internal" href="#equation-multiplicative-stational-model">(2.24)</a></p></li>
</ul>
<ol class="arabic">
<li><p>Actualizar el estimador de <span class="math notranslate nohighlight">\(L_{T}\)</span> usando</p>
<div class="math notranslate nohighlight">
\[
   \hat{L}_{T}=\lambda_{1}\frac{y_{T}}{\hat{S}_{T-s}}+(1-\lambda_{1})(\hat{L}_{T-1}+\hat{\beta}_{1, T-1}), 
   \]</div>
<p>donde <span class="math notranslate nohighlight">\(0&lt;\lambda_{1}&lt;1\)</span>.</p>
</li>
</ol>
<ol class="arabic" start="2">
<li><p>Actualizar el estimador de <span class="math notranslate nohighlight">\(\beta_{1}\)</span> utilizando</p>
<div class="math notranslate nohighlight">
\[
   \hat{\beta}_{1, T}=\lambda_{2}(\hat{L}_{T}-\hat{L}_{T-1})+(1-\lambda_{2})\hat{\beta}_{1, T-1},
   \]</div>
<p>donde <span class="math notranslate nohighlight">\(0&lt;\lambda&lt;1\)</span>.</p>
</li>
</ol>
<ol class="arabic" start="3">
<li><p>Actualizar la estimación de <span class="math notranslate nohighlight">\(S_{t}\)</span> usando</p>
<div class="math notranslate nohighlight">
\[
   \hat{S}_{T}=\lambda_{3}\frac{y_{T}}{\hat{L}_{T}}+(1-\lambda_{3})\hat{S}_{T-s},
   \]</div>
<p>donde <span class="math notranslate nohighlight">\(0&lt;\lambda_{3}&lt;1\)</span>.</p>
</li>
</ol>
<ol class="arabic" start="4">
<li><p>El pronóstico <span class="math notranslate nohighlight">\(\tau\)</span> pasos hacia adelante, <span class="math notranslate nohighlight">\(\hat{y}_{T+\tau}(T)\)</span>, es</p>
<div class="math notranslate nohighlight">
\[
   \hat{y}_{T+\tau}(T)=(\hat{L}_{T}+\hat{\beta}_{1, T}\tau)\hat{S}_{T}(\tau-s).
   \]</div>
</li>
</ol>
<ul>
<li><p>Supongamos que un registro que consta de <span class="math notranslate nohighlight">\(n\)</span> estaciones de datos es disponible. De este conjunto de datos históricos, los valores iniciales, <span class="math notranslate nohighlight">\(\hat{\beta}_{0, 0}, \hat{\beta}_{1, 0}\)</span> y <span class="math notranslate nohighlight">\(\hat{S}_{0}\)</span>, se puede calcular como</p>
<div class="math notranslate nohighlight">
\[
  \hat{\beta}_{0, 0}=\hat{L}_{0}=\frac{\overline{y}_{n}-\overline{y}_{1}}{(n-1)s},
  \]</div>
<p>donde</p>
<div class="math notranslate nohighlight">
\[
  \overline{y}_{i}=\frac{1}{s}\sum_{t=(i-1)s+1}^{is}y_{t}
  \]</div>
<p>y</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  \begin{align*}
  \hat{\beta}_{1, 0} &amp;= \overline{y}_{1}-\frac{s}{2}\hat{\beta}_{0, 0}\\
  \hat{S}_{j-s} &amp;= s\frac{\hat{S}_{j}^{\star}}{\sum_{i=1}^{s}\hat{S}_{i}^{\star}}~\text{para}~1\leq j\leq s, 
  \end{align*}
  \end{split}\]</div>
<p>donde</p>
<div class="math notranslate nohighlight">
\[
  \hat{S}_{j}^{\star}=\frac{1}{n}\sum_{t=1}^{n}\frac{y_{(t-1)s+j}}{\overline{y}_{t}-((s+1)/2-j)\hat{\beta}_{0}}.
  \]</div>
<p>Para más detalles ver <span id="id10">[<a class="reference internal" href="biblio.html#id5" title="D.C. Montgomery, L.A. Johnson, and J.S. Gardiner. Forecasting and Time Series Analysis. Industrial engineering series. McGraw-Hill, 1990. ISBN 9780070428584. URL: https://books.google.com.co/books?id=t9HuAAAAMAAJ.">Montgomery <em>et al.</em>, 1990</a>]</span> y <span id="id11">[<a class="reference internal" href="biblio.html#id9" title="B. Abraham and J. Ledolter. Statistical Methods for Forecasting. Wiley Series in Probability and Statistics. Wiley, 2009. ISBN 9780470317297. URL: https://books.google.com.co/books?id=WIPxdb2P8sAC.">Abraham and Ledolter, 2009</a>]</span>.</p>
</li>
</ul>
</section>
</section>
<section id="libreria-statsmodels-tsa-holtwinters">
<h2><span class="section-number">2.17. </span>Librería <code class="docutils literal notranslate"><span class="pre">statsmodels.tsa.holtwinters</span></code><a class="headerlink" href="#libreria-statsmodels-tsa-holtwinters" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">statsmodels.tools.sm_exceptions</span> <span class="kn">import</span> <span class="n">ConvergenceWarning</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">ConvergenceWarning</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.holtwinters</span> <span class="kn">import</span> <span class="n">ExponentialSmoothing</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.holtwinters</span> <span class="kn">import</span> <span class="n">SimpleExpSmoothing</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.seasonal</span> <span class="kn">import</span> <span class="n">seasonal_decompose</span>
<span class="kn">import</span> <span class="nn">statsmodels.tsa.api</span> <span class="k">as</span> <span class="nn">smt</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Consideremos, nuevamente, el objetivo de estimar la cantidad de *<strong>contaminación atmosférica</strong> por dióxido de carbono a partir de muestras continuas de aire en el <em><strong>Observatorio Mauna Loa, Hawai, EE. UU.</strong></em> Período de registro: <em><strong>marzo de 1958 - diciembre de 2001</strong></em>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">co2</span><span class="o">.</span><span class="n">load_pandas</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span>
<span class="n">y</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>co2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1958-03-29</th>
      <td>316.1</td>
    </tr>
    <tr>
      <th>1958-04-05</th>
      <td>317.3</td>
    </tr>
    <tr>
      <th>1958-04-12</th>
      <td>317.6</td>
    </tr>
    <tr>
      <th>1958-04-19</th>
      <td>317.5</td>
    </tr>
    <tr>
      <th>1958-04-26</th>
      <td>316.4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="s1">&#39;co2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;MS&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">y</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1958-03-01    316.100000
1958-04-01    317.200000
1958-05-01    317.433333
1958-06-01           NaN
1958-07-01    315.625000
Freq: MS, Name: co2, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">bfill</span><span class="p">())</span>
<span class="n">y</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Monthly CO2 concentrations&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;CO2 concentratition&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/17c3d75a3594c15e04531eb9d3fc3dd02aa97a97e03cd6affc7fb61b0242e04e.png" src="_images/17c3d75a3594c15e04531eb9d3fc3dd02aa97a97e03cd6affc7fb61b0242e04e.png" />
</div>
</div>
<ul class="simple">
<li><p>Dividimos en esta ocasión nuestro dataset en conjunto de <em><strong>entrenamiento</strong></em> y de <em><strong>prueba</strong></em>. En este caso <em><strong>el conjunto de prueba corresponde a los últimos 48 meses</strong></em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tau_test</span> <span class="o">=</span> <span class="mi">48</span>
<span class="n">tau_val</span>  <span class="o">=</span> <span class="mi">48</span>    

<span class="n">train</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:</span><span class="o">-</span><span class="p">(</span><span class="n">tau_val</span> <span class="o">+</span> <span class="n">tau_test</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">val</span>   <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">tau_val</span> <span class="o">+</span> <span class="n">tau_test</span><span class="p">):</span><span class="o">-</span><span class="n">tau_test</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">test</span>  <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="n">tau_test</span><span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Train: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">)</span><span class="si">}</span><span class="s2">, Validation: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="si">}</span><span class="s2">, Test: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Train: 430, Validation: 48, Test: 48
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>La siguiente función nos permitirá <em><strong>graficar los conjuntos de entrenamiento, prueba y las respectivas predicciones</strong></em> del conjunto de prueba. Además, mostraremos en el título de estas figuras la métrica <code class="docutils literal notranslate"><span class="pre">MAE</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_model</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="n">train</span><span class="p">[</span><span class="o">-</span><span class="mi">300</span><span class="p">:]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2"> - Train, Validation, Test and Prediction&quot;</span><span class="p">)</span>
    <span class="n">val</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Validation&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
    <span class="n">test</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    <span class="n">y_pred</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Prediction&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">, MAE: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">mae</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Value&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="simple-exponential-smoothing">
<h3><span class="section-number">2.17.1. </span>Simple Exponential Smoothing<a class="headerlink" href="#simple-exponential-smoothing" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Cada una de las <em><strong>funciones optimizadoras permitirán encontrar el mejor parámetro</strong></em> <span class="math notranslate nohighlight">\(\alpha\)</span> para obtener aquel modelo que minimiza en este caso la métrica <code class="docutils literal notranslate"><span class="pre">MAE</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ses_optimizer</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">alphas</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>

    <span class="n">best_alpha</span><span class="p">,</span> <span class="n">best_mae</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alphas</span><span class="p">:</span>
        <span class="n">ses_model</span> <span class="o">=</span> <span class="n">SimpleExpSmoothing</span><span class="p">(</span><span class="n">train</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">smoothing_level</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">optimized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">ses_model</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
        <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">mae</span> <span class="o">&lt;</span> <span class="n">best_mae</span><span class="p">:</span>
            <span class="n">best_alpha</span><span class="p">,</span> <span class="n">best_mae</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">mae</span>

    <span class="k">return</span> <span class="n">best_alpha</span><span class="p">,</span> <span class="n">best_mae</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ses_model_tuning</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Model Tuning - Single Exponential Smoothing&quot;</span><span class="p">):</span>
    
    <span class="n">alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
    <span class="n">best_alpha</span><span class="p">,</span> <span class="n">best_mae</span> <span class="o">=</span> <span class="n">ses_optimizer</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">alphas</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">)</span>
    
    <span class="n">train_val</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train</span><span class="p">,</span> <span class="n">val</span><span class="p">])</span>
    <span class="n">final_model</span> <span class="o">=</span> <span class="n">SimpleExpSmoothing</span><span class="p">(</span><span class="n">train_val</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">smoothing_level</span><span class="o">=</span><span class="n">best_alpha</span><span class="p">,</span> <span class="n">optimized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">final_model</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    
    <span class="n">plot_model</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Observemos las <em><strong>predicciones</strong></em> obtenidas por medio del <em><strong>modelo de suavización exponencial simple</strong></em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ses_model_tuning</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">tau_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/53c8087e415b8bd0baebdd80fae5142eb1c9c956e0875d8a8319ead707768cd4.png" src="_images/53c8087e415b8bd0baebdd80fae5142eb1c9c956e0875d8a8319ead707768cd4.png" />
</div>
</div>
</section>
<section id="double-exponential-smoothing">
<h3><span class="section-number">2.17.2. </span>Double Exponential Smoothing<a class="headerlink" href="#double-exponential-smoothing" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ExponentialSmoothing(train,</span> <span class="pre">trend=trend)</span></code>: Crea una instancia de un modelo de suavización exponencial. Toma como argumento la serie temporal de entrenamiento <code class="docutils literal notranslate"><span class="pre">train</span></code> y especifica el <em><strong>tipo de tendencia (lineal o exponencial)</strong></em> mediante el parámetro <code class="docutils literal notranslate"><span class="pre">trend</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.fit(smoothing_level=alpha,</span> <span class="pre">smoothing_slope=beta)</span></code>: Ajusta el modelo a los datos de entrenamiento. Los parámetros <code class="docutils literal notranslate"><span class="pre">smoothing_level</span></code> y <code class="docutils literal notranslate"><span class="pre">smoothing_slope</span></code> <em><strong>controlan el nivel de suavizado de la serie temporal y de la tendencia</strong></em>, respectivamente. Estos parámetros se establecen en los valores dados por <code class="docutils literal notranslate"><span class="pre">alpha</span></code> y <code class="docutils literal notranslate"><span class="pre">beta</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">des_optimizer</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">alphas</span><span class="p">,</span> <span class="n">betas</span><span class="p">,</span> <span class="n">trend</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>

    <span class="n">best_alpha</span><span class="p">,</span> <span class="n">best_beta</span><span class="p">,</span> <span class="n">best_mae</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alphas</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">beta</span> <span class="ow">in</span> <span class="n">betas</span><span class="p">:</span>
            <span class="n">des_model</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="n">trend</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">smoothing_level</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">smoothing_slope</span><span class="o">=</span><span class="n">beta</span><span class="p">)</span>
            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">des_model</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
            <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mae</span> <span class="o">&lt;</span> <span class="n">best_mae</span><span class="p">:</span>
                <span class="n">best_alpha</span><span class="p">,</span> <span class="n">best_beta</span><span class="p">,</span> <span class="n">best_mae</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">mae</span>

    <span class="k">return</span> <span class="n">best_alpha</span><span class="p">,</span> <span class="n">best_beta</span><span class="p">,</span> <span class="n">best_mae</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">des_model_tuning</span><span class="p">(</span><span class="n">train</span> <span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">trend</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Model Tuning - Double Exponential Smoothing&quot;</span><span class="p">):</span>
    
    <span class="n">alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">)</span>
    <span class="n">betas</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">)</span>
    <span class="n">best_alpha</span><span class="p">,</span> <span class="n">best_beta</span><span class="p">,</span> <span class="n">best_mae</span> <span class="o">=</span> <span class="n">des_optimizer</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">alphas</span><span class="p">,</span> <span class="n">betas</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="n">trend</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">)</span>

    <span class="n">train_val</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train</span><span class="p">,</span> <span class="n">val</span><span class="p">])</span>
    <span class="n">final_model</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">train_val</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="n">trend</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">smoothing_level</span><span class="o">=</span><span class="n">best_alpha</span><span class="p">,</span> <span class="n">smoothing_slope</span><span class="o">=</span><span class="n">best_beta</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">final_model</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    
    <span class="n">plot_model</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">des_model_tuning</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">tau_test</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9ab0f1917f1fd1e3680a64aa799929663fff75562d1db27dc7df4a7536c05630.png" src="_images/9ab0f1917f1fd1e3680a64aa799929663fff75562d1db27dc7df4a7536c05630.png" />
</div>
</div>
</section>
<section id="triple-exponential-smoothing">
<h3><span class="section-number">2.17.3. </span>Triple Exponential Smoothing<a class="headerlink" href="#triple-exponential-smoothing" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>En <code class="docutils literal notranslate"><span class="pre">ExponentialSmoothing</span></code> de la biblioteca <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> se especifican los <em><strong>componentes del modelo, como la tendencia y la estacionalidad</strong></em>, utilizando los argumentos <code class="docutils literal notranslate"><span class="pre">trend</span></code> y <code class="docutils literal notranslate"><span class="pre">seasonal</span></code>.</p></li>
<li><p>Se especifica el <em><strong>número de periodos estacionales</strong></em> utilizando el argumento <code class="docutils literal notranslate"><span class="pre">seasonal_periods</span></code>. Los parámetros de suavizado (<code class="docutils literal notranslate"><span class="pre">smoothing_level,</span> <span class="pre">smoothing_slope</span></code> y <code class="docutils literal notranslate"><span class="pre">smoothing_seasonal</span></code>) se establecen en los valores proporcionados en la lista <code class="docutils literal notranslate"><span class="pre">comb</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">tes_optimizer</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">abg</span><span class="p">,</span> <span class="n">trend</span><span class="p">,</span> <span class="n">seasonal</span><span class="p">,</span>  <span class="n">seasonal_periods</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
    
    <span class="n">best_alpha</span><span class="p">,</span> <span class="n">best_beta</span><span class="p">,</span> <span class="n">best_gamma</span><span class="p">,</span> <span class="n">best_mae</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">comb</span> <span class="ow">in</span> <span class="n">abg</span><span class="p">:</span>
        <span class="n">tes_model</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="n">trend</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="n">seasonal</span><span class="p">,</span> <span class="n">seasonal_periods</span><span class="o">=</span><span class="n">seasonal_periods</span><span class="p">)</span><span class="o">.</span>\
            <span class="n">fit</span><span class="p">(</span><span class="n">smoothing_level</span><span class="o">=</span><span class="n">comb</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">smoothing_slope</span><span class="o">=</span><span class="n">comb</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">smoothing_seasonal</span><span class="o">=</span><span class="n">comb</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">tes_model</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
        <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mae</span> <span class="o">&lt;</span> <span class="n">best_mae</span><span class="p">:</span>
            <span class="n">best_alpha</span><span class="p">,</span> <span class="n">best_beta</span><span class="p">,</span> <span class="n">best_gamma</span><span class="p">,</span> <span class="n">best_mae</span> <span class="o">=</span> <span class="n">comb</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">comb</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">comb</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">mae</span>

    <span class="k">return</span> <span class="n">best_alpha</span><span class="p">,</span> <span class="n">best_beta</span><span class="p">,</span> <span class="n">best_gamma</span><span class="p">,</span> <span class="n">best_mae</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">tes_model_tuning</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">trend</span><span class="p">,</span> <span class="n">seasonal</span><span class="p">,</span> <span class="n">seasonal_periods</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Model Tuning - Triple Exponential Smoothing&quot;</span><span class="p">):</span>
    
    <span class="n">alphas</span> <span class="o">=</span> <span class="n">betas</span> <span class="o">=</span> <span class="n">gammas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">)</span>
    <span class="n">abg</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">alphas</span><span class="p">,</span> <span class="n">betas</span><span class="p">,</span> <span class="n">gammas</span><span class="p">))</span>
    <span class="n">best_alpha</span><span class="p">,</span> <span class="n">best_beta</span><span class="p">,</span> <span class="n">best_gamma</span><span class="p">,</span> <span class="n">best_mae</span> <span class="o">=</span> <span class="n">tes_optimizer</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">abg</span><span class="o">=</span><span class="n">abg</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="n">trend</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="n">seasonal</span><span class="p">,</span> <span class="n">seasonal_periods</span><span class="o">=</span><span class="n">seasonal_periods</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">)</span>
    
    <span class="n">final_model</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="n">trend</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="n">seasonal</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">smoothing_level</span><span class="o">=</span><span class="n">best_alpha</span><span class="p">,</span> <span class="n">smoothing_slope</span><span class="o">=</span><span class="n">best_beta</span><span class="p">,</span> <span class="n">smoothing_seasonal</span><span class="o">=</span><span class="n">best_gamma</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">final_model</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">step</span> <span class="o">+</span> <span class="n">step</span><span class="p">)[</span><span class="o">-</span><span class="n">step</span><span class="p">:]</span>
    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    
    <span class="n">plot_model</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">best_alpha</span><span class="p">,</span> <span class="n">best_beta</span><span class="p">,</span> <span class="n">best_gamma</span><span class="p">,</span> <span class="n">best_mae</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_alpha</span><span class="p">,</span> <span class="n">best_beta</span><span class="p">,</span> <span class="n">best_gamma</span><span class="p">,</span> <span class="n">best_mae</span> <span class="o">=</span> <span class="n">tes_model_tuning</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">tau_test</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="n">seasonal_periods</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8f911e894dce614219a1a15d84ec5f384dbeed4c7efc2d8b2560f986eeb518a9.png" src="_images/8f911e894dce614219a1a15d84ec5f384dbeed4c7efc2d8b2560f986eeb518a9.png" />
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Resumen</p>
<ul class="simple">
<li><p>Este capítulo trata de los enfoques de suavización exponencial para datos de series temporales. Los enfoques pueden ampliarse fácilmente para la predicción mediante la inclusión de términos como el <em><strong>factor de suavización, factor de tendencia y factor de estacionalidad</strong></em>.</p></li>
<li><p>El suavizado exponencial de orden único realiza la suavización utilizando solo el factor <span class="math notranslate nohighlight">\(\lambda\)</span>, que se amplía con los factores <span class="math notranslate nohighlight">\(\alpha,\,\beta\)</span> de segundo orden al incluir tendencia. <em><strong>La suavización de tercer orden incorpora todos los factores, tendencia y estacionalidad en el modelo</strong></em>.</p></li>
<li><p>En este capítulo se han tratado todos estos modelos en detalle con su implementación en <em><strong>Python</strong></em>. El enfoque de <em><strong>suavizado exponencial puede utilizarse para pronosticar series temporales estacionarias</strong></em>. Sin embargo, esta suposición puede no ser cierta. <em><strong>Se recomienda el suavizado exponencial de orden superior para estos casos</strong></em>, pero su cálculo es difícil y costoso computacionalmente. Por lo tanto, para hacer frente a este planteamiento, <em><strong>se utilizan otras técnicas de previsión como el modelo ARIMA, que se tratará en la siguiente sección</strong></em>.</p></li>
</ul>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "tf"
        },
        kernelOptions: {
            name: "tf",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'tf'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="statistical_background.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1. </span>Introducción a las Series de Tiempo</p>
      </div>
    </a>
    <a class="right-next"
       href="arima_model.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">3. </span>Modelos autorregresivos integrados de media móvil</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis">2.1. Análisis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduccion-al-suavizado-de-series-temporales">2.2. Introducción al suavizado de series temporales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#suavizacion-exponencial-de-primer-orden">2.3. Suavización exponencial de primer orden</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#el-valor-de-lambda">2.4. El valor de <span class="math notranslate nohighlight">\(\lambda\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion-ses">2.5. Implementación <span class="math notranslate nohighlight">\(SES\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelado-de-datos-de-series-temporales">2.6. Modelado de datos de series temporales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#suavizacion-exponencial-de-segundo-orden">2.7. Suavización exponencial de segundo orden</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion-des">2.8. Implementación <span class="math notranslate nohighlight">\(DES\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#suavizacion-exponencial-de-alto-orden">2.9. Suavización exponencial de alto orden</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#forecasting">2.10. Forecasting</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#proceso-constante">2.10.1. Proceso constante</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seleccion-de-lambda">2.11. Selección de <span class="math notranslate nohighlight">\(\lambda\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#intervalo-de-prediccion">2.12. Intervalo de predicción</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimacion-de-sigma-e-2">2.13. Estimación de <span class="math notranslate nohighlight">\(\sigma_{e}^{2}\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adaptacion-actualizada-del-factor-de-descuento">2.14. Adaptación actualizada del factor de descuento</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluacion-del-modelo">2.15. Evaluación del modelo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#suavizacion-exponencial-para-datos-estacionales">2.16. Suavización exponencial para datos estacionales</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-estacional-aditivo">2.16.1. Modelo estacional aditivo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-estacional-multiplicativo">2.16.2. Modelo estacional multiplicativo</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#libreria-statsmodels-tsa-holtwinters">2.17. Librería <code class="docutils literal notranslate"><span class="pre">statsmodels.tsa.holtwinters</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-exponential-smoothing">2.17.1. Simple Exponential Smoothing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#double-exponential-smoothing">2.17.2. Double Exponential Smoothing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#triple-exponential-smoothing">2.17.3. Triple Exponential Smoothing</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Lihki Rubio, Ph.D.
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>Lihki Rubio, Ph.D. All rights reserved.</p>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>